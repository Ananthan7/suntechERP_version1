<div class="bg-light">
    <!-- header section starts -->
    <div class="pos-sales-modalheader border-bottom d-flex justify-content-between">
        <h5 class="pos-modaltitle" id="modal-dia-metal">Job Card</h5>
        <button type="button" class="btn btn-close close-btn" (click)="close()">
            <i class="feather icon-x close-icon"></i>
        </button>
    </div>
    <!-- modal header component -->
    <modal-header (saveClick)="formSubmit()" (cancelClick)="close()"></modal-header>
    <!-- content section -->
    <form [formGroup]="jobCardFrom">
        <div class="metal-sales-card">
            <div class="sales-card-body p-2">
                <div class="row mb-2">
                    <div class="row d-flex">
                        <div class="col-sm-5"><h6>{{branchCode}}</h6></div>
                        <div class="col-sm-3"><h6>Pending</h6></div>
                      </div>
                    <div class="col-md-6">
                        <div class="row align-items-center mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Order
                                Type*:</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="orderType" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="ordertypeCodeData"
                                    (newRowClick)="ordertypeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Job
                                Number :</label>
                            <div class="col-sm-3">
                                <!-- <input class="form-control" type="text" /> -->
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="jobno" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Job
                                Date :</label>
                            <div class="col-sm-3">
                                <div class="datepick">
                                    <!-- <input class="form-control flatpickr-input" type="text" placeholder="Select Date*"
                                        mwlFlatpickr dateFormat="d/m/y" formControlName="jobdate"> -->
                                    <mat-form-field style="width: 100%">
                                        <input matInput DateValidation (dateChange)="formatDate($event)"
                                            [matDatepicker]="jobdate" formControlName="jobdate"
                                            placeholder="DD/MM/YYYY" />
                                        <mat-datepicker-toggle matSuffix [for]="jobdate"></mat-datepicker-toggle>
                                        <mat-datepicker #jobdate></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Design
                                Code :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="designcode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="designCodeData"
                                (newRowClick)="designCodeSelected($event)" (onchange)="addTableData()"></master-search>
                            </div>
                            <div class="col-sm-6">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="designtype" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Customer
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="customer" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="customerCodeData"
                                (newRowClick)="customerCodeSelected($event)"></master-search>
                            </div>
                            <div class="col-sm-6">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="customername" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Sales
                                Order*:</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="salesorder" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Date
                                :</label>
                            <div class="col-sm-3">
                                <div class="datepick">
                                        <mat-form-field style="width: 100%">
                                            <input matInput DateValidation (dateChange)="formatDate($event)"
                                                [matDatepicker]="date" formControlName="date"
                                                placeholder="DD/MM/YYYY" />
                                            <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
                                            <mat-datepicker #date></mat-datepicker>
                                        </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Cost
                                Code :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="costcode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="costCodeData"
                                (newRowClick)="costCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Prefix
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="prefix" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="prefixCodeData"
                                (newRowClick)="prefixCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Karat
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="karat" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="karatCodeData"
                                (newRowClick)="karatCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Type
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="type" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="typeCodeData"
                                (newRowClick)="typeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Category
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="category" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="categoryCodeData"
                                (newRowClick)="categoryCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Sub
                                Cat : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="subcat" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="subcatCodeData"
                                (newRowClick)="subcatCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Color
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="color" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="colorCodeData"
                                (newRowClick)="colorCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Brand * 
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="brand" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="brandCodeData"
                                (newRowClick)="brandCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Country
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="country" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="countryCodeData"
                                (newRowClick)="countryCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Set
                                Ref : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="setref" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Comments
                                :</label>
                            <div class="col-sm-9">
                                <textarea matInput rows="3" formControlName="comments"></textarea>
                                <!-- <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea> -->
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Size*
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="size" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Length*
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="length" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="lengthCodeData"
                                    (newRowClick)="lengthCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Instruction
                                :</label>
                            <div class="col-sm-9">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="instruction" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Job
                                Type * :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput readonly formControlName="jobtype" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Purity*
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="number" matInput readonly formControlName="purity" />
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 border-end">
                        <div class="row mb-3">
                            <div class="col-sm-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value id="flexCheckDefault">
                                    <label class="form-check-label" for="flexCheckDefault">
                                        Repair Job
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Del
                                Date : </label>
                            <div class="col-sm-7">
                                <div class="datepick">
                                    <!-- <input class="form-control flatpickr-input" type="text" placeholder="Select Date*"
                                        mwlFlatpickr dateFormat="d/m/y" formControlName="deldate"> -->
                                    <mat-form-field style="width: 100%">
                                        <input matInput DateValidation (dateChange)="formatDate($event)"
                                            [matDatepicker]="deldate" formControlName="deldate"
                                            placeholder="DD/MM/YYYY" />
                                        <mat-datepicker-toggle matSuffix [for]="deldate"></mat-datepicker-toggle>
                                        <mat-datepicker #deldate></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Salesman
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="salesman" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="salesmanCodeData"
                                (newRowClick)="salesmanCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Stock
                                Code * : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="stockcode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="stockCodeData"
                                (newRowClick)="stockCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Currency
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="currency" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row align-items-center mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Loss
                                Booking : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 150px;">
                                    <mat-select formControlName="lossbooking">
                                        <mat-option value="singleMetal">Single Metal</mat-option>
                                        <mat-option value="multipleMetal">Multiple Metal</mat-option>
                                        <mat-option value="highestWeight">Highest Weight</mat-option>
                                        <mat-option value="weightedAvg">Weighted Average</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <!-- <select class="form-select form-control bg-white"></select> -->
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Main
                                Metal : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="mainmetal" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="mainmetalCodeData"
                                (newRowClick)="mainmetalCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Time
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="time" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="timeCodeData"
                                (newRowClick)="timeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Range
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="range" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="rangeCodeData"
                                (newRowClick)="rangeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Seq.Code
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 80%;">
                                    <input type="text" matInput formControlName="seqcode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="seqCodeData"
                                (newRowClick)="seqCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Total
                                Pcs </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="number" matInput [max]="999999999" formControlName="totalpcs" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Pending
                            </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="number" matInput [max]="999999999" formControlName="pending" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Parts
                            </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput [max]="999999999" formControlName="parts" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Pending
                            </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="number" matInput [max]="999999999" formControlName="pending" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Screw Field
                                : </label>
                            <div class="col-sm-5">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="srewFiled" />
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="row mt-5 mb-2">
                            <div class="col-sm-12">
                                <!-- <textarea class="form-control" id="exampleFormControlTextarea1" rows="5"></textarea> -->
                                <div class="upload-btn-wrapper">
                                    <button class="btn btnnew border-dark">
                                        <img src={{urls}} style="width:200px;height:185px">
                                        
                                    </button>
                                    <input type="file" formControlName="picture_name" class="uploadproduct" (change)="onFileChanged($event)">
                                </div>
                            </div>
                        </div>
                        <div class="m-3 row">
                            <button class="btn btn-primary rounded-pill my-2" (click)="openaddcomponent()">Components</button>
                            <button class="btn btn-primary rounded-pill my-2" (click)="openaddtransactiondetails()">Transactions</button>
                            <button class="btn btn-primary rounded-pill my-2" (click)="openaddstickerprint()">Sticker
                                Point</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <dx-data-grid id="gridContainer" [dataSource]="tableData" [showBorders]="true" [showColumnLines]="true"
                        [showRowLines]="true" class="mt-3"
                         
                        >
      
                        <!-- <dxo-editing [allowUpdating]="true"></dxo-editing> -->
      
                        <dxo-selection
                        [selectAllMode]="allMode"
                        [showCheckBoxesMode]="checkBoxesMode"
                        mode="multiple"
                      ></dxo-selection>
                          <dxi-column dataField="SINO" caption="SI NO"> </dxi-column>
                          <dxi-column dataField="job_reference" caption="Job Reference " cellTemplate="job_referencetemp"></dxi-column>
                          <dxi-column dataField="part_code" caption="Part Code" cellTemplate="part_codetemp"></dxi-column>
                          <dxi-column dataField="Description" caption="Description" cellTemplate="descriptiontemp"></dxi-column>
                          <dxi-column dataField="Pcs" caption="Pcs" cellTemplate="Pcstemp"></dxi-column>
                          <dxi-column dataField="metal_color" caption="Metal Color" cellTemplate="metal_colortemp"></dxi-column>
                            <dxi-column dataField="metal_wt" caption="Metal Wt" cellTemplate="metal_wttemp"></dxi-column>
                            <dxi-column dataField="stone_wt" caption="Stone Wt" cellTemplate="stone_wttemp"></dxi-column>
                            <dxi-column dataField="gross_wt" caption="Gross Wt" cellTemplate="gross_wttemp"></dxi-column>
                       
          
                            <div *dxTemplate="let data of 'job_referencetemp'">
                                <input  type="text" (change)="descriptiontemp($event,data)" style="width: 100%;" [value]="data.value" />
                              </div>
      
                        <div *dxTemplate="let data of 'part_codetemp'">
                          <input  type="text" (change)="part_codetemp($event,data)" style="width: 100%;" [value]="data.value" />
                        </div>

                        <div *dxTemplate="let data of 'descriptiontemp'">
                            <input  type="text" (change)="descriptiontemp($event,data)" style="width: 100%;" [value]="data.value" />
                          </div>

                          
                        <div *dxTemplate="let data of 'Pcstemp'">
                            <input  type="text" (change)="Pcstemp($event,data)" style="width: 100%;" [value]="data.value" />
                          </div>

                          <div *dxTemplate="let data of 'metal_colortemp'">
                            <input  type="text" (change)="metal_colortemp($event,data)" style="width: 100%;" [value]="data.value" />
                          </div>

                          <div *dxTemplate="let data of 'metal_wttemp'">
                            <input  type="text" (change)="metal_wttemp($event,data)" style="width: 100%;" [value]="data.value" />
                          </div>

                          <div *dxTemplate="let data of 'stone_wttemp'">
                            <input  type="text" (change)="stone_wttemp($event,data)" style="width: 100%;" [value]="data.value" />
                          </div>

                          <div *dxTemplate="let data of 'gross_wttemp'">
                            <input  type="text" (change)="gross_wttemp($event,data)" style="width: 100%;" [value]="data.value" />
                          </div>

                      </dx-data-grid>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
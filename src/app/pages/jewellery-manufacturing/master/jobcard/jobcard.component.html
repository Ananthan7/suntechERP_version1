<div class="bg-light">
    <!-- header section starts -->
    <div class="pos-sales-modalheader border-bottom d-flex justify-content-between">
        <h5 class="pos-modaltitle" id="modal-dia-metal">Job Card</h5>
        <button type="button" class="btn btn-close close-btn" (click)="close()">
            <i class="feather icon-x close-icon"></i>
        </button>
    </div>
    <!-- modal header component -->
    <modal-header (saveClick)="formSubmit()" (cancelClick)="close()"></modal-header>
    <!-- content section -->
    <form [formGroup]="jobCardFrom">
        <div class="metal-sales-card">
            <div class="sales-card-body p-2">
                <div class="row mb-2">
                    <div class="row d-flex">
                        <div class="col-sm-5"><h6>{{branchCode}}</h6></div>
                        <div class="col-sm-3"><h6>Pending</h6></div>
                      </div>
                    <div class="col-md-6">
                        <div class="row align-items-center mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Order
                                Type * :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput #codeInput1 formControlName="orderType" [readonly]="viewMode"  />
                                </mat-form-field>
                                <master-search [MasterSearchData]="ordertypeCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="ordertypeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Job
                                Number * :</label>
                            <div class="col-sm-3">
                                <!-- <input class="form-control" type="text" /> -->
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="jobno" [readonly]="viewMode"  />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Job
                                Date :</label>
                            <div class="col-sm-3">
                                <div class="datepick">
                                    <!-- <input class="form-control flatpickr-input" type="text" placeholder="Select Date*"
                                        mwlFlatpickr dateFormat="d/m/y" formControlName="jobdate"> -->
                                    <mat-form-field style="width: 100%">
                                        <input matInput DateValidation (dateChange)="formatDate($event)"
                                            [matDatepicker]="jobdate" formControlName="jobdate"
                                            placeholder="DD/MM/YYYY"  [disabled]="viewMode" />
                                        <mat-datepicker-toggle matSuffix [for]="jobdate"></mat-datepicker-toggle>
                                        <mat-datepicker #jobdate></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Design
                                Code * :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="designcode"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="designCodeData"
                                *ngIf="viewMode == false"    (newRowClick)="designCodeSelected($event)"></master-search>
                            </div>
                            <div class="col-sm-6">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="designtype"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Customer * 
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="customer"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="customerCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="customerCodeSelected($event)"></master-search>
                            </div>
                            <div class="col-sm-6">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="customername"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Sales
                                Order :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="salesorder"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Date
                                :</label>
                            <div class="col-sm-3">
                                <div class="datepick">
                                        <mat-form-field style="width: 100%">
                                            <input matInput DateValidation (dateChange)="formatDate($event)"
                                                [matDatepicker]="date" formControlName="date"  [disabled]="viewMode" 
                                                placeholder="DD/MM/YYYY" />
                                            <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
                                            <mat-datepicker #date></mat-datepicker>
                                        </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Cost
                                Code * :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="costcode"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="costCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="costCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Prefix
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="prefix"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="prefixCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="prefixCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Karat * 
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" class="text-left" matInput formControlName="karat"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="karatCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="karatCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Type
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="type"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="typeCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="typeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Category
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="category"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="categoryCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="categoryCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Sub
                                Cat : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="subcat"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="subcatCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="subcatCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Color * 
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="color" UpperCaseDirective  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="colorCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="colorCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Brand
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="brand"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="brandCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="brandCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Country
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="country"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="countryCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="countryCodeSelected($event)"></master-search>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Set
                                Ref : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="setref"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Comments
                                :</label>
                            <div class="col-sm-9">
                                <textarea  rows="4" cols="67" class="tx-1" formControlName="comments" maxlength="20"></textarea>
                                <!-- <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea> -->
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Size
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="size"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Length
                                :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="length"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="lengthCodeData"
                                *ngIf="viewMode == false"    (newRowClick)="lengthCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Instruction
                                :</label>
                            <div class="col-sm-9">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="instruction" maxlength="150"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Job
                                Type * :</label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput readonly formControlName="jobtype"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Purity *
                                : </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput readonly class="text-right" formControlName="purity" SixDecimalInput  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 border-end">
                        <div class="row mb-3">
                            <div class="col-sm-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value id="flexCheckDefault" [disabled]="viewMode" >
                                    <label class="form-check-label" for="flexCheckDefault">
                                        Repair Job
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Del
                                Date : </label>
                            <div class="col-sm-7">
                                <div class="datepick">
                                    <!-- <input class="form-control flatpickr-input" type="text" placeholder="Select Date*"
                                        mwlFlatpickr dateFormat="d/m/y" formControlName="deldate"> -->
                                    <mat-form-field style="width: 100%">
                                        <input matInput DateValidation (dateChange)="formatDate($event)"
                                            [matDatepicker]="deldate" formControlName="deldate" [disabled]="viewMode" 
                                            placeholder="DD/MM/YYYY" [min]="jobCardFrom.value.jobdate"/>
                                        <mat-datepicker-toggle matSuffix [for]="deldate"></mat-datepicker-toggle>
                                        <mat-datepicker #deldate></mat-datepicker>
                                        
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Salesman * 
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="salesman"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="salesmanCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="salesmanCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Stock
                                Code : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="stockcode"  [readonly]="viewMode" />
                                </mat-form-field>
                                <!-- <master-search [MasterSearchData]="stockCodeData"
                                (newRowClick)="stockCodeSelected($event)"></master-search> -->
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Currency
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="currency"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="currencyMasterData"
                                *ngIf="viewMode == false"   (newRowClick)="currencyCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row align-items-center mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Loss
                                Booking * : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 150px;">
                                    
                                    <mat-select formControlName="lossbooking" [(ngModel)]="selectedValue" name="selectedValue"  [disabled]="viewMode" >
                                        <mat-option value="singleMetal">Single Metal</mat-option>
                                        <mat-option value="multipleMetal">Multiple Metal</mat-option>
                                        <mat-option value="highestWeight">Highest Weight</mat-option>
                                        <mat-option value="weightedAvg">Weighted Average</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <!-- <select class="form-select form-control bg-white"></select> -->
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Main
                                Metal : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="mainmetal"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="mainmetalCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="mainmetalCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Time
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="time"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="timeCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="timeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Range
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 70%;">
                                    <input type="text" matInput formControlName="range"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="rangeCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="rangeCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-5 col-form-label">Seq.Code * 
                                : </label>
                            <div class="col-sm-7">
                                <mat-form-field style="width: 80%;">
                                    <input type="text" matInput formControlName="seqcode"  [readonly]="viewMode" />
                                </mat-form-field>
                                <master-search [MasterSearchData]="seqCodeData"
                                *ngIf="viewMode == false"   (newRowClick)="seqCodeSelected($event)"></master-search>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Total
                                Pcs* </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput maxlength="9" NumberOnly  class="text-right" formControlName="totalpcs"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Pending *
                            </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput maxlength="9" NumberOnly class="text-right" formControlName="pending"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Parts *
                            </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput maxlength="9" NumberOnly  class="text-right" formControlName="parts"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                            <label for="input" class="col-sm-3 col-form-label">Pending *
                            </label>
                            <div class="col-sm-3">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput maxlength="9" NumberOnly  class="text-right" formControlName="pending1"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <label for="input" class="col-sm-3 col-form-label">Screw Field
                                : </label>
                            <div class="col-sm-5">
                                <mat-form-field style="width: 100%;">
                                    <input type="text" matInput formControlName="srewFiled"  [readonly]="viewMode" />
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="row mt-5 mb-2">
                            <div class="col-sm-12">
                                <!-- <textarea class="form-control" id="exampleFormControlTextarea1" rows="5"></textarea> -->
                                <div class="upload-btn-wrapper">
                                    <button class="btn btnnew border-dark">
                                        <img src={{urls}} style="width:200px;height:185px">
                                        <button class="carousel-control-prev" type="button"
                                        data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Previous</span>
                                      </button>
                                      <button class="carousel-control-next" type="button"
                                        data-bs-target="#carouselExampleControls" data-bs-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Next</span>
                                      </button>
                                  
                                    </button>
                                   <!-- <input type="file" formControlName="picture_name" accept=".png, .jpg, .jpeg, .JPG" #fileInput class="uploadproduct" (change)="onFileChanged($event)"> -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="m-3 row">
                            <button class="btn btn-primary rounded-pill my-2" (click)="openaddcomponent()">Components</button>
                            <button class="btn btn-primary rounded-pill my-2" (click)="openaddtransactiondetails()">Transactions</button>
                            <button class="btn btn-primary rounded-pill my-2" (click)="openaddstickerprint()">Sticker
                                Print</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <dx-data-grid id="gridContainer" [dataSource]="tableData" [showBorders]="true" [showColumnLines]="true"
                        [showRowLines]="true" [allowColumnResizing]="true" class="mt-3">
                        <!-- <dxo-editing [allowUpdating]="true"></dxo-editing> -->
      
                        <dxo-selection
                        [selectAllMode]="allMode"
                        [showCheckBoxesMode]="checkBoxesMode"
                        mode="single"
                      ></dxo-selection>
                          <dxi-column dataField="SINO" caption="SI NO"> </dxi-column>
                          <dxi-column dataField="job_reference" caption="Job Reference " cellTemplate="job_referencetemp"></dxi-column>
                          <dxi-column dataField="part_code" caption="Part Code" cellTemplate="part_codetemp"></dxi-column>
                          <dxi-column dataField="Description" caption="Description" cellTemplate="descriptiontemp"></dxi-column>
                          <dxi-column dataField="Pcs" caption="Pcs" cellTemplate="Pcstemp"></dxi-column>
                          <dxi-column dataField="metal_color" caption="Metal Color" cellTemplate="metal_colortemp"></dxi-column>
                            <dxi-column dataField="metal_wt" caption="Metal Wt" cellTemplate="metal_wttemp"></dxi-column>
                            <dxi-column dataField="stone_wt" caption="Stone Wt" cellTemplate="stone_wttemp"></dxi-column>
                            <dxi-column dataField="gross_wt" caption="Gross Wt" cellTemplate="gross_wttemp"></dxi-column>
                       
          
                            <div *dxTemplate="let data of 'job_referencetemp'">
                                <input  type="text" (change)="descriptiontemp($event,data)" style="width: 100%;" readonly [value]="data.value" />
                              </div>
      
                        <div *dxTemplate="let data of 'part_codetemp'">
                          <input  type="text" (change)="part_codetemp($event,data)" style="width: 100%;" readonly [value]="data.value" />
                        </div>

                        <div *dxTemplate="let data of 'descriptiontemp'">
                            <input  type="text" (change)="descriptiontemp($event,data)" style="width: 100%;" readonly [value]="data.value" />
                          </div>

                          
                        <div *dxTemplate="let data of 'Pcstemp'">
                            <input  type="text" (change)="Pcstemp($event,data)" style="width: 100%;" readonly [value]="data.value" class="text-right"/>
                          </div>

                          <div *dxTemplate="let data of 'metal_colortemp'">
                            <input  type="text" (change)="metal_colortemp($event,data)" style="width: 100%;" readonly [value]="data.value" class="text-right"/>
                          </div>

                          <div *dxTemplate="let data of 'metal_wttemp'">
                            <input  type="text" (change)="metal_wttemp($event,data)" style="width: 100%;" readonly [value]="data.value" MetalDecimalInput class="text-right"/>
                          </div>

                          <div *dxTemplate="let data of 'stone_wttemp'">
                            <input  type="text" (change)="stone_wttemp($event,data)" style="width: 100%;" readonly [value]="data.value" MetalDecimalInput class="text-right"/>
                          </div>

                          <div *dxTemplate="let data of 'gross_wttemp'">
                            <input  type="text" (change)="gross_wttemp($event,data)" style="width: 100%;" readonly [value]="data.value" MetalDecimalInput class="text-right"/>
                          </div>

                      </dx-data-grid>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<!-- header section starts -->
<div class="card-content border-bottom d-flex justify-content-between p-2">
  <h5 class="pos-modaltitle" id="modal-dia-metal">Receipt Modes</h5>
  <button type="button" class="btn btn-close close-btn" (click)="close()">
    <i class="feather icon-x close-icon"></i>
  </button>
</div>

<!-- modal header component -->
<modal-header
[isViewMore]="!['VIEW', 'DELETE'].includes(flag)"
  (saveClick)="receiptModesMainFormSubmit()"
  (cancelClick)="close()"
  (deleteClick)="DeleteController()"
  [isViewDelete]="false"
  [isViewCancel]="!['VIEW', 'DELETE'].includes(flag)"
  [isViewSave]="!['VIEW', 'DELETE'].includes(flag)"
></modal-header>

<!-- content section -->
<div class="container-fluid pt-3">
  <form [formGroup]="receiptModesMainForm">
    <div class="row mt-2">
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-8">
            <div class="row mb-1">
              <label for="mode" class="col-sm-2 col-form-label" id="ID029"
                >Mode</label
              >
              <div class="col-md-3">
                <mat-form-field style="width: 100%" appearance="outline">
                  <mat-select formControlName="mode">
                    <mat-option
                      *ngFor="let data of modeDorpdown"
                      [value]="data.SRNO"
                    >
                      {{ data.ENGLISH }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            </div>

            <div class="row mb-1">
              <label for="code" class="col-sm-2 col-form-label" id="ID029"
                >Code</label
              >

              <div class="col-md-3">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW' || flag === 'EDIT'"
                    matInput
                    type="text"
                    formControlName="code"
                    [maxlength]="6"
                    UpperCaseDirective
                    #codeField
                  />
                </mat-form-field>
              </div>
              <div class="col-md-7">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW'"
                    matInput
                    [maxlength]="40"
                    type="text"
                    formControlName="desc"
                  />
                </mat-form-field>
              </div>
            </div>

            <div class="row mb-1">
              <label for="accode" class="col-sm-2 col-form-label" id="ID029"
                >Accode</label
              >
              <div class="col-md-4">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW'"
                    matInput
                    type="text"
                    formControlName="accode"
                    (keydown)="openTab($event, 'accode')"
                    (focusout)="
                      SPvalidateLookupFieldModified(
                        $event,
                        AccodeData,
                        ['accode', 'currencyCode'],
                        ['CODE', 'DESCRIPTION']
                      )
                    "
                  />

                  <master-search
                    *ngIf="flag != 'VIEW'"
                    #overlayAccodeData
                    [MasterSearchData]="AccodeData"
                    class="masterSearch"
                    (newRowClick)="
                      lookupSelect(
                        $event,
                        ['accode', 'currencyCode'],
                        ['CODE', 'DESCRIPTION']
                      )
                    "
                  ></master-search>
                </mat-form-field>
              </div>

              <label for="commision" class="col-sm-2 col-form-label" id="ID029"
                >Commision %</label
              >

              <div class="col-md-4">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    ThreeDecimalInput
                    class="text-right"
                    [readonly]="flag === 'VIEW'"
                    matInput
                    min="0"
                    type="number"
                    formControlName="commision"
                  />
                </mat-form-field>
              </div>
            </div>

            <div class="row mb-1">
              <label for="currency" class="col-sm-2 col-form-label" id="ID029"
                >Currency</label
              >
              <div class="col-md-4">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW'"
                    matInput
                    type="text"
                    [maxlength]="4"
                    formControlName="currencyCode"
                  />
                </mat-form-field>
              </div>

              <label
                for="commisionAccount"
                class="col-sm-2 col-form-label"
                id="ID029"
                >Commision Account</label
              >

              <div class="col-md-4">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW'"
                    matInput
                    type="text"
                    formControlName="commisionAccount"
                    (keydown)="openTab($event, 'commisionAccount')"
                    (focusout)="
                      SPvalidateLookupFieldModified(
                        $event,
                        commisionCodeData,
                        ['commisionAccount'],
                        ['CODE']
                      )
                    "
                  />
                  <master-search
                    *ngIf="flag != 'VIEW'"
                    #overlayCommisionAccount
                    [MasterSearchData]="commisionCodeData"
                    class="masterSearch"
                    (newRowClick)="
                      lookupSelect($event, ['commisionAccount'], ['CODE'])
                    "
                  ></master-search>
                </mat-form-field>
              </div>
            </div>

            <div class="row mb-1">
              <label for="bank" class="col-sm-2 col-form-label" id="ID029"
                >Bank</label
              >
              <div class="col-md-4">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW'"
                    matInput
                    type="text"
                    formControlName="bank"
                    (keydown)="openTab($event, 'bank')"
                    (focusout)="
                      SPvalidateLookupFieldModified(
                        $event,
                        bankCodeData,
                        ['bank'],
                        ['CODE']
                      )
                    "
                  />

                  <master-search
                    *ngIf="flag != 'VIEW'"
                    #overlayBankCode
                    [MasterSearchData]="bankCodeData"
                    class="masterSearch"
                    (newRowClick)="lookupSelect($event, ['bank'], ['CODE'])"
                  ></master-search>
                </mat-form-field>
              </div>

              <label for="maxCommAcc" class="col-sm-2 col-form-label" id="ID029"
                >Max Comm Account</label
              >

              <div class="col-md-4">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    ThreeDecimalInput
                    class="text-right"
                    [readonly]="flag === 'VIEW'"
                    matInput
                    type="number"
                    (keydown)="preventInvalidInput($event)"
                    formControlName="maxCommAcc"
                  />
                </mat-form-field>
              </div>
            </div>

            <div class="row mb-1">
              <label for="branches" class="col-sm-2 col-form-label" id="ID029"
                >Branches</label
              >

              <div class="col-md-8">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW'"
                    matInput
                    type="text"
                    formControlName="branches"
                  />
                </mat-form-field>
              </div>
              <div class="col-md-2">
                <button type="button" class="btn btn-primary text-center">
                  ...
                  <app-branch-division
                    [fetchData]="fetchedBranchData"
                    (newRowClick)="selectedData($event)"
                    class="branchDivisionelectr"
                    [matTooltip]="branchDivisionControlsTooltip"
                    matTooltipClass="custom-tooltip"
                    matTooltipPosition="above"
                  ></app-branch-division>
                </button>
              </div>
            </div>

            <div class="row mb-1">
              <div class="col-md-2 pt-1">
                <mat-checkbox
                  (change)="matBoxChecker($event, 'loyalty')"
                  formControlName="loyalty"
                  >Loyalty</mat-checkbox
                >
              </div>
              <div class="col-md-2 pt-1">
                <mat-checkbox
                  (change)="matBoxChecker($event, 'rcmCredit')"
                  formControlName="rcmCredit"
                  >RCM Credit</mat-checkbox
                >
              </div>
              <div class="col-md-2 pt-1">
                <mat-checkbox
                  (change)="matBoxChecker($event, 'excludeTax')"
                  formControlName="excludeTax"
                  >Exclude Tax</mat-checkbox
                >
              </div>

              <label for="inputVat" class="col-sm-2 col-form-label" id="ID029"
                >Input Vat</label
              >

              <div class="col-md-4">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input
                    [readonly]="flag === 'VIEW'"
                    matInput
                    type="text"
                    formControlName="inputVat"
                    (keydown)="openTab($event, 'inputVat')"
                    (focusout)="
                      SPvalidateLookupFieldModified(
                        $event,
                        inputVatCodeData,
                        ['inputVat'],
                        ['CODE']
                      )
                    "
                  />

                  <master-search
                    *ngIf="flag != 'VIEW'"
                    #overlayInputVat
                    [MasterSearchData]="inputVatCodeData"
                    class="masterSearch"
                    (newRowClick)="lookupSelect($event, ['inputVat'], ['CODE'])"
                  ></master-search>
                </mat-form-field>
              </div>
            </div>

            <div class="row mb-1">
              <div class="col-md-2 pt-1"></div>
              <div class="col-md-4">
                <div class="row" *ngIf="isEnableRCM; else emptyDiv">
                  <label
                    for="rcmInput"
                    class="col-sm-5 col-form-label"
                    id="ID029"
                    >RCM Input</label
                  >

                  <div class="col-md-7">
                    <mat-form-field style="width: 100%" appearance="outline">
                      <input
                        [readonly]="flag === 'VIEW'"
                        matInput
                        type="text"
                        formControlName="rcmInput"
                      />
                    </mat-form-field>
                  </div>
                </div>
                <ng-template #emptyDiv>
                  <div class="row"></div>
                </ng-template>
              </div>
              <div class="col-md-6">
                <div class="row">
                  <label
                    for="outputVat"
                    class="col-sm-4 col-form-label"
                    id="ID029"
                    >Output Vat</label
                  >

                  <div class="col-md-8">
                    <mat-form-field style="width: 100%" appearance="outline">
                      <input
                        [readonly]="flag === 'VIEW'"
                        matInput
                        type="text"
                        formControlName="outputVat"
                        (keydown)="openTab($event, 'outputVat')"
                        (focusout)="
                          SPvalidateLookupFieldModified(
                            $event,
                            outputVatCodeData,
                            ['outputVat'],
                            ['CODE']
                          )
                        "
                      />

                      <master-search
                        *ngIf="flag != 'VIEW'"
                        #overlayOutputVat
                        [MasterSearchData]="outputVatCodeData"
                        class="masterSearch"
                        (newRowClick)="
                          lookupSelect($event, ['outputVat'], ['CODE'])
                        "
                      ></master-search>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mb-1">
              <div class="col-md-2 pt-1"></div>

              <div class="col-md-4">
                <div class="row" *ngIf="isEnableRCM; else emptyDiv">
                  <label
                    for="rcmOutputVat"
                    class="col-sm-5 col-form-label"
                    id="ID029"
                    >RCM Output VAT</label
                  >

                  <div class="col-md-7">
                    <mat-form-field style="width: 100%" appearance="outline">
                      <input
                        [readonly]="flag === 'VIEW'"
                        matInput
                        type="text"
                        formControlName="rcmOutputVat"
                      />
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div class="row">
                  <label for="vat" class="col-sm-4 col-form-label" id="ID029"
                    >Vat %</label
                  >

                  <div class="col-md-8">
                    <mat-form-field style="width: 100%" appearance="outline">
                      <input
                        ThreeDecimalInput
                        class="text-right"
                        [readonly]="flag === 'VIEW'"
                        matInput
                        type="number"
                        (keydown)="preventInvalidInput($event)"
                        formControlName="vat"
                      />
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>

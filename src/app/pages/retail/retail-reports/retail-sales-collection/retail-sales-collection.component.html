<!-- header section starts -->
<div class="card-content border-bottom d-flex justify-content-between p-2">
    <h5 class="pos-modaltitle" id="modal-dia-metal"> Retail Sales Collection </h5>
    <button type="button" class="btn btn-close close-btn" (click)="close()">
        <i class="feather icon-x close-icon"></i>
    </button>
</div>
<!-- modal header component -->
<modal-header [isViewDelete]="false" [isViewMore]="false" [isViewSave]="false" [editSaveBtnText]="'Go'" 
 [isloading]="isLoading" [isViewCancel]="false"></modal-header>
<!-- content section -->
<div class="container-fluid pt-3 mb-5">
    <form [formGroup]="retailSalesCollection">
       <div class="row">
            <div class="col-md-1 d-flex align-items-center">
                <label for="inputPassword" class="col-form-label" id="ID001">Branch</label>
            </div>
            <div class="col-md-2 d-flex align-items-center">
                <mat-form-field appearance="outline" style="width: -webkit-fill-available;">
                    <input matInput="text" name="branch" autocomplete="off" formControlName="branch"/>
                    <app-branch-division [fetchData]="fetchedBranchData"
                    (newRowClick)="selectedData($event)" [branchView]="true" [divisionView]="false"
                    [additionalFilterAreaView]="false" [additionalFilterBCategView]="false"
                    class="branchDivisionelectr"
                    [matTooltip]="branchDivisionControlsTooltip"
                    matTooltipClass="custom-tooltip"
                    matTooltipPosition="above"
                    ></app-branch-division>
                </mat-form-field>
            </div>

            
            <div class="col-md-7 d-flex align-items-center">
                <app-date (selectedDate)="setDateValue($event)" [dateValue]="dateToPass"></app-date>

                <div class="col-md-1 checkboxAlign">
                    <div class="row">
                        <mat-checkbox formControlName="showDateCheckbox" >Show Date</mat-checkbox>
                    </div>
                    <div class="row">
                        <mat-checkbox formControlName="showInvoiceCheckbox">Show Invoice</mat-checkbox>
                    </div>
                </div>
            </div> 
       </div>
      

       <div class="row">
            <div class="col-md-4 checkBoxDiv">
                <div class="row">
                    <mat-checkbox formControlName="showSalesCheckbox">Sales</mat-checkbox>
                </div>
                <div class="row">
                    <mat-checkbox formControlName="showSalesReturnCheckbox">Sales Return</mat-checkbox>
                </div>
                <div class="row">
                    <mat-checkbox formControlName="showExbSalesCheckbox">Exb. Sales</mat-checkbox>
                </div>
                <div class="row">
                    <mat-checkbox formControlName="showExbSalesReturnCheckbox">Exb. Sales Return</mat-checkbox>
                </div>
                <div class="row">
                    <mat-checkbox formControlName="showAdvanceReceiptCheckbox"
                    (change)="onAdvanceReceiptCheckboxChange($event.checked)">Advance Receipt</mat-checkbox>
                </div>
                <div class="row">
                    <mat-checkbox formControlName="showSalesRegisterCheckbox">Sales Register</mat-checkbox> 
                </div>
                <div class="row">
                    <mat-checkbox formControlName="showOnlySummaryCheckbox">Only Summary</mat-checkbox>
                </div>
                <div class="row">
                    <mat-checkbox formControlName="landscapeFormat">Landscape Format</mat-checkbox>
                </div>
                <div class="row">
                    <mat-checkbox formControlName="OutpuGridView">Output in Grid View</mat-checkbox>
                </div>
            </div>
            
            <div class="col-md-6">
                <app-loader [isLoading]="isLoading" class="loader-overlay" ></app-loader>
                <dx-data-grid width="100%" height="310px" #gridContainer id="gridContainer" [allowColumnReordering]="true"
                    [dataSource]="APIData" [showColumnLines]="true" [showRowLines]="true"
                    [showBorders]="true" [columnAutoWidth]="true" (onSelectionChanged)="onGridSelection($event)"
                    [selectedRowKeys]="selectedRowKeys">

                    <dxo-filter-row [visible]="showFilterRow" [applyFilter]="currentFilter"></dxo-filter-row>
                    <dxo-paging [enabled]="false"></dxo-paging>
                    <dxo-editing mode="cell" [allowUpdating]="true">
                    </dxo-editing>
                    <dxo-selection mode="multiple" showCheckBoxesMode="always"></dxo-selection>

                    <dxi-column alignment="center" dataField="VOCTYPE"></dxi-column>
                    <dxi-column alignment="left" dataField="DESCRIPTION"></dxi-column>
                </dx-data-grid>
            </div>
        </div>

       <dx-popup  [width]="300" [height]="180" [showTitle]="true" container=".dx-viewport" title="Template Data" 
            [dragEnabled]="false" [showCloseButton]="false"
            (onHidden)="popupClosed()" [visible]="popupVisible">
            <div class="popup-content">
                <div class="form-group">
                  <label for="T_Name">Name:</label>
                  <input type="text" id="T_Name" class="form-control" formControlName="templateName"/>
                </div>
                <div class="button-group d-flex">
                    <button mat-flat-button [ngClass]="{'SaveNew_template': templateNameHasValue, 'btn-m-r-10': true, 'demo-button': true,
                    'btn-width': true,'mx-1': true }" (click)="saveTemplate_DB()">
                        {{ templateNameHasValue ? 'Save as New Template' : 'Save' }}
                    </button>
                    <button mat-flat-button class="btn-m-r-10 btn-width mx-1 cancelBTN" (click)="popupClosed()">Cancel</button>
                </div>
                <br>
                <br>
                <br>
            </div>
        </dx-popup>
       
        <div class="row mt-2 justify-content-end mx-2">
            <div class="icon-label-container" (click)="saveTemplate()" matTooltip="Save the selections as a new template">
              <i class="fa fa-bookmark fa-2x mt-3" style="color: #5497b2"></i>
              <span style="font-size: inherit;">Save as Template</span>
            </div>

            <div class="icon-label-container" (click)="previewClick()" matTooltip="Preview the content">
              <i class="fa fa-eye fa-2x" style="color: #5497b2"></i>
              <span class="label">Preview</span>
            </div>

            <div class="icon-label-container" matTooltip="Take a print">
              <i class="fa fa-print fa-2x" style="color: #031082"></i>
              <span class="label">Print</span>
            </div>

            <div class="icon-label-container"  matTooltip="Generate Excel Report">
              <i class="fa fa-file-excel fa-2x" style="color: green"></i>
              <span class="label">Excel</span>
            </div>

            <div class="icon-label-container" matTooltip="Generate PDF Report">
              <i class="fa fa-file-pdf fa-2x" style="color: orangered"></i>
              <span class="label">PDF</span>
            </div>

            <div class="icon-label-container" matTooltip="Sent through mail">
              <i class="fa fa-envelope fa-2x" style="color: deepskyblue"></i>
              <span class="label">Email</span>
            </div>

            <div class="icon-label-container" matTooltip="Sent through whatsapp">
              <i class="fab fa-whatsapp fa-2x" style="color: #29cf26"></i>
              <span style="font-size: inherit;">Whatsapp</span>
            </div>
        </div>

    </form>
  </div>
<div>
  <div
    class="pos-sales-modalheader border-bottom d-flex justify-content-between p-1"
  >
    <h5 class="pos-modaltitle" id="modal-dia-metal">Estimation</h5>
    <button type="button" class="btn btn-close close-btn" (click)="close()">
      <i class="feather icon-x close-icon"></i>
    </button>
  </div>
</div>

<div class="row p-2" style="margin: 6px 6px 0px 6px">
  <div class="col-xl-12">
    <form [formGroup]="vocDataForm" style="width: 100%; max-width: none">
      <div class="row" style="margin-bottom: 10px">
        <div
          class="col-md-12 d-flex justify-content-between align-items-center"
        >
          <div class="customheader">Voucher Details</div>
          <h4 class="customheader">POS Estimation No # {{ voucherNumber }}</h4>
        </div>
      </div>

      <div class="row" style="background-color: #efefef; margin-bottom: 10px">
        <div class="col-md-1 d-flex justify-content-center align-items-center">
          <div>
            <button
              type="button"
              color="primary"
              mat-flat-button
              [disabled]="isNewButtonDisabled"
              (click)="addNew()"
            >
              New
            </button>
          </div>
        </div>
        <div class="col-md-1">
          <label for="voc_type">Voucher</label>
          <mat-form-field appearance="outline" style="width: 100%">
            <input
              type="text"
              matInput
              id="voc_type"
              formControlName="voc_type"
              readonly
            />
          </mat-form-field>
        </div>
        <div class="col-md-1">
          <label for="fcn_voc_no">{{ vocno_lbl }}</label>
          <mat-form-field appearance="outline" style="width: 100%">
            <input
              type="text"
              NumberOnly
              (change)="ValidatingVocNo($event)"
              matInput
              formControlName="fcn_voc_no"
              [readonly]="voucherDetails?.LOCKVOUCHERNO || viewOnly"
              class="st_txt_right"
            />
          </mat-form-field>
        </div>
        <div class="col-md-1">
          <label for="txtCurrency">Currency</label>
          <mat-form-field appearance="outline" style="width: 100%">
            <input
              type="text"
              matInput
              id="txtCurrency"
              formControlName="txtCurrency"
              readonCustomer
              Detailsly
              [matAutocomplete]="currencyList"
            />
            <mat-autocomplete
              #currencyList="matAutocomplete"
              autoActiveFirstOption
              (optionSelected)="changeCurrency($event)"
            >
            </mat-autocomplete>
          </mat-form-field>
        </div>

        <div class="col-md-1">
          <label for="txtCurRate">Cur. Rate</label>
          <mat-form-field appearance="outline" style="width: 100%">
            <input
              class="st_txt_right"
              type="text"
              matInput
              id="txtCurRate"
              SixDecimalInput
              formControlName="txtCurRate"
              [readonly]="
                viewOnly ||
                this.vocDataForm.value.txtCurrency == this.comFunc.compCurrency
              "
              (change)="changeCurRate($event)"
            />
          </mat-form-field>
        </div>

        <div class="col-md-2">
          <label for="vocdate">Date</label>
          <mat-form-field appearance="outline" style="width: 100%">
            <input
              matInput
              DateValidation
              (dateChange)="formatDate($event)"
              [matDatepicker]="dob"
              readonly
              formControlName="vocdate"
              [min]="
                voucherDetails?.BLOCKBACKDATEDENTRIES
                  ? this.comFunc.currentDate
                  : null
              "
              [max]="
                voucherDetails?.BLOCKFUTUREDATE
                  ? this.comFunc.currentDate
                  : null
              "
              placeholder="DD/MM/YYYY"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="dob"
              [disabled]="viewOnly"
            ></mat-datepicker-toggle>
            <mat-datepicker #dob></mat-datepicker>
          </mat-form-field>
        </div>

        <div class="col-md-2">
          <label for="sales_person">{{ sales_person_lbl }}</label>
          <mat-form-field
            style="width: -webkit-fill-available"
            appearance="outline"
          >
            <input
              type="text"
              [readonly]="viewOnly"
              matInput
              (focusout)="
                SPvalidateLookupField(
                  $event,
                  enteredByCode,
                  'sales_person',
                  false
                )
              "
              formControlName="sales_person"
            />
            <master-search
              class="masterSearch"
              (focusout)="openTab($event, 'sales_person')"
              #salesPersonCode
              *ngIf="!viewOnly"
              [MasterSearchData]="enteredByCode"
              (newRowClick)="enteredBySelected($event)"
            ></master-search>
          </mat-form-field>
          <!-- <mat-form-field appearance="outline" style="width: 100%">
            <input type="text" matInput formControlName="sales_person" id="sales_person" [matAutocomplete]="salesperson"
              [readonly]="viewOnly" />
            <mat-autocomplete #salesperson="matAutocomplete" autoActiveFirstOption
              (optionSelected)="changeSalesPerson($event.option.value)">
              <mat-option *ngFor="let option of salesPersonFilteredOptions | async" [value]="option.SALESPERSON_CODE">
                {{ option.SALESPERSON_CODE + " - " + option.DESCRIPTION }}
              </mat-option>
            </mat-autocomplete>
            <i class="fas fa-chevron-down"
              style="position: absolute; right: 10px; top: 40%; transform: translateY(-40%);"></i>
            <mat-error *ngIf="vocDataForm.controls.sales_person.hasError('required')">
              Salesman Code cannot be Empty
            </mat-error>
            <mat-error *ngIf="vocDataForm.controls.sales_person.hasError('notInOptions')">
              Invalid value
            </mat-error>
          </mat-form-field> -->
        </div>

        <div
          class="col-md-3"
          style="background-color: #d6d8da; text-align: right"
        >
          <div class="form-group">
            <div
              class="font-weight-bold"
              style="font-size: 20px; font-weight: 400; color: #0d4f9e"
            >
              Net Total
            </div>
            <div style="font-size: 22px; font-weight: 500">
              {{ comFunc.compCurrency }}
              {{ order_items_total_net_amount | decimalFormat : "AMOUNT" }}
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
<div class="row" style="padding: 0px 15px 15px 15px">
  <div class="col-xl-9">
    <div style="background-color: #ffffff">
      <div>
        <div class="customheader" style="margin-bottom: 12px">
          Customer Details
        </div>
        <form
          [formGroup]="customerDataForm"
          style="width: 100%; max-width: none"
        >
          <div class="row">
            <div class="col-md-2">
              <label for="fcn_customer_mobile">Mobile Number</label>
              <mat-form-field appearance="outline" style="width: 100%">
                <input
                  type="text"
                  id="fcn_customer_mobile"
                  onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                  matInput
                  (focusout)="!viewOnly && onCustomerNameFocus()"
                  formControlName="fcn_customer_mobile"
                  [readonly]="viewOnly"
                />
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_mobile.hasError(
                      'required'
                    )
                  "
                >
                  Mobile number is <strong>required</strong>
                </mat-error>
              </mat-form-field>
            </div>

            <div class="col-md-2">
              <label for="fcn_customer_name">Name</label>
              <mat-form-field appearance="outline" style="width: 100%">
                <input
                  type="text"
                  matInput
                  formControlName="fcn_customer_name"
                  (change)="nameChange($event)"
                  [readonly]="viewOnly"
                  appNoEmptySpace
                />
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_name.hasError(
                      'required'
                    )
                  "
                >
                  Name is <strong>required</strong>
                </mat-error>
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_name.hasError(
                      'pattern'
                    )
                  "
                >
                  Whitespace Not Allowed
                </mat-error>
              </mat-form-field>
            </div>
            <div class="col-md-2">
              <label for="fcn_customer_code">Code</label>
              <mat-form-field appearance="outline" style="width: 100%">
                <input
                  type="text"
                  matInput
                  (change)="triggerCustomerEntry($event)"
                  formControlName="fcn_customer_code"
                />
                <master-search
                  *ngIf="!viewOnly"
                  [MasterSearchData]="customerCodeData"
                  (newRowClick)="triggerCustomerMasterSearch($event)"
                  class="masterSearch"
                ></master-search>
              </mat-form-field>
            </div>

            <!-- <div class="col-md-2">
              <label for="fcn_customer_code">Code</label>

              <mat-form-field appearance="outline" style="width: 100%">
                <input type="text" matInput formControlName="fcn_customer_code" id="fcn_customer_code"
                  (change)="triggerCustomerEntry($event)" [readonly]="viewOnly" />
              <mat-error *ngIf="advanceReceiptForm.controls.fcn_customer_code.hasError('required')" id="ID079">
                  Code is <strong>required</strong>
                </mat-error> -->
            <!-- </mat-form-field>

              <master-search *ngIf="!viewOnly" [MasterSearchData]="customerCodeData"
              (newRowClick)="triggerCustomerMasterSearch($event)"></master-search> -->

            <!-- </div> -->

            <div class="col-md-2">
              <label for="fcn_customer_id_type">ID Type</label>
              <mat-form-field appearance="outline" style="width: 100%">
                <input
                  type="text"
                  matInput
                  formControlName="fcn_customer_id_type"
                  [matAutocomplete]="idtype"
                  readonly
                />
                <mat-autocomplete
                  #idtype="matAutocomplete"
                  (optionSelected)="changeIdtype($event.option.value)"
                  autoActiveFirstOption
                >
                  <mat-option
                    *ngFor="let option of idTypeFilteredOptions | async"
                    [value]="option"
                  >
                    {{ option }}
                  </mat-option>
                </mat-autocomplete>
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_id_type.hasError(
                      'required'
                    )
                  "
                >
                  ID Type is <strong>required</strong>
                </mat-error>
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_id_type.hasError(
                      'notInOptions'
                    )
                  "
                >
                  Invalid value
                </mat-error>
              </mat-form-field>
            </div>

            <div class="col-md-2">
              <label for="fcn_customer_id_number">ID#</label>
              <mat-form-field appearance="outline" style="width: 100%">
                <input
                  type="text"
                  matInput
                  formControlName="fcn_customer_id_number"
                  [readonly]="viewOnly"
                  appNoEmptySpace
                />
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_id_number.hasError(
                      'required'
                    )
                  "
                >
                  ID# is <strong>required</strong>
                </mat-error>
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_id_number.hasError(
                      'minlength'
                    )
                  "
                >
                  ID# must be at least
                  {{
                    customerDataForm
                      .get("fcn_customer_id_number")
                      ?.getError("minlength").requiredLength
                  }}
                  characters long.
                </mat-error>
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_id_number.hasError(
                      'maxlength'
                    )
                  "
                >
                  ID# must not exceed
                  {{
                    customerDataForm
                      .get("fcn_customer_id_number")
                      ?.getError("maxlength").requiredLength
                  }}
                  characters.
                </mat-error>
              </mat-form-field>
            </div>

            <div class="col-md-2 d-flex align-items-end">
              <button
                type="button"
                style="font-size: 12px"
                (click)="
                  open(
                    more_customer_detail_modal,
                    false,
                    null,
                    false,
                    false,
                    true
                  )
                "
                mat-flat-button
                class="update-finish-button"
                [disabled]="viewOnly"
              >
                {{
                  this.customerDetails.MOBILE == null || undefined
                    ? "Add Customer"
                    : "Edit Customer"
                }}
              </button>
            </div>
          </div>

          <div class="row" style="margin-top: 20px">
            <div class="col-md-2">
              <label for="fcn_customer_exp_date">Expiry Date</label>
              <mat-form-field appearance="outline" style="width: 100%">
                <input
                  matInput
                  [matDatepicker]="expDate"
                  name="fcn_customer_exp_date"
                  formControlName="fcn_customer_exp_date"
                  placeholder="DD/MM/YYYY"
                  [min]="currentDate"
                  [readonly]="viewOnly"
                  DateValidation
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="expDate"
                  [disabled]="viewOnly"
                ></mat-datepicker-toggle>
                <mat-datepicker
                  [startAt]="currentDate"
                  #expDate
                ></mat-datepicker>
                <mat-error
                  *ngIf="
                    customerDataForm.controls.fcn_customer_exp_date.hasError(
                      'required'
                    )
                  "
                >
                  Expiry date is <strong>required</strong>
                </mat-error>
              </mat-form-field>
            </div>

            <div
              class="col-md-3 d-flex justify-content-center align-items-center checkBoxCustom"
              [style.pointer-events]="viewOnly ? 'none' : 'auto'"
            >
              <mat-checkbox color="primary" formControlName="tourVatRefuncYN">
                Tourist VAT Refund Ref #
              </mat-checkbox>
            </div>

            <div
              class="col-md-3"
              *ngIf="customerDataForm.value.tourVatRefuncYN"
            >
              <label for="tourVatRefundNo">Tourist VAT Refund Ref #</label>
              <mat-form-field appearance="outline" style="width: 100%">
                <input type="text"   #tourVatRefundNo
                id="tourVatRefundNo" matInput formControlName="tourVatRefundNo" />
              </mat-form-field>
            </div>
          </div>
        </form>

        <div class="col-md-12 m-t-10" style="padding: 0px">
          <div class="customheader">Line Items</div>
          <mat-tab-group>
            <mat-tab label="Sold Item">
              <div class="table-responsive">
                <div class="content">
                  <div class="left">
                    <div class="wrapper">
                      <div class="container" style="padding: 0px">
                        <dx-data-grid
                          id="gridContainer"
                          [dataSource]="ordered_items"
                          keyExpr="ID"
                          [showBorders]="true"
                          (onRowRemoved)="removeLineItemsGrid($event)"
                          (onEditingStart)="editTable($event)"
                        >
                          <dxo-editing
                            [allowUpdating]="true"
                            [allowDeleting]="!viewOnly"
                          >
                            <dxo-texts
                              alignment="right"
                              [editRow]="viewOnly ? 'View' : 'Edit'"
                              deleteRow="Remove"
                            >
                            </dxo-texts>
                          </dxo-editing>

                          <!-- <dxo-selection mode="single"></dxo-selection> -->
                          <dxi-column
                            dataField="sn_no"
                            [width]="80"
                            caption="SL No."
                            [allowEditing]="false"
                            alignment="center"
                          >
                          </dxi-column>
                          <dxi-column
                            dataField="stock_code"
                            [width]="100"
                            [allowEditing]="false"
                          >
                          </dxi-column>
                          <dxi-column
                            dataField="description"
                            [width]="150"
                            [allowEditing]="false"
                            alignment="center"
                          >
                          </dxi-column>

                          <dxi-column
                            dataField="pcs"
                            caption="Pcs"
                            [width]="100"
                            [allowEditing]="false"
                          ></dxi-column>
                          <dxi-column
                            dataField="weight"
                            caption="Weight"
                            [width]="100"
                            [format]="weightDecimalFormat"
                            [allowEditing]="false"
                          >
                          </dxi-column>
                          <dxi-column
                            dataField="metal_amt"
                            caption="Metal Value"
                            [width]="100"
                            [allowEditing]="false"
                            [format]="amountDecimalFormat"
                          ></dxi-column>

                          <dxi-column
                            dataField="total_amount"
                            caption="Mkg amount"
                            alignment="right"
                            [allowEditing]="false"
                            [format]="amountDecimalFormat"
                            [width]="150"
                          ></dxi-column>
                          <dxi-column
                            dataField="net_amount"
                            caption="Total amount"
                            alignment="right"
                            format="currency"
                            [format]="amountDecimalFormat"
                            [allowEditing]="false"
                            [width]="150"
                          >
                          </dxi-column>
                          <!-- <dxi-column caption="Actions" [width]="100" [allowEditing]="false">
                          </dxi-column> -->
                          <!-- <dxi-column type="buttons" >
                                                      <dxi-button template="orders">
                                                          <div *dxTemplate="let data of 'orders'">
                                                              <a class="badge m-r-5 badge-warning" [(ngModel)]="data" (click)="editTable($event)"><i class="feather icon-edit"></i></a>
  
                                                          </div>
                                                      </dxi-button>
                                                  </dxi-column> -->
                          <dxo-summary>
                            <dxi-total-item column="sn_no"> </dxi-total-item>
                            <dxi-total-item
                              column="stock_code"
                              summaryType="min"
                              [customizeText]="customizeDate"
                            >
                            </dxi-total-item>

                            <dxi-total-item
                              column="pcs"
                              summaryType="sum"
                              [customizeText]="customizeQty"
                            >
                            </dxi-total-item>

                            <dxi-total-item
                              column="metal_amt"
                              summaryType="sum"
                              displayFormat="{0}"
                              precision="2"
                              [valueFormat]="gridAmountDecimalFormat"
                            >
                            </dxi-total-item>

                            <dxi-total-item
                              column="weight"
                              summaryType="sum"
                              caption="Weight"
                              [valueFormat]="weightDecimalFormat"
                              displayFormat="{0}"
                            >
                              >
                              <!-- [customizeText]="customizeWeight" -->
                            </dxi-total-item>

                            <dxi-total-item
                              column="total_amount"
                              summaryType="sum"
                              displayFormat="{0}"
                              type="fixedPoint"
                              precision="2"
                              [valueFormat]="gridAmountDecimalFormat"
                            >
                            </dxi-total-item>
                            <dxi-total-item
                              column="net_amount"
                              summaryType="sum"
                              displayFormat="{0}"
                              precision="2"
                              [valueFormat]="gridAmountDecimalFormat"
                            >
                            </dxi-total-item>
                            <!-- <dxi-total-item column="total_amount" summaryType="sum" displayFormat="AED {0}"
                                [valueFormat]="{ currency: 'AED' }">
                              </dxi-total-item> -->
                          </dxo-summary>
                        </dx-data-grid>
                      </div>

                      <div>
                        <!-- type="submit"
                            [disabled]="this.viewOnly || this.amlNameValidation == true ? (this.customerDataForm.value.fcn_customer_mobile != '') ? false : true : false
                            type="submit"
                              [disabled]="this.customerDataForm.value.fcn_customer_mobile != '' && this.customerDataForm.value.fcn_customer_name != '' ? false: true
                              "
                            " -->
                        <!-- <button type="submit" [disabled]="this.viewOnly" (click)="open(mymodal)" -->
                        <!-- <button type="submit" (click)="open(mymodal)" [disabled]="this.viewOnly " -->
                        <button
                          class="btn btn-secondary"
                          type="submit"
                          [disabled]="this.viewOnly"
                          (click)="
                            amlNameValidation && isCustomerDetailsEmpty()
                              ? triggerAmlValidation()
                              : openSalesModalAfterAML()
                          "
                          style="
                            border: none;
                            margin: 10px;
                            width: 20px !important;
                            padding: 3px 10px;
                            padding-right: 21px;
                            background-color: #1e3c72;
                          "
                        >
                          <i class="fa fa-plus"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-tab>
            <mat-tab label="Sales Return">
              <div class="table-responsive">
                <div class="content">
                  <div class="left">
                    <div class="wrapper">
                      <div class="container">
                        <dx-data-grid
                          id="sales_return_grid"
                          [dataSource]="sales_returns_items"
                          keyExpr="ID"
                          (onRowRemoved)="removeSalesReturnGrid($event)"
                          (onEditingStart)="editTableSalesReturn($event)"
                          [showBorders]="true"
                          [allowColumnResizing]="true"
                          [columnAutoWidth]="true"
                        >
                          <dxo-editing
                            [allowUpdating]="true"
                            [allowDeleting]="!viewOnly"
                          >
                            <dxo-texts
                              [editRow]="viewOnly ? 'View' : 'Edit'"
                              deleteRow="Remove"
                            >
                            </dxo-texts>
                          </dxo-editing>
                          <!-- <dxo-selection mode="single"></dxo-selection> -->
                          <dxi-column
                            dataField="sn_no"
                            [width]="70"
                            caption="SL No."
                            [allowEditing]="false"
                          >
                          </dxi-column>
                          <dxi-column
                            dataField="stock_code"
                            [width]="120"
                            [allowEditing]="false"
                          >
                          </dxi-column>
                          <dxi-column
                            dataField="description"
                            [width]="200"
                            [allowEditing]="false"
                          ></dxi-column>

                          <dxi-column
                            dataField="pcs"
                            caption="Pcs"
                            [width]="100"
                            [allowEditing]="false"
                          ></dxi-column>
                          <dxi-column
                            dataField="weight"
                            caption="Weight"
                            [width]="100"
                            [allowEditing]="false"
                            displayFormat="Wt: {0}"
                            [format]="weightDecimalFormat"
                          >
                          </dxi-column>

                          <dxi-column
                            dataField="mkg_amount"
                            alignment="right"
                            format="currency"
                            [width]="150"
                            [allowEditing]="false"
                            [format]="amountDecimalFormat"
                          ></dxi-column>
                          <dxi-column
                            dataField="net_amount"
                            alignment="right"
                            format="currency"
                            [allowEditing]="false"
                            [format]="amountDecimalFormat"
                            [width]="150"
                          >
                          </dxi-column>
                          <!-- <dxi-column type="buttons" >
                                                  <dxi-button template="orders">
                                                      <div *dxTemplate="let data of 'orders'">
                                                          <a class="badge m-r-5 badge-warning" [(ngModel)]="data" (click)="editTable($event)"><i class="feather icon-edit"></i></a>
  
                                                      </div>
                                                  </dxi-button>
                                              </dxi-column> -->
                          <dxo-summary>
                            <dxi-total-item column="sn_no"> </dxi-total-item>
                            <dxi-total-item
                              column="stock_code"
                              summaryType="min"
                              [customizeText]="customizeDate"
                            >
                            </dxi-total-item>

                            <dxi-total-item
                              column="pcs"
                              summaryType="sum"
                              [customizeText]="customizeQty"
                            >
                            </dxi-total-item>

                            <dxi-total-item
                              column="weight"
                              summaryType="sum"
                              caption="Total Wt"
                              [valueFormat]="weightDecimalFormat"
                              displayFormat="Wt: {0}"
                            >
                              <!-- [customizeText]="customizeWeight" -->
                            </dxi-total-item>

                            <dxi-total-item
                              column="mkg_amount"
                              summaryType="sum"
                              [valueFormat]="gridAmountDecimalFormat"
                              displayFormat="AED {0}"
                            >
                            </dxi-total-item>
                            <dxi-total-item
                              column="net_amount"
                              summaryType="sum"
                              [valueFormat]="gridAmountDecimalFormat"
                              displayFormat="AED {0}"
                            >
                              <!-- [valueFormat]="{ currency: 'EUR' }" -->
                            </dxi-total-item>
                          </dxo-summary>
                        </dx-data-grid>

                        <div>
                          <button
                            type="submit"
                            [disabled]="
                              this.ordered_items.length > 0 && !this.viewOnly
                                ? false
                                : true
                            "
                            (click)="open(adjust_sale_return_modal)"
                            class="btn btn-secondary"
                            style="
                              border: none;
                              margin: 10px;
                              width: 20px !important;
                              padding: 3px 10px;
                              padding-right: 21px;
                              background-color: #1e3c72;
                            "
                          >
                            <i class="fa fa-plus"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-tab>
            <mat-tab label="Exchange">
              <div class="table-responsive">
                <div class="content">
                  <div class="left">
                    <div class="wrapper">
                      <div class="container">
                        <dx-data-grid
                          id="exchange_item_grid"
                          [dataSource]="exchange_items"
                          keyExpr="ID"
                          (onRowRemoved)="removeExchangeItemGrid($event)"
                          [showBorders]="true"
                          (onEditingStart)="editTableExchangeItem($event)"
                        >
                          <!-- <dxo-editing [allowUpdating]="false" [allowDeleting]="true">
                              <dxo-texts deleteRow="Remove"> </dxo-texts>
                            </dxo-editing> -->
                          <dxo-editing
                            [allowUpdating]="true"
                            [allowDeleting]="!viewOnly"
                          >
                            <dxo-texts
                              [editRow]="viewOnly ? 'View' : 'Edit'"
                              deleteRow="Remove"
                            >
                            </dxo-texts>
                          </dxo-editing>
                          <!-- <dxo-selection mode="single"></dxo-selection> -->
                          <dxi-column
                            dataField="sn_no"
                            [width]="100"
                            caption="SL No."
                            [allowEditing]="false"
                          >
                          </dxi-column>
                          <dxi-column
                            dataField="stock_code"
                            [width]="120"
                            [allowEditing]="false"
                          >
                          </dxi-column>
                          <dxi-column
                            dataField="description"
                            [width]="200"
                            [allowEditing]="false"
                          ></dxi-column>

                          <dxi-column
                            dataField="pcs"
                            caption="Pcs"
                            [width]="100"
                            [allowEditing]="false"
                          ></dxi-column>

                          <dxi-column
                            dataField="weight"
                            caption="Weight"
                            [width]="100"
                            [allowEditing]="false"
                            [format]="weightDecimalFormat"
                          >
                          </dxi-column>

                          <dxi-column
                            dataField="net_amount"
                            alignment="right"
                            [format]="amountDecimalFormat"
                            [allowEditing]="false"
                          >
                          </dxi-column>
                          <!-- <dxi-column type="buttons" >
                                                  <dxi-button template="orders">
                                                      <div *dxTemplate="let data of 'orders'">
                                                          <a class="badge m-r-5 badge-warning" [(ngModel)]="data" (click)="editTable($event)"><i class="feather icon-edit"></i></a>
  
                                                      </div>
                                                  </dxi-button>
                                              </dxi-column> -->
                          <dxo-summary>
                            <dxi-total-item column="sn_no"> </dxi-total-item>
                            <dxi-total-item
                              column="stock_code"
                              summaryType="min"
                              [customizeText]="customizeDate"
                            >
                            </dxi-total-item>

                            <dxi-total-item
                              column="pcs"
                              summaryType="sum"
                              [customizeText]="customizeQty"
                            >
                            </dxi-total-item>

                            <dxi-total-item
                              column="weight"
                              summaryType="sum"
                              caption="Total Wt"
                              [valueFormat]="weightDecimalFormat"
                              displayFormat="Wt: {0}"
                            >
                              <!-- [customizeText]="customizeWeight" -->
                            </dxi-total-item>

                            <dxi-total-item
                              column="net_amount"
                              summaryType="sum"
                              [valueFormat]="gridAmountDecimalFormat"
                              displayFormat="AED {0}"
                            >
                              <!-- [valueFormat]="{ currency: 'EUR' }" -->
                            </dxi-total-item>
                          </dxo-summary>
                        </dx-data-grid>

                        <div>
                          <button
                            type="submit"
                            [disabled]="
                              this.ordered_items.length > 0 && !this.viewOnly
                                ? false
                                : true
                            "
                            (click)="open(oldgoldmodal)"
                            class="btn btn-secondary"
                            style="
                              color: white;
                              border: none;
                              margin: 10px;
                              width: 20px !important;
                              padding: 3px 10px;
                              padding-right: 21px;
                              background-color: #1e3c72;
                            "
                          >
                            <i class="fa fa-plus"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-tab>
          </mat-tab-group>
          <hr style="width: 100%" />
        </div>

        <div class="row" style="margin-top: 0px">
          <!-- <div class="col-md-2">
            <label>Remarks</label>
            <div class="col-md-10">
              <mat-form-field appearance="outline" style="width: 100%;">
                <textarea matInput [readonly]="viewOnly" rows="4" cols="50" class="form-control"></textarea>
              </mat-form-field>
            </div>

          </div> -->

          <!-- <div class="col-md-6" *ngIf="enableJawahara"> -->
          <!-- <div class="col-md-4">
            <div *ngIf="this.comFunc.compAcCode == 'JHO001'">
              <form [formGroup]="invoiceWiseForm" novalidate>
                <div class="row">
                  <div class="col-md-6">
                    <mat-checkbox color="primary" formControlName="serviceInv">Service
                      Invoice</mat-checkbox>
                  </div>
                  <div class="col-md-6">
                    <mat-checkbox color="primary" formControlName="lifeTimeWarr">Life Time
                      Warranty</mat-checkbox>
                  </div>
                </div>
              </form>
            </div>

            <div *ngIf="
                this.comFunc.compAcCode == 'JHO001' && strBranchcode == 'JHRSDF'
              ">
              <div class="row">
                <mat-checkbox color="primary" [(ngModel)]="showBoarding">Boarding Pass
                  Details</mat-checkbox>
              </div>
              <div class="card m-t-10" *ngIf="showBoarding">
                <div class="card-header">
                  <b>Boarding Pass Details</b>
                </div>
                <div class="card-body">
                  <form [formGroup]="boardingPassForm" novalidate>
                    <div class="row" style="margin-top: 0px">
                      <div class="col-md-6">
                        <mat-form-field>
                          <mat-label>Pass Details</mat-label>
                          <input type="text" matInput formControlName="passDetails" id="passDetails"
                            [readonly]="viewOnly" />
                        </mat-form-field>
                        <mat-form-field>
                          <mat-label>Flight No.</mat-label>
                          <input type="text" matInput formControlName="flightNo" id="flightNo" [readonly]="viewOnly" />
                        </mat-form-field>
                      </div>
                      <div class="col-md-6">
                        <mat-form-field>
                          <mat-label>Boarding To</mat-label>
                          <input type="text" matInput formControlName="boardingTo" id="boardingTo"
                            [readonly]="viewOnly" />
                        </mat-form-field>
                        <mat-form-field>
                          <mat-label>Boarding Date</mat-label>
                          <input matInput [matDatepicker]="boardingDate" name="boardingDate"
                            formControlName="boardingDate" placeholder="DD/MM/YYYY" [readonly]="viewOnly" />
                          <mat-datepicker-toggle matSuffix [for]="boardingDate"></mat-datepicker-toggle>
                          <mat-datepicker [startAt]="currentDate" #boardingDate></mat-datepicker>
                        </mat-form-field> -->

          <!-- <div class="row">
                        <div class="col-md-6">
                          <button
                          class="rounded"

                          color="primary"
                            [disabled]="viewOnly"
                          >
                            Cust. Extra Details
                          </button>
                        </div>
                        <div class="col-md-6">
                          <button
                          class="rounded"
                            color="primary"
                            [disabled]="viewOnly"
                          >
                            Boarding Pass Details
                          </button>
                        </div>
                      </div> -->
          <!-- </div>

                      <div class="text-center">
                        <button class="mt-2" mat-flat-button color="primary" [disabled]="viewOnly"
                          (click)="getCustDetails()">
                          Get Customer Details
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div> -->
        </div>
      </div>
    </div>
  </div>
  <div class="col-xl-3">
    <div class="card" style="background-color: #ececec !important">
      <div class="card-body">
        <div class="row" style="width: 100%">
          <div
            class="col-xl-12 col-md-6"
            style="height: 140px; overflow-y: scroll; width: 100%"
          >
            <table class="tabletd_gray" style="width: 100%">
              <tr>
                <th style="width: 30%">Karat</th>
                <th style="width: 35%">Sale</th>
                <th style="width: 35%">Purchase</th>
              </tr>
              <tr *ngFor="let krd of karatRateDetails; let id = index">
                <td>{{ krd.KARAT_CODE }}</td>
                <td style="text-align: right; padding-right: 3px">
                  <input
                    type="number"
                    (change)="changeKaratRate($event, id)"
                    style="text-align: right"
                    onwheel="this.blur()"
                    [value]="krd.KARAT_RATE"
                    class="karat_code"
                    readonly
                  />
                </td>
                <td style="text-align: right; padding-right: 3px">
                  {{ krd.POPKARAT_RATE }}
                </td>
              </tr>
            </table>
          </div>

          <div class="col-xl-12 col-md-6" style="width: 100%">
            <table class="m-t-10 rhs-table-1" style="width: 100%">
              <tr>
                <td class="td-w-40">Item Total</td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id
                    value="{{
                      prnt_inv_total_gross_amt | decimalFormat : 'AMOUNT'
                    }}"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                  />
                </td>
              </tr>
              <tr>
                <td class="td-w-40">Tax Amount</td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id
                    value="{{
                      this.order_items_total_tax | decimalFormat : 'AMOUNT'
                    }}"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                  />
                </td>
              </tr>
              <tr>
                <td class="td-w-40">Gross Total</td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id
                    value="{{
                      order_items_total_gross_amount | decimalFormat : 'AMOUNT'
                    }}"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                  />
                </td>
              </tr>
              <tr>
                <td class="td-w-40" style="background: #adacab">
                  Sales Return
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id
                    value="{{
                      invReturnSalesTotalNetTotal | decimalFormat : 'AMOUNT'
                    }}"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                  />
                </td>
              </tr>
              <tr>
                <td class="td-w-40" style="background: #adacab">Exchange</td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id
                    value="{{
                      order_total_exchange | decimalFormat : 'AMOUNT'
                    }}"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                  />
                </td>
              </tr>
              <tr>
                <td
                  class="td-w-40"
                  style="background-color: #1a61a9; color: #fff"
                >
                  <b>Roundoff Discount</b>
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id="discountInput"
                    [(ngModel)]="order_items_total_discount_amount"
                    (focus)="clearField()"
                    (blur)="
                      order_items_total_discount_amount = formatValue(
                        order_items_total_discount_amount
                      )
                    "
                    (change)="changeFinalDiscount($event)"
                    aria-describedby="helpId"
                    [placeholder]="zeroAmtVal"
                    [readonly]="viewOnly || isNoDiscountAllowed"
                  />
                </td>
              </tr>
              <tr>
                <td
                  class="td-w-40"
                  style="background-color: #1a61a9; color: #fff"
                >
                  <b>Net Amount</b>
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id
                    value="{{ netTotal | decimalFormat : 'AMOUNT' }}"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                  />
                </td>
              </tr>

              <tr>
                <td
                  class="td-w-40"
                  style="background-color: #1a61a9; color: #fff"
                >
                  <b>Receipt Total</b>
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id
                    [(ngModel)]="receiptTotalNetAmt"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                    AmountDecimalInput
                  />
                </td>
              </tr>

              <tr>
                <td
                  class="td-w-40"
                  style="background-color: #1a61a9; color: #fff"
                >
                  <b>VAT Round Off</b>
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control textboxcorner"
                    id="vatroundoff"
                    [(ngModel)]="vatRoundOffAmt"
                    aria-describedby
                    [placeholder]="zeroAmtVal"
                    readonly
                  />
                </td>
              </tr>
            </table>
          </div>
        </div>

        <div
          class="col-xl-12 col-md-6"
          style="height: 140px; width: 100%; margin-top: 20px"
        >
          <label>Remarks</label>

          <mat-form-field appearance="outline" style="width: 100%">
            <textarea
              matInput
              [readonly]="viewOnly"
              rows="4"
              cols="50"
              class="form-control"
            ></textarea>
          </mat-form-field>
        </div>

        <div class="row m-t-10 m-b-10">
          <!-- <div class="col-md-6 col-xl-6" (click)="backToList()" *ngIf="viewOnly">
            <div class="touch-big-button touch-big-button-black">
              <div class="touch-big-button-inner">
                <i class="fa fa-arrow-circle-left"></i> <span> Back</span>
              </div>
            </div>
          </div> -->

          <!-- matTooltip="You have already saved"
          [matTooltipDisabled]="isSaved" -->
          <div
            class="col-md-6 col-xl-6"
            (click)="viewOnly || isSaved ? '' : saveOrder()"
            *ngIf="!viewOnly"
          >
            <div class="touch-big-button touch-big-button-black">
              <div class="touch-big-button-inner">
                <i class="fa fa-save"></i> <span> Save Bill</span>
              </div>
            </div>
          </div>

          <!-- <div class="col-md-6 col-xl-6 mt-2" (click)="this.viewOnly || this.editOnly ? sendToEmail() : ''">
            <div class="touch-big-button">
              <div class="touch-big-button-inner">
                <i class="fa fa-print"></i> <span> Send Email</span>
              </div>
            </div>
          </div> -->
          <div
            class="col-md-6 col-xl-6"
            (click)="viewOnly || isSaved ? '' : saveOrder('continue')"
            *ngIf="!viewOnly"
          >
            <div class="touch-big-button touch-big-button-black">
              <div class="touch-big-button-inner">
                <i class="fa fa-save"></i> <span> Save & Continue</span>
              </div>
            </div>
          </div>
        </div>

        <div class="row mt-2">
          <div
            class="col-md-6 col-xl-6"
            *ngIf="this.viewOnly || isPrintingEnabled"
            (click)="auditTrailClick()"
          >
            <div class="touch-big-button touch-big-button-black">
              <div class="touch-big-button-inner">
                <i class="fa fa-book"></i>
                <span> Audit Trail</span>
              </div>
            </div>
          </div>

          <div
            class="col-md-6 col-xl-6"
            [class.disabled]="viewOnly"
            (click)="!isNewButtonDisabled && cancelBill()"
          >
            <div class="touch-big-button">
              <div class="touch-big-button-inner">
                <i class="fa fa-window-close"></i>
                <span> Cancel Bill</span>
              </div>
            </div>
          </div>
        </div>
        <div class="row mt-2" *ngIf="viewOnly || isPrintingEnabled">
          <div class="col-md-6 col-xl-6" (click)="printReceiptDetailsWeb()">
            <div class="touch-big-button">
              <div class="touch-big-button-inner">
                <i class="fa fa-print"></i> <span> Print Bill</span>
              </div>
            </div>
          </div>

          <div class="col-md-6 col-xl-6" (click)="exportPdf()">
            <div class="touch-big-button">
              <div class="touch-big-button-inner">
                <i class="fa fa-file-export"></i> <span> Export to PDF</span>
              </div>
            </div>
          </div>
        </div>

        <!-- <div class="col-xl-12 col-md-6" style="height: 140px; width: 100%;margin-top: 20px;">
          <label>Remarks</label>

          <mat-form-field appearance="outline" style="width: 100%;">
            <textarea matInput [readonly]="viewOnly" rows="4" cols="50" class="form-control"></textarea>
          </mat-form-field>

        </div> -->
      </div>
    </div>
  </div>
</div>

<ng-template #paramGrid let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Exchange</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true"></span>
    </button>
  </div>

  <div class="modal-body">
    <dx-data-grid>
      <dxi-column dataField="slno" caption="Serial No"></dxi-column>
      <dxi-column dataField="data" caption="Data"></dxi-column>
      <dxi-column dataField="entry" caption="Entry"></dxi-column>
      <dxi-column dataField="points" caption="Points"></dxi-column>
    </dx-data-grid>
  </div>
</ng-template>

<ng-template #oldgoldmodal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Exchange</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="closeExchange()"
    >
      <span aria-hidden="true"></span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <form [formGroup]="exchangeForm">
        <div class="col-md-12">
          <div class="bg-gray-card">
            <div class="form-group row">
              <div class="col-md-3">
                <label class="col-sm-4" for="exchange_division" id="ID094"
                  >Division</label
                >
                <div class="form-group row">
                  <div class="col-sm-12">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        matInput
                        formControlName="fcn_exchange_division"
                        readonly
                      />
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-3">
                <label class="col-sm-5" for="exchange_item_code" id="ID095"
                  >Stock Code</label
                >
                <div class="form-group row">
                  <div class="col-sm-12">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        matInput
                        formControlName="fcn_exchange_item_code"
                        id="fcn_exchange_item_code"
                        [matAutocomplete]="stockId"
                        [readonly]="viewOnly"
                        (change)="exchangeStockCode($event)"
                      />
                      <mat-autocomplete
                        #stockId="matAutocomplete"
                        (optionSelected)="getStockforExchange()"
                        autoActiveFirstOption
                      >
                        <mat-option
                          *ngFor="
                            let option of exStockCodeFilteredOptions | async
                          "
                          [value]="option"
                        >
                          {{ option }}
                        </mat-option>
                      </mat-autocomplete>

                      <mat-error
                        *ngIf="
                          exchangeForm.controls.fcn_exchange_item_code.hasError(
                            'notInOptions'
                          )
                        "
                        id="ID009"
                      >
                        Invalid value
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <label class="col-sm-6" for="exchange_item_desc" id="ID096"
                  >Stock Description
                </label>
                <div class="form-group row">
                  <div class="col-sm-12">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        matInput
                        formControlName="fcn_exchange_item_desc"
                        readonly
                      />
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="form-group row">
            <div class="col-md-3">
              <label class="col-sm-4" for="exchange_pcs" id="ID097">Pcs</label>
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="number"
                      class="text-right"
                      [min]="0"
                      [maxLength]="8"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      matInput
                      formControlName="fcn_exchange_pcs"
                      [readonly]="viewOnly"
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-4" for="exchange_gross_wt" id="ID098"
                >Gross Wt</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="number"
                      [min]="0"
                      [maxLength]="10"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      id="fcn_exchange_gross_wt"
                      matInput
                      formControlName="fcn_exchange_gross_wt"
                      (focusout)="getExchangeNwtWt($event)"
                      [readonly]="viewOnly"
                      MetalDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-4" for="exchange_stone_wt" id="ID099"
                >Stone Wt</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      [min]="0"
                      [maxLength]="10"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      [max]="
                        this.comFunc.emptyToZero(
                          this.exchangeForm.value.fcn_exchange_gross_wt
                        )
                      "
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_stone_wt"
                      (change)="changeExchangeStoneWt($event)"
                      id="fcn_exchange_stone_wt"
                      StoneDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-4" for="exchange_net_wt" id="ID100"
                >Net Wt</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      [min]="0"
                      [maxLength]="10"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_net_wt"
                      readonly
                      id="fcn_exchange_net_wt"
                      [max]="
                        this.comFunc.emptyToZero(
                          this.exchangeForm.value.fcn_exchange_gross_wt
                        )
                      "
                      (change)="changeExchangeNettWt($event)"
                      MetalDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="form-group row">
            <div class="col-md-3">
              <label class="col-sm-7" for="exchange_chargeable_wt" id="ID101"
                >Chargeable wt</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      [min]="0"
                      [maxLength]="14"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_chargeable_wt"
                      readonly
                      id="fcn_exchange_chargeable_wt"
                      [max]="
                        this.comFunc.emptyToZero(
                          this.exchangeForm.value.fcn_exchange_gross_wt
                        )
                      "
                      MetalDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-4" for="exchange_purity" id="ID102"
                >Purity</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="number"
                      [min]="this._exchangeItemchange?.PURITY_FROM || 0"
                      [max]="this._exchangeItemchange?.PURITY_TO"
                      [step]="0.01"
                      [maxLength]="14"
                      (change)="changeExPurity($event)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_purity"
                      [readonly]="viewOnly"
                      id="fcn_exchange_purity"
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-6" for="exchange_pure_weight" id="ID103"
                >Pure Weight</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      class="st_txt_right"
                      type="text"
                      [min]="0"
                      [maxLength]="14"
                      (change)="this.comFunc.enforceMinMax($event.target)"
                      matInput
                      formControlName="fcn_exchange_pure_weight"
                      id="fcn_exchange_pure_weight"
                      readonly
                      MetalDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-8" for="exchange_purity_diff" id="ID104"
                >Purity Difference</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      [min]="0"
                      [maxLength]="14"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_purity_diff"
                      readonly
                      MetalDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-5" for="exchange_stone_rate" id="ID105"
                >Stone Rate</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      [min]="0"
                      [maxLength]="14"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_stone_rate"
                      id="fcn_exchange_stone_rate"
                      (change)="changeExchangeStoneRate($event)"
                      AmountDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-7" for="exchange_stone_amount" id="ID106"
                >Stone Amount</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      [min]="0"
                      [maxLength]="14"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      [min]="0"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_stone_amount"
                      id="fcn_exchange_stone_amount"
                      (change)="changeExStoneAmount($event)"
                      readonly
                      AmountDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-5" for="exchange_metal_rate" id="ID107"
                >Metal Rate</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      [min]="0"
                      [maxLength]="14"
                      (change)="metalRateChange()"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_metal_rate"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-6" for="exchange_making_rate" id="ID108"
                >Making Rate</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      [min]="0"
                      [maxLength]="14"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_making_rate"
                      readonly
                      (change)="changeExMakingRate($event)"
                      AmountDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-8" for="exchange_making_amt" id="ID109"
                >Making Amount</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      [min]="0"
                      [maxLength]="14"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_making_amt"
                      readonly
                      AmountDecimalInput
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-7" for="exchange_metal_amount" id="ID110"
                >Metal Amount</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      AmountDecimalInput
                      [max]="14"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_metal_amount"
                      (change)="changeExchangeMetalAmt($event)"
                      [readonly]="viewOnly"
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-6" for="exchange_net_amount" id="ID111"
                >Net Amount</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      AmountDecimalInput
                      [max]="14"
                      (keyup)="this.comFunc.enforceMinMax($event.target)"
                      class="st_txt_right"
                      matInput
                      formControlName="fcn_exchange_net_amount"
                      readonly
                      (change)="changeExNetAmt($event)"
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <!-- <div class="row" *ngIf="enableJawahara">
              <div class="col-md-6">
                <fieldset>
                  <legend>Scrap</legend>
                  <mat-form-field>
                    <mat-label>Bag No</mat-label>
                    <input type="number" class="st_txt_right" matInput
                      formControlName="fcn_exchange_scrap_bag_no" />
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Bag Description</mat-label>
                    <input type="text" matInput
                      formControlName="fcn_exchange_scrap_bag_desc" />
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Location</mat-label>
                    <input type="text" matInput
                      formControlName="fcn_exchange_location" />
                  </mat-form-field>
                </fieldset>
              </div> -->
            <!-- <div class="col-md-3">
            
            </div> -->
            <!-- <div class="col-md-6">
                <fieldset>
                  <legend>Details</legend>
                  <div class="row mb-1">
                    <label for="inputPassword"
                      class="col-sm-4 col-form-label">Jawahara Y/N</label>
                    <div class="col-md-8">
                      <mat-form-field>
                        <mat-select formControlName="fcn_exchange_jawahara">
                          <mat-option value="0">Jawahara</mat-option>
                          <mat-option value="1">Non Jawahara</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                  <div class="row mb-1">
                    <label for="inputPassword"
                      class="col-sm-4 col-form-label">Resale/ Recycle</label>
                    <div class="col-md-8">
                      <mat-form-field>
                        <mat-select
                          formControlName="fcn_exchange_resale_recycle">
                          <mat-option value="0">Resale</mat-option>
                          <mat-option value="1">Recycle</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                  <div class="row">
                    <label for="inputPassword"
                      class="col-sm-4 col-form-label">Cash/ Exchange</label>
                    <div class="col-md-8">
                      <mat-form-field>
                        <mat-select
                          formControlName="fcn_exchange_cash_exchange">
                          <mat-option value="0">Cash</mat-option>
                          <mat-option value="1">Exchange</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div> -->
          </div>
        </div>
      </form>
      <!--<div class="col-md-12">
                  <div class="form-group row" style="padding:0px 0px 0px 10px;">
                      <div class="font-weight-bold col-form-label  col-12" style="background-color: #efefef;">Wastage
                      </div>
                      <table class="table">
                          <tbody>
                              <tr>
                                  <td> % </td>
                                  <td> Quantity </td>
                                  <td> Amount </td>
                              </tr>
                              <tr>
                                  <td> <input type="email" class="form-control textboxcorner col-xs-6 col-sm-6 col-md-6 col-lg-6" id="vat_per" value="" placeholder="" /></td>
                                  <td> <input type="email" class="form-control textboxcorner col-xs-6 col-sm-6 col-md-6 col-lg-6" id="vat_per" value="" placeholder="" /></td>
                                  <td> <input type="email" class="form-control textboxcorner col-xs-6 col-sm-6 col-md-6 col-lg-6" id="vat_per" value="" placeholder="" /></td>
                              </tr>
                          </tbody>
                      </table>
                  </div>
              </div>-->
    </div>
    <div style="padding-bottom: 20px">
      <div style="text-align: right; padding: 10px">
        <button
          mat-flat-button
          class="update-finish-button btn-width"
          (click)="addItemtoExchange('continueBtn')"
          [disabled]="viewOnly"
          id="ID091"
        >
          Continue
        </button>
        &nbsp;
        <button
          mat-flat-button
          class="update-finish-button btn-width"
          (click)="addItemtoExchange('saveBtn')"
          [disabled]="viewOnly"
          id="ID092"
        >
          Save
        </button>
        &nbsp;
        <button
          mat-flat-button
          class="cancel-button btn-width"
          (click)="closeExchange()"
          id="ID093"
        >
          Cancel
        </button>
        &nbsp;
      </div>
    </div>
  </div>
</ng-template>

<ng-template #adjust_sale_return_modal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Sales Return</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="salesRetClose()"
    >
      <span aria-hidden="true"></span>
    </button>
  </div>
  <div class="modal-body">
    <div class="container row">
      <div class="col-md-12">
        <form [formGroup]="salesReturnForm">
          <div class="form-group row">
            <div class="col-md-3">
              <label class="col-sm-4" for="returns_fin_year" id="ID112"
                >Fin Year</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <mat-select
                      formControlName="fcn_returns_fin_year"
                      [disabled]="viewOnly"
                    >
                      <mat-option
                        *ngFor="let data of yearCollection"
                        [value]="data.YEAR"
                      >
                        {{ data.YEAR }}
                      </mat-option>
                    </mat-select>
                    <mat-error
                      *ngIf="
                        salesReturnForm.controls.fcn_returns_fin_year.hasError(
                          'required'
                        )
                      "
                      id="fcn_returns_fin_year"
                    >
                      Year is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>

                  <!-- <mat-form-field appearance="outline">
                    <input matInput type="text" id="fcn_returns_fin_year" formControlName="fcn_returns_fin_year"
                      [matAutocomplete]="year" />
                    <mat-autocomplete #year="matAutocomplete" autoActiveFirstOption>
                      <mat-option *ngFor="let option of filteredOptions_year | async" [value]="option">
                        {{ option }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="salesReturnForm.controls.fcn_returns_fin_year.hasError('required')" id="ID113">
                      Fin Year is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="salesReturnForm.controls.fcn_returns_fin_year.hasError('notInOptions')"
                      id="ID009">
                      Invalid value
                    </mat-error>
                  </mat-form-field> -->
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-4" for="returns_branch" id="ID071"
                >Branch</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field
                    class="example-full-width"
                    appearance="outline"
                  >
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_returns_branch"
                      [matAutocomplete]="branch"
                      (focusout)="changeBranch($event)"
                      [readonly]="viewOnly"
                    />
                    <mat-autocomplete
                      #branch="matAutocomplete"
                      autoActiveFirstOption
                    >
                      <mat-option
                        *ngFor="
                          let option of filteredSalesReturnBranchOptions | async
                        "
                        [value]="option"
                      >
                        {{ option }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error
                      *ngIf="
                        salesReturnForm.controls.fcn_returns_branch.hasError(
                          'required'
                        )
                      "
                      id="ID072"
                    >
                      Branch is <strong>required</strong>
                    </mat-error>
                    <mat-error
                      *ngIf="
                        salesReturnForm.controls.fcn_returns_branch.hasError(
                          'notInOptions'
                        )
                      "
                      id="ID009"
                    >
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-5" for="returns_branch" id="ID114"
                >Voc Type</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline" style="line-height: 1.4">
                    <input type="text" matInput value="POS" formControlName="fcn_returns_voc_type" readonly />

                    <!-- <mat-select
                      formControlName="fcn_returns_voc_type"
                      [disabled]="viewOnly"
                    >
                      <mat-option
                        *ngFor="let voctype of vocTypesinSalesReturn"
                        [value]="voctype.VOCTYPE"
                      >
                        {{ voctype.VOCTYPE }}
                      </mat-option>
                    </mat-select> -->
                    <mat-error
                      *ngIf="
                        salesReturnForm.controls.fcn_returns_voc_type.hasError(
                          'required'
                        )
                      "
                      id="ID115"
                    >
                      VOC Type is <strong>required</strong>
                    </mat-error>
                    <!--<mat-label>Voc Type </mat-label>
                                        <input type="text" matInput formControlName="fcn_returns_voc_type" [matAutocomplete]="voctypeauto">
                                        <mat-autocomplete #voctypeauto="matAutocomplete" autoActiveFirstOption>
                                            <mat-option [value]="POS">POS</mat-option>
                                            <mat-option [value]="PS1">PS1</mat-option>
                                        </mat-autocomplete>-->
                  </mat-form-field>
                  <!--<mat-form-field>
                                    <mat-label>Voc Type</mat-label>
                                    <input type="text" matInput formControlName="fcn_returns_voc_type" value="{{fcn_returns_voc_type_val}}">
                                </mat-form-field>-->
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-4" for="returns_branch" id="ID116"
                >Voc No</label
              >
              <div class="form-group row">
                <div class="col-sm-11">
                  <mat-form-field appearance="outline">
                    <input
                      type="text"
                      matInput
                      id="fcn_returns_voc_no"
                      formControlName="fcn_returns_voc_no"
                      (change)="getRetailSReturn_EvnFn($event)"
                      [readonly]="
                        viewOnly || this.sales_returns_items.length > 0
                      "
                      NumberOnly
                    />
                    <i
                      class="fa fa-search sReturnVocNumsearch"
                      (click)="searchVocNoSalRet()"
                    ></i>
                    <mat-error
                      *ngIf="
                        salesReturnForm.controls.fcn_returns_voc_no.hasError(
                          'required'
                        )
                      "
                      id="ID117"
                    >
                      VOC No. is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-3">
              <label class="col-sm-5" for="returns_voc_date" id="ID118"
                >Voc Date</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_returns_voc_date"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-4" for="returns_sales_man" id="ID119"
                >Salesman</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_returns_sales_man"
                      value="{{ fcn_returns_sales_man_val }}"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-5" for="returns_cust_code" id="ID120"
                >Cust Code</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_returns_cust_code"
                      value="{{ fcn_returns_cust_code_val }}"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-3">
              <label class="col-sm-6" for="returns_cust_mobile" id="ID121"
                >Cust Mobile</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline">
                    <input
                      type="number"
                      oninput="validity.valid||(value='');"
                      matInput
                      formControlName="fcn_returns_cust_mobile"
                      value="{{ fcn_returns_cust_mobile_val }}"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-3">
              <label class="col-sm-6" for="returns_cust_name" id="ID122"
                >Cust Name</label
              >
              <div class="form-group row">
                <div class="col-sm-12">
                  <mat-form-field appearance="outline">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_returns_cust_name"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>

      <div class="col-md-12">
        <table
          class="container table table-responsive table-striped"
          id="adjustsalesreturn_table"
        >
          <tbody>
            <tr>
              <th style="text-align: center" id="ID123">Division</th>
              <th id="ID124">Stock Code</th>
              <th id="ID125">Item Desc</th>
              <th id="ID126">Gross Weight</th>
              <th id="ID127">Amount</th>
              <th id="ID128">Select</th>
            </tr>

            <tr
              *ngFor="let slsReturn of salesReturnsItems_forVoc; let id = index"
              (dblclick)="changeRetailSalesReturnVal(slsReturn)"
              class="sales-return-row"
            >
              <td style="text-align: center" id="ID129">
                {{ slsReturn.DIVISION_CODE }}
              </td>
              <td id="ID130">{{ slsReturn.STOCK_CODE }}</td>
              <td id="ID131">{{ slsReturn.STOCK_DOCDESC }}</td>
              <td style="text-align: center" id="ID132">
                {{ slsReturn.GROSSWT | decimalFormat : "METAL" }}
              </td>
              <td style="text-align: right" id="ID133">
                {{ slsReturn.TOTALWITHVATLC | decimalFormat : "AMOUNT" }}
              </td>
              <td style="text-align: center">
                <input
                  [disabled]="viewOnly"
                  type="checkbox"
                  value="{{ slsReturn.STOCK_CODE }}"
                  [readonly]="viewOnly"
                  [checked]="
                    checkSelectedVal(
                      slsReturn.STOCK_CODE,
                      slsReturn.TOTALWITHVATLC,
                      slsReturn.SRNO
                    )
                  "
                  (change)="addSalesReturnOnSelect($event, slsReturn, id)"
                />
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="col-md-12 text-right">
        <div>
          <h6 id="ID134">
            Total : {{ sales_returns_total_amt | decimalFormat : "AMOUNT" }}
          </h6>
        </div>
      </div>
      <div class="col-md-12" style="padding-bottom: 20px">
        <div style="text-align: right; padding: 10px">
          <button
            mat-flat-button
            class="btn-m-r-10 update-finish-button btn-width"
            (click)="addItemtoSalesReturn()"
            [disabled]="viewOnly || !salesReturnsItems_forVoc.length"
            id="ID092"
          >
            SAVE
          </button>
          <button
            mat-flat-button
            color="warn"
            (click)="salesRetClose()"
            id="ID093"
            class="cancel-button btn-width"
          >
            CANCEL
          </button>
          &nbsp;
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #more_customer_detail_modal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Customer Details</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="closeAddCustomerModal()"
    >
      <span aria-hidden="true"></span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-md-12">
        <form [formGroup]="customerDetailForm">
          <div class="form-group row">
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="fcn_mob_code"
                  id="ID135"
                >
                  ISD Code <span class="text-danger">&ast;</span>
                </label>
                <div class="col-sm-8">
                  <mat-form-field
                    style="width: -webkit-fill-available"
                    appearance="outline"
                  >
                    <input
                      (focusout)="
                        SPvalidateLookupFieldModified(
                          $event,
                          countryCodeData,
                          ['fcn_mob_code', 'fcn_cust_detail_country'],
                          false,
                          ['MobileCountryCode', 'DESCRIPTION'],
                          true
                        )
                      "
                      [readonly]="viewOnly"
                      matInput="text"
                      formControlName="fcn_mob_code"
                    />
                    <master-search
                      [MasterSearchData]="countryCodeData"
                      class="masterSearch"
                      (newRowClick)="countrySelected($event)"
                    ></master-search>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_mob_code.hasError(
                          'required'
                        )
                      "
                      id="fcn_mob_code"
                    >
                      ISD code is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                               </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_country"
                  id="ID157"
                >
                  Country <span class="text-danger">&ast;</span>
                </label>
                <div class="col-sm-8">
                  <mat-form-field
                    style="width: -webkit-fill-available"
                    appearance="outline"
                  >
                    <input
                      (focusout)="
                        SPvalidateLookupFieldModified(
                          $event,
                          countryCodeData,
                          ['fcn_cust_detail_country', 'fcn_mob_code'],
                          false,
                          ['DESCRIPTION', 'MobileCountryCode'],
                          false
                        )
                      "
                      [readonly]="viewOnly"
                      matInput="text"
                      formControlName="fcn_cust_detail_country"
                    />
                    <master-search
                      [MasterSearchData]="countryCodeData"
                      class="masterSearch"
                      (newRowClick)="countrySelected($event)"
                    ></master-search>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_country.hasError(
                          'required'
                        )
                      "
                      id="fcn_mob_code"
                    >
                      Country is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>

                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="fcn_cust_detail_phone"
                  id="ID137"
                  >Mobile 1 <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      #mobile1 (change)="onCustomerNameFocus(mobile1.value)"
                      onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                      matInput
                      formControlName="fcn_cust_detail_phone"
                      id="fcn_cust_detail_phone"
                      [readonly]="viewOnly"
                      maxlength="20"
                    />
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_phone.hasError(
                          'required'
                        )
                      "
                      id="ID138"
                    >
                      Mobile 1 is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="customer_detail_name"
                  id="ID139"
                  >Name <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_customer_detail_name"
                      id="fcn_customer_detail_name"
                      (change)="nameChange($event)"
                      [readonly]="viewOnly"
                      appAlphabetsOnly
                      appNoEmptySpace
                    />
                    <!-- <input type="text" matInput [pattern]="noWhiteSpacePattern" formControlName="fcn_customer_detail_name" id="fcn_customer_detail_name"
                          (change)="nameChange($event)" [readonly]="viewOnly" /> -->
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_customer_detail_name.hasError(
                          'required'
                        )
                      "
                      id="ID140"
                    >
                      Name is <strong>required</strong>
                    </mat-error>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_customer_detail_name.hasError(
                          'pattern'
                        )
                      "
                      id="ID015"
                    >
                      Whitespace Not Allowed
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="customer_detail_fname"
                  id="ID141"
                  >First Name</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_customer_detail_fname"
                      [readonly]="true"
                      appNoEmptySpace
                    />
                    <!-- <mat-error *ngIf="
                        customerDetailForm.controls.fcn_customer_detail_fname.hasError(
                          'required'
                        )
                      " id="ID142">
                      First Name is <strong>required</strong>
                    </mat-error> -->
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="fcn_cust_detail_Mname"
                  id="ID143"
                  >Middle Name</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_customer_detail_mname"
                      [readonly]="true"
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="customer_detail_lname"
                  id="ID144"
                  >Last Name</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_customer_detail_lname"
                      [readonly]="true"
                    />
                    <!-- <mat-error *ngIf="
                        customerDetailForm.controls.fcn_customer_detail_lname.hasError(
                          'required'
                        )
                      " id="ID145">
                      Last Name is <strong>required</strong>
                    </mat-error> -->
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_customer_detail_lname.hasError(
                          'maxlength'
                        )
                      "
                      id="ID146"
                    >
                      Last Name must not exceed 100 characters.
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_phone2"
                  id="ID147"
                  >Mobile 2</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                      matInput
                      formControlName="fcn_cust_detail_phone2"
                      [readonly]="viewOnly"
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_email"
                  id="ID148"
                  >Email Address<span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="email"
                      matInput
                      formControlName="fcn_cust_detail_email"
                      [readonly]="viewOnly"
                      required
                    />
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_email
                          .touched &&
                        (customerDetailForm.controls.fcn_cust_detail_email.hasError(
                          'email'
                        ) ||
                          customerDetailForm.controls.fcn_cust_detail_email.hasError(
                            'required'
                          ))
                      "
                    >
                      <ng-container
                        *ngIf="
                          customerDetailForm.controls.fcn_cust_detail_email.hasError(
                            'email'
                          )
                        "
                      >
                        Please enter a valid email address
                      </ng-container>
                      <ng-container
                        *ngIf="
                          customerDetailForm.controls.fcn_cust_detail_email.hasError(
                            'required'
                          )
                        "
                      >
                        Email-ID is <strong>required</strong>
                      </ng-container>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_gender"
                  id="ID150"
                  >Gender <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <mat-select
                      formControlName="fcn_cust_detail_gender"
                      [disabled]="viewOnly"
                    >
                      <mat-option
                        *ngFor="let data of genderList"
                        [value]="data.ENGLISH"
                        >{{ data.ENGLISH }}</mat-option
                      >
                    </mat-select>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_gender.hasError(
                          'required'
                        )
                      "
                      id="ID151"
                    >
                      Gender is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_marital_status"
                  id="ID152"
                  >Marital Status</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <mat-select
                      formControlName="fcn_cust_detail_marital_status"
                      [disabled]="viewOnly"
                    >
                      <mat-option
                        *ngFor="let data of maritalStatusList"
                        [value]="data.ENGLISH"
                        >{{ data.ENGLISH }}</mat-option
                      >
                      <!-- <mat-option value="Unknown">Unknown</mat-option> -->
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_dob"
                  id="ID153"
                  >Date Of Birth <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      matInput
                      [matDatepicker]="dob"
                      [max]="vocMaxDate"
                      name="fcn_cust_detail_dob"
                      formControlName="fcn_cust_detail_dob"
                      placeholder="DD/MM/YYYY"
                      [readonly]="viewOnly"
                      DateValidation
                    />
                    <mat-datepicker-toggle
                      matSuffix
                      [for]="dob"
                    ></mat-datepicker-toggle>
                    <mat-datepicker
                      [startAt]="currentDate"
                      #dob
                    ></mat-datepicker>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_dob.hasError(
                          'required'
                        )
                      "
                      id="ID154"
                    >
                      Date of Birth is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_nationality"
                  id="ID155"
                  >Nationality <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field
                    style="width: -webkit-fill-available"
                    appearance="outline"
                  >
                    <input
                      [readonly]="viewOnly"
                      matInput="text"
                      formControlName="fcn_cust_detail_nationality"
                      required
                    />
                    <master-search
                      [MasterSearchData]="nationalityCode"
                      class="masterSearch"
                      (newRowClick)="nationalitySelected($event)"
                    ></master-search>

                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_nationality.hasError(
                          'required'
                        )
                      "
                      id="fcn_mob_code"
                    >
                      Nationality is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>

                  <!-- <mat-form-field appearance="outline" style="width: 100%">
                    <input type="text" matInput formControlName="fcn_cust_detail_nationality"
                      id="fcn_cust_detail_nationality" [matAutocomplete]="nationality" [readonly]="viewOnly" />
                    <mat-autocomplete #nationality="matAutocomplete" autoActiveFirstOption>
                      <mat-option *ngFor="let option of nationalityMasterOptions | async" [value]="option.CODE">
                        {{ option.CODE + " - " + option.DESCRIPTION }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_nationality.hasError(
                          'required'
                        )
                      " id="ID156">
                      Nationality is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_nationality.hasError(
                          'notInOptions'
                        )
                      " id="ID009">
                      Invalid value
                    </mat-error>
                  </mat-form-field> -->
                </div>
              </div>
            </div>
            <!-- 
            <div class="col-md-4">
              <div class="form-group row">
                <label class="col-form-label col-sm-4" for="cust_detail_nationality" id="ID155">Nationality <span
                    class="text-danger">&ast;</span></label>
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input type="text" matInput formControlName="fcn_cust_detail_nationality"
                      id="fcn_cust_detail_nationality" [matAutocomplete]="nationality" [readonly]="viewOnly" />
                    <mat-autocomplete #nationality="matAutocomplete" autoActiveFirstOption>
                      <mat-option *ngFor="let option of nationalityMasterOptions | async" [value]="option.CODE">
                        {{ option.CODE + " - " + option.DESCRIPTION }}
                      </mat-option>
                    </mat-autocomplete>
                    <i class="fas fa-chevron-down"
                      style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%);"></i>
                    <mat-error *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_nationality.hasError(
                          'required'
                        )
                      " id="ID156">
                      Nationality is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_nationality.hasError(
                          'notInOptions'
                        )
                      " id="ID009">
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div> -->

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_state"
                  id="ID159"
                  >State</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_state"
                      id="fcn_cust_detail_state"
                      [matAutocomplete]="state"
                      [readonly]="viewOnly"
                    />
                    <mat-autocomplete
                      #state="matAutocomplete"
                      autoActiveFirstOption
                      (optionSelected)="changeState($event.option.value)"
                    >
                      <mat-option
                        *ngFor="let option of stateMasterOptions | async"
                        [value]="option.CODE"
                      >
                        {{ option.CODE }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_state.hasError(
                          'notInOptions'
                        )
                      "
                      id="ID009"
                    >
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_city"
                  id="ID160"
                  >City</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <!-- <input type="text" matInput formControlName="fcn_cust_detail_city" [readonly]="viewOnly" /> -->
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_city"
                      id="fcn_cust_detail_city"
                      [matAutocomplete]="city"
                      [readonly]="viewOnly"
                    />
                    <mat-autocomplete
                      #city="matAutocomplete"
                      autoActiveFirstOption
                    >
                      <mat-option
                        *ngFor="let option of cityMasterOptions | async"
                        [value]="option.CODE"
                      >
                        {{ option.CODE }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_city.hasError(
                          'notInOptions'
                        )
                      "
                      id="ID009"
                    >
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_idType"
                  id="ID163"
                  >Address <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_address"
                      [readonly]="viewOnly"
                      appNoEmptySpace
                    />
                    <mat-error
                      id="ID032"
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_address.hasError(
                          'required'
                        )
                      "
                    >
                      Address is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <!-- <div class="col-md-4">
              <div class="row">
                <label
                  for="inputPassword"
                  class="col-sm-4 col-form-label"
                  id="ID002"
                  >Address</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_address"
                      [readonly]="viewOnly"
                      appNoEmptySpace
                    />
                    <mat-error
                      id="ID032"
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_address.hasError(
                          'required'
                        )
                      "
                    >
                      Address is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div> -->

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_idType"
                  id="ID163"
                  >ID Type <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_idType"
                      [matAutocomplete]="custIdType"
                      [readonly]="viewOnly"
                    />
                    <mat-autocomplete
                      #custIdType="matAutocomplete"
                      autoActiveFirstOption
                    >
                      <mat-option
                        *ngFor="let option of idTypeFilteredOptions | async"
                        [value]="option"
                      >
                        {{ option }}
                      </mat-option>
                    </mat-autocomplete>
                    <i
                      class="fas fa-chevron-down"
                      style="
                        position: absolute;
                        right: 10px;
                        top: 50%;
                        transform: translateY(-50%);
                      "
                    ></i>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_idType.hasError(
                          'required'
                        )
                      "
                      id="ID164"
                    >
                      ID Type is <strong>required</strong>
                    </mat-error>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_idType.hasError(
                          'notInOptions'
                        )
                      "
                      id="ID009"
                    >
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_idcard"
                  id="ID165"
                  >ID Number <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_idcard"
                      [readonly]="viewOnly"
                      appNoEmptySpace
                    />
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_idcard.hasError(
                          'required'
                        )
                      "
                      id="ID166"
                    >
                      ID Number is <strong>required</strong>
                    </mat-error>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_idcard.hasError(
                          'minlength'
                        )
                      "
                      id="ID167"
                    >
                      <!-- ID Card must be 15 characters long. -->
                      ID Number be at least
                      {{
                        customerDetailForm
                          .get("fcn_cust_detail_idcard")
                          ?.getError("minlength").requiredLength
                      }}
                      characters long.
                    </mat-error>
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_idcard.hasError(
                          'maxlength'
                        )
                      "
                      id="ID168"
                    >
                      ID Number must not exceed
                      {{
                        customerDetailForm
                          .get("fcn_cust_detail_idcard")
                          ?.getError("maxlength").requiredLength
                      }}
                      characters.
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_designation"
                  id="ID169"
                  >Designation <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_designation"
                      [readonly]="viewOnly"
                      appNoEmptySpace
                    />
                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_cust_detail_designation.hasError(
                          'required'
                        )
                      "
                      id="ID170"
                    >
                      Designation is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_company"
                  id="ID171"
                  >Employer</label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      type="text"
                      matInput
                      formControlName="fcn_cust_detail_company"
                      [readonly]="viewOnly"
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group row">
                <label
                  class="col-form-label col-sm-4"
                  for="cust_detail_idcard"
                  id="ID172"
                  >Expiry Date <span class="text-danger">&ast;</span></label
                >
                <div class="col-sm-8">
                  <mat-form-field appearance="outline" style="width: 100%">
                    <input
                      matInput
                      [matDatepicker]="expDateCust"
                      name="fcn_customer_exp_date"
                      formControlName="fcn_customer_exp_date"
                      placeholder="DD/MM/YYYY"
                      [min]="currentDate"
                      [readonly]="viewOnly"
                      DateValidation
                      (dateChange)="datepicker($event)"
                    />
                    <mat-datepicker-toggle
                      matSuffix
                      [for]="expDateCust"
                    ></mat-datepicker-toggle>
                    <mat-datepicker
                      [startAt]="currentDate"
                      #expDateCust
                    ></mat-datepicker>

                    <mat-error
                      *ngIf="
                        customerDetailForm.controls.fcn_customer_exp_date.hasError(
                          'required'
                        )
                      "
                      id="ID173"
                    >
                      Expiry date is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>

      <div class="col-md-12" style="padding-bottom: 20px">
        <div style="text-align: right; padding: 10px">
          <button
            mat-flat-button
            class="bgColourUpdate save_Cancel_btns btn-width"
            (click)="customerSave()"
            *ngIf="!viewOnly"
            [disabled]="isCustProcessing"
            id="ID092"
          >
            SAVE
          </button>
          &nbsp;
          <button
            class="ms-1"
            mat-flat-button
            color="warn"
            (click)="closeAddCustomerModal()"
            id="ID093"
            style="background-color: #b9c3d3 !important"
            class="save_Cancel_btns btn-width"
          >
            CANCEL
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #mymodal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-dia-metal">
      Sales Details
      <!-- {{ lineItemModalForSalesReturn ? "Sales Return " : "Line Item" }} -->
    </h4>
    <button
      style="border: none"
      type="button"
      *ngIf="!updateBtn"
      class="close"
      aria-label="Close"
      (click)="closeItemModal()"
    >
      <span aria-hidden="true">x</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="lineItemForm">
      <!-- <mat-tab-group> -->
      <!-- <mat-tab label="ITEM DETAILS"> -->
      <div class="row">
        <div class="errormsg col-md-12" id="modelerrmsg">
          <!-- {{ pos_div_modelerrmsg }} -->
        </div>

        <div class="col-md-12">
          <div class="bg-gray-card">
            <div class="form-group row">
              <div class="col-md-3">
                <label class="col-sm-4" for="li_division" id="ID123"
                  >Division</label
                >
                <div class="form-group row">
                  <div class="col-sm-11">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        matInput
                        formControlName="fcn_li_division"
                        id="fcn_li_division"
                      />
                      <!-- <master-search [MasterSearchData]="divisionCodeData"
                      (newRowClick)="divisionCodeSelected($event)">>
                      </master-search> -->
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-3">
                <label class="col-sm-5" for="li_item_code" id="ID124"
                  >Stock Code</label
                >
                <div class="form-group row">
                  <div class="col-sm-12">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        matInput
                        autocomplete="off"
                        formControlName="fcn_li_item_code"
                        #fcn_li_item_code
                        id="fcn_li_item_code"
                        autofocus
                        (change)="getStockDesc($event)"
                        [readonly]="viewOnly"
                      />
                      <!-- <master-search [MasterSearchData]="itemcodeData" (newRowClick)="itemcodeSelected($event)"></master-search> -->
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-3">
                <label class="col-sm-8" for="li_item_desc" id="ID096"
                  >Stock Description</label
                >
                <div class="form-group row">
                  <div class="col-sm-12">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        matInput
                        formControlName="fcn_li_item_desc"
                        id="fcn_li_item_desc"
                        [readonly]="viewOnly || !allowDescription"
                      />
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div
                class="col-md-3"
                *ngIf="this.lineItemForm.value.fcn_li_location"
              >
                <label class="col-sm-4" for="li_location" id="ID174"
                  >Location</label
                >
                <div class="form-group row">
                  <div class="col-sm-12">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        matInput
                        formControlName="fcn_li_location"
                        id="fcn_li_location"
                        readonly
                      />
                      <!-- BUG_01711 - Should be able to enter location.-->
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- <div class="col-md-2" *ngIf="isGiftTypeRequired">
                <mat-form-field>
                  <mat-label>Gift Type</mat-label>
                  <mat-select formControlName="fcn_li_gift_type">
                    <mat-option *ngFor="let option of giftTypeOptions" [value]="option.value">{{ option.label
                      }}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div> -->
            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="row">
            <div class="col-md-7">
              <div class="form-group row">
                <div class="col-md-2">
                  <label class="col-sm-5" for="li_pcs" id="ID175">Pcs</label>
                  <div class="col-sm-12" style="width: 135%">
                    <mat-form-field
                      appearance="outline"
                      style="width: 100%"
                      aria-readonly="true"
                    >
                      <input
                        class="st_txt_right"
                        type="text"
                        [min]="0"
                        autocomplete="off"
                        [maxLength]="6"
                        (keyup)="this.comFunc.enforceMinMax($event.target)"
                        matInput
                        id="fcn_li_pcs"
                        formControlName="fcn_li_pcs"
                        (blur)="focusField('fcn_li_net_amount')"
                        (focus)="setValToLocalStorage($event, 'fcn_li_pcs')"
                        (change)="changePCS($event)"
                        [readonly]="viewOnly || !isPcsEditable"
                        NumberOnly
                      />
                      <!-- <input class="st_txt_right" type="number" min="1" matInput formControlName="fcn_li_pcs"
                                (keyup)="changePCS($event)" (mouseup)="changePCS($event)" (mouseleave)="changePCS($event)"
                                value="{{li_pcs_val}}"> -->
                      <mat-error
                        *ngIf="
                          lineItemForm.controls.fcn_li_pcs.hasError('required')
                        "
                        id="ID176"
                      >
                        PCS is <strong>required</strong>
                      </mat-error>
                      <mat-error
                        *ngIf="lineItemForm.controls.fcn_li_pcs.hasError('min')"
                      >
                        {{ "PCS should Not Be Zero" }}
                        <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>

                <div class="col-md-3 mx-4">
                  <label class="col-sm-9" for="li_gross_wt" id="ID177">{{
                    newDictionary?.lblGrossWeight || "Gross Wt"
                  }}</label>
                  <div class="form-group row">
                    <div class="col-sm-12">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          [maxLength]="6"
                          type="text"
                          [min]="0"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_li_gross_wt"
                          id="fcn_li_gross_wt"
                          (focus)="setValToLocalStorage($event, 'fcn_li_gwt')"
                          (change)="changeGrossWt($event)"
                          [readonly]="viewOnly || !isGrossWtEditable"
                          MetalDecimalInput
                        />
                        <mat-error
                          *ngIf="
                            lineItemForm.controls.fcn_li_gross_wt.hasError(
                              'required'
                            )
                          "
                          id="ID178"
                        >
                          Gross Weight is <strong>required</strong>
                        </mat-error>
                        <mat-error
                          *ngIf="
                            lineItemForm.controls.fcn_li_gross_wt.hasError(
                              'min'
                            )
                          "
                          id="ID179"
                        >
                          {{ this.comFunc.getMsgByID("MSG1306") }}
                        </mat-error>
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <div
                  class="col-md-3"
                  *ngIf="this.divisionMS == 'S' ? false : true"
                >
                  <label class="col-sm-9" for="li_stone_wt" id="ID180">{{
                    newDictionary?.lblStoneWeight || "Stone Wt"
                  }}</label>
                  <div class="form-group row">
                    <div class="col-sm-12">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_li_stone_wt"
                          id="fcn_li_stone_wt"
                          (change)="changeStoneWt($event)"
                          [readonly]="viewOnly || !isStoneIncluded"
                          MetalDecimalInput
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <div
                  class="col-md-2"
                  *ngIf="this.divisionMS == 'S' ? false : true"
                >
                  <label class="col-sm-9" for="net_wt" id="ID181"
                    >Net&nbsp;Wt</label
                  >
                  <div class="col-sm-12" style="width: 160%">
                    <mat-form-field appearance="outline" style="width: 100%">
                      <input
                        type="text"
                        class="st_txt_right"
                        [min]="0"
                        [maxLength]="14"
                        (keyup)="this.comFunc.enforceMinMax($event.target)"
                        max="{{
                          this.comFunc.emptyToZero(
                            this.lineItemForm.value.fcn_li_gross_wt
                          )
                        }}"
                        matInput
                        formControlName="fcn_li_net_wt"
                        id="fcn_li_net_wt"
                        (focusout)="changeNettWt($event)"
                        readonly
                        MetalDecimalInput
                      />
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="form-group row" *ngIf="this.divisionMS == 'M'">
                <div class="col-md-6">
                  <label class="col-sm-5" for="li_purity" id="ID182"
                    >Purity</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-11">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          type="number"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          class="st_txt_right"
                          matInput
                          formControlName="fcn_li_purity"
                          id="fcn_li_purity"
                          readonly
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <label class="col-sm-6" for="pure_wt" id="ID183"
                    >Pure Weight</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-12">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_li_pure_wt"
                          id="fcn_li_pure_wt"
                          readonly
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="form-group row"
                *ngIf="this.divisionMS == 'S' ? false : true"
              >
                <div class="col-md-6">
                  <label class="col-sm-5" for="metal_rate" id="ID184"
                    >Metal Rate</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-11">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_ad_metal_rate"
                          id="fcn_ad_metal_rate"
                          readonly
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <label class="col-sm-7" for="metal_amount" id="ID185"
                    >Metal Amount</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-12">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_ad_metal_amount"
                          id="fcn_ad_metal_amount"
                          AmountDecimalInput
                          readonly
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="form-group row"
                *ngIf="this.divisionMS == 'S' ? false : true"
              >
                <div class="col-md-6">
                  <label class="col-sm-5" for="stone_rate" id="ID186"
                    >Stone Rate</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-11">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_ad_stone_rate"
                          id="fcn_ad_stone_rate"
                          (change)="changeStoneRate($event)"
                          value="{{ li_stone_rate_val }}"
                          [readonly]="viewOnly"
                          AmountDecimalInput
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <label class="col-sm-7" for="stone_amount" id="ID187"
                    >Stone Amount</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-12">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          id="fcn_ad_stone_amount"
                          matInput
                          formControlName="fcn_ad_stone_amount"
                          value="{{ li_stone_amount_val }}"
                          (change)="changeStoneAmt($event)"
                          [readonly]="viewOnly"
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <!-- <div class="col-md-4">
                  <mat-form-field>
                    <mat-label>Rate Type</mat-label>
                    <input type="text" matInput formControlName="fcn_ad_rate_type" id="fcn_ad_rate_type"
                      [readonly]="viewOnly" />
                  </mat-form-field>
                </div> -->
              </div>

              <div class="form-group row">
                <div class="col-md-6">
                  <label class="col-sm-5" for="rate" id="ID188">
                    {{ divisionMS == "M" ? "Making Rate" : "Rate" }}
                  </label>
                  <div class="form-group row">
                    <div class="col-sm-11">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          id="fcn_li_rate"
                          formControlName="fcn_li_rate"
                          (change)="changeRate($event)"
                          readonly="{{ viewOnly }}"
                          (focus)="setValToLocalStorage($event, 'fcn_li_rate')"
                          AmountDecimalInput
                        />
                        <!-- readonly="{{
                                viewOnly || divisionMS == 'S' ? true : false
                              }}" -->
                        <mat-error
                          *ngIf="
                            lineItemForm.controls.fcn_li_rate.hasError(
                              'required'
                            )
                          "
                          id="ID189"
                        >
                          {{ divisionMS == "M" ? "Making Rate" : "Rate" }}
                          is <strong>required</strong>
                        </mat-error>
                        <mat-error
                          *ngIf="
                            lineItemForm.controls.fcn_li_rate.hasError('min')
                          "
                          id="ID190"
                        >
                          <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                          {{ divisionMS == "M" ? "Making Rate" : "Rate" }}
                          should Not Be Zero
                        </mat-error>
                        <!-- formControlName="fcn_li_rate" value="{{li_rate_val}}" (keyup)="changeRate()" (mouseup)="changeRate()" > -->
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <label class="col-sm-6" for="amount" id="ID191">
                    {{ divisionMS == "M" ? "Making Amount" : "Amount" }}
                  </label>
                  <div class="form-group row">
                    <div class="col-sm-12">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          type="text"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          id="fcn_li_total_amount"
                          matInput
                          formControlName="fcn_li_total_amount"
                          (focus)="
                            setValToLocalStorage($event, 'fcn_li_total_amount')
                          "
                          (change)="changeTotalAmt($event)"
                          id="fcn_li_total_amount"
                          readonly="{{ viewOnly }}"
                          AmountDecimalInput
                        />
                        <!-- readonly="{{
                                viewOnly || divisionMS == 'S' ? true : false
                              }}" -->
                        <mat-error
                          *ngIf="
                            lineItemForm.controls.fcn_li_total_amount.hasError(
                              'required'
                            )
                          "
                          id="ID189"
                        >
                          {{ divisionMS == "M" ? "Making Amount" : "Amount" }}
                          <!-- : "Total Amount" -->
                          is
                          <strong>required</strong>
                        </mat-error>
                        <mat-error
                          *ngIf="
                            lineItemForm.controls.fcn_li_total_amount.hasError(
                              'min'
                            )
                          "
                          id="ID190"
                        >
                          <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                          {{
                            divisionMS == "M" ? "Making Amount" : "Total Amount"
                          }}
                          should Not Be Zero
                        </mat-error>
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="form-group row"
                *ngIf="this.divisionMS == 'M' ? false : true"
              >
                <div class="col-md-6">
                  <label class="col-sm-5" for="discount_percentage" id="ID192"
                    >Discount %</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-11">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          [min]="0"
                          [max]="100"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_li_discount_percentage"
                          (change)="changeDisPer($event)"
                          id="fcn_li_discount_percentage"
                          (focus)="
                            setValToLocalStorage(
                              $event,
                              'fcn_li_discount_percentage'
                            )
                          "
                          [readonly]="viewOnly"
                          AmountDecimalInput
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <label class="col-sm-8" for="discount_amount" id="ID193"
                    >Discount Amount</label
                  >
                  <div class="form-group row">
                    <div class="col-sm-12">
                      <mat-form-field appearance="outline" style="width: 100%">
                        <input
                          class="st_txt_right"
                          [min]="0"
                          [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)"
                          matInput
                          formControlName="fcn_li_discount_amount"
                          id="fcn_li_discount_amount"
                          (change)="changeDisAmount($event)"
                          [readonly]="viewOnly"
                          (focus)="
                            setValToLocalStorage(
                              $event,
                              'fcn_li_discount_amount'
                            )
                          "
                          AmountDecimalInput
                        />
                      </mat-form-field>
                    </div>
                  </div>
                </div>
              </div>
              <!--- Division, Item Code, Item Desc, Location, PCs, (Gross Wt, Stone Wt, Net Wt), Making Rate - Making Amount,
              Stone Rate - Stone Amount, Metal Rate - Metal Amount, Rate - Total Amount, Disc Rate - Disc Amount,Gross Amount, Tax % - Tax Amount, Net Amount ) -->
            </div>

            <div class="col-md-5">
              <div class="form-group row">
                <div class="col-md-6">
                  <div class="form-group row">
                    <div class="slider" style="margin-top: 40px">
                      <image-slider [imageArray]="imageURL"></image-slider>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group row">
                    <label class="font-weight-bold col-form-label" id="ID194"
                      >Tag Details</label
                    >
                    <textarea
                      class="form-control"
                      style="
                        height: 175px;
                        border: 2px solid #bebebe !important;
                      "
                      formControlName="fcn_tab_details"
                      readonly
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>

            <!-- <div class="col-md-5">
            <div class="form-group">
              <div class="slider">
                <image-slider [imageArray]="imageURL"></image-slider>
              </div>
            </div>
            <div class="form-group d-flex align-items-center justify-content-center">
              <div class="col-md-6 text-center">
                <label class="font-weight-bold col-form-label" id="ID194">Tag Details</label>
                <textarea class="form-control" style="
                      height: 140px;
                      border: 2px solid #bebebe !important;
                    " formControlName="fcn_tab_details" readonly></textarea>
              </div>
            </div>

          </div> -->

            <div class="col-md-12">
              <div class="bg-gray-card">
                <div class="form-group row">
                  <div class="col-md-3">
                    <label class="col-sm-6" for="fcn_li_gross_amount" id="ID195"
                      >Total Amount</label
                    >
                    <div class="form-group row">
                      <div class="col-sm-12">
                        <mat-form-field
                          appearance="outline"
                          style="width: 100%"
                        >
                          <input
                            class="st_txt_right"
                            [min]="0"
                            [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)"
                            matInput
                            formControlName="fcn_li_gross_amount"
                            id="fcn_li_gross_amount"
                            [readonly]="true"
                            (change)="changeGrossAmt($event)"
                            (focus)="
                              setValToLocalStorage(
                                $event,
                                'fcn_li_gross_amount'
                              )
                            "
                            AmountDecimalInput
                          />
                          <mat-error
                            *ngIf="
                              lineItemForm.controls.fcn_li_gross_amount.hasError(
                                'required'
                              )
                            "
                            id="ID196"
                          >
                            Total Amount
                            <!-- {{
                                divisionMS == "M" ? "Total Amount" : "Net Amount"
                              }} -->
                            is <strong>required</strong>
                          </mat-error>
                          <mat-error
                            *ngIf="
                              lineItemForm.controls.fcn_li_gross_amount.hasError(
                                'min'
                              )
                            "
                            id="ID197"
                          >
                            <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                            Total Amount
                            <!-- {{
                                divisionMS == "M" ? "Total Amount" : "Net Amount"
                              }} -->
                            should Not Be Zero
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3" *ngIf="taxType == 1">
                    <label class="col-sm-4" for="tax_percentage" id="ID198"
                      >Tax %</label
                    >
                    <div class="form-group row">
                      <div class="col-sm-12">
                        <mat-form-field
                          appearance="outline"
                          style="width: 100%"
                        >
                          <input
                            class="st_txt_right"
                            type="number"
                            [min]="0"
                            [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)"
                            matInput
                            formControlName="fcn_li_tax_percentage"
                            id="fcn_li_tax_percentage"
                            readonly
                          />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3" *ngIf="taxType == 2">
                    <label class="col-sm-5" for="cgst_percentage" id="ID199"
                      >CGST %</label
                    >
                    <div class="form-group row">
                      <div class="col-sm-12">
                        <mat-form-field
                          appearance="outline"
                          style="width: 100%"
                        >
                          <input
                            class="st_txt_right"
                            type="number"
                            [min]="0"
                            [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)"
                            matInput
                            formControlName="fcn_li_cgst_percentage"
                            id="fcn_li_cgst_percentage"
                            readonly
                          />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3" *ngIf="taxType == 1">
                    <label class="col-sm-6" for="cgst_percentage" id="ID200"
                      >Tax Amount</label
                    >
                    <div class="form-group row">
                      <div class="col-sm-12">
                        <mat-form-field
                          appearance="outline"
                          style="width: 100%"
                        >
                          <input
                            class="st_txt_right"
                            [min]="0"
                            [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)"
                            matInput
                            formControlName="fcn_li_tax_amount"
                            id="fcn_li_tax_amount"
                            AmountDecimalInput
                            readonly
                          />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3" *ngIf="taxType == 2">
                    <label class="col-sm-7" for="cgst_percentage" id="ID201"
                      >CGST Amount</label
                    >
                    <div class="form-group row">
                      <div class="col-sm-12">
                        <mat-form-field
                          appearance="outline"
                          style="width: 100%"
                        >
                          <input
                            class="st_txt_right"
                            type="number"
                            [min]="0"
                            [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)"
                            matInput
                            formControlName="fcn_li_cgst_amount"
                            id="fcn_li_cgst_amount"
                            readonly
                          />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3">
                    <label class="col-sm-6" for="cgst_percentage" id="ID202"
                      >Net Amount</label
                    >
                    <div class="form-group row">
                      <div class="col-sm-12">
                        <mat-form-field
                          appearance="outline"
                          style="width: 100%"
                        >
                          <input
                            class="st_txt_right"
                            (focus)="
                              setValToLocalStorage($event, 'fcn_li_net_amount')
                            "
                            [min]="0"
                            [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)"
                            matInput
                            formControlName="fcn_li_net_amount"
                            id="fcn_li_net_amount"
                            (change)="changeNettAmt($event)"
                            [readonly]="viewOnly || isRevCalculationBlock"
                            AmountDecimalInput
                          />
                          <mat-error
                            *ngIf="
                              lineItemForm.controls.fcn_li_net_amount.hasError(
                                'required'
                              )
                            "
                            id="ID203"
                          >
                            Net Amount
                            <!-- {{ divisionMS == "M" ? "Net Amount" : "Total+Tax" }} -->
                            is <strong>required</strong>
                          </mat-error>
                          <mat-error
                            *ngIf="
                              lineItemForm.controls.fcn_li_net_amount.hasError(
                                'min'
                              )
                            "
                            id="ID204"
                          >
                            <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                            Net Amount
                            <!-- {{ divisionMS == "M" ? "Net Amount" : "Total+Tax" }} -->
                            should Not Be Zero
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- </form> -->
      </div>
      <!-- </mat-tab> -->
      <!-- <mat-tab label="ADDITIONAL DETAILS"  hidden="{{this.divisionMS == 'S'? true: false}}" > -->
      <!-- <mat-tab hidden
        label="ADDITIONAL DETAILS"
        *ngIf="this.divisionMS == 'S' ? false : true"
      >
        <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
          <div class="form-group row">
            <div class="col-md-4">
              <mat-form-field>
                <mat-label>Stone Rate</mat-label>
                <input
                  class="st_txt_right"
                  type="number"
                  [min]="0"
                  [maxLength]="14"
                  (keyup)="this.comFunc.enforceMinMax($event.target)"
                  matInput
                  formControlName="fcn_ad_stone_rate"
                  id="fcn_ad_stone_rate"
                  (change)="changeStoneRate($event)"
                  value="{{ li_stone_rate_val }}"
                  [readonly]="viewOnly"
                  AmountDecimalInput
                />
              </mat-form-field>
            </div>
            <div class="col-md-4">
              <mat-form-field>
                <mat-label>Stone Amount</mat-label>
                <input
                  class="st_txt_right"
                  type="number"
                  [min]="0"
                  [maxLength]="14"
                  (keyup)="this.comFunc.enforceMinMax($event.target)"
                  id="fcn_ad_stone_amount"
                  matInput
                  formControlName="fcn_ad_stone_amount"
                  value="{{ li_stone_amount_val }}"
                  (change)="changeStoneAmt($event)"
                  [readonly]="viewOnly"
                  AmountDecimalInput
                />
              </mat-form-field>
            </div>

            <div class="col-md-4" hidden>
              <mat-form-field>
                <mat-label>Making Rate</mat-label>
                <input
                  class="st_txt_right"
                  type="number"
                  [min]="0"
                  [maxLength]="14"
                  (keyup)="this.comFunc.enforceMinMax($event.target)"
                  matInput
                  formControlName="fcn_ad_making_rate"
                  id="fcn_ad_making_rate"
                  readonly
                />
              </mat-form-field>
            </div>
            <div class="col-md-4" hidden>
              <mat-form-field>
                <mat-label>Making Amount</mat-label>
                <input
                  class="st_txt_right"
                  type="number"
                  [min]="0"
                  [maxLength]="14"
                  (keyup)="this.comFunc.enforceMinMax($event.target)"
                  matInput
                  formControlName="fcn_ad_making_amount"
                  id="fcn_ad_making_amount"
                  readonly
                />
              </mat-form-field>
            </div>

            <div
              class="col-md-4"
              *ngIf="this.divisionMS == 'M' ? false : true"
              hidden
            >
              <mat-form-field>
                <mat-label>PCs</mat-label>
                <input
                  type="text"
                  matInput
                  formControlName="fcn_ad_pcs"
                  id="fcn_ad_pcs"
                />
              </mat-form-field>
            </div>
            <div
              class="col-md-4"
              *ngIf="this.divisionMS == 'M' ? false : true"
              hidden
            >
              <mat-form-field>
                <mat-label>Cts</mat-label>
                <input
                  type="number"
                  matInput
                  formControlName="fcn_ad_cts"
                  id="fcn_ad_cts"
                />
              </mat-form-field>
            </div>
            <div class="col-md-4" hidden>
              <mat-form-field>
                <mat-label>GMS</mat-label>
                <input
                  type="text"
                  matInput
                  formControlName="fcn_ad_gms"
                  id="fcn_ad_gms"
                  [readonly]="viewOnly"
                />
              </mat-form-field>
            </div>

            <div class="col-md-4" hidden>
              <mat-form-field>
                <mat-label>Rate</mat-label>
                <input
                  type="number"
                  [min]="0"
                  [maxLength]="14"
                  (keyup)="this.comFunc.enforceMinMax($event.target)"
                  matInput
                  formControlName="fcn_ad_rate"
                  id="fcn_ad_rate"
                  [readonly]="viewOnly"
                />
              </mat-form-field>
            </div>
            <div class="col-md-4" hidden>
              <mat-form-field>
                <mat-label>Amount</mat-label>
                <input
                  type="number"
                  [min]="0"
                  [maxLength]="14"
                  (keyup)="this.comFunc.enforceMinMax($event.target)"
                  matInput
                  formControlName="fcn_ad_amount"
                  id="fcn_ad_amount"
                  [readonly]="viewOnly"
                />
              </mat-form-field>
            </div>
          </div>
        </div>
      </mat-tab>
  
   -->
      <!-- </mat-tab-group> -->
    </form>

    <div style="padding-bottom: 0px">
      <div style="text-align: right; padding: 10px" *ngIf="!viewOnly">
        <button
          mat-flat-button
          class="next-item-button btn-width"
          *ngIf="!lineItemModalForSalesReturn"
          (click)="addItemtoList('newitem_btn')"
          [disabled]="disableSaveBtn"
        >
          Continue
        </button>
        <button
          mat-flat-button
          class="update-finish-button btn-width mx-1"
          *ngIf="!lineItemModalForSalesReturn"
          (click)="addItemtoList('finish_btn')"
          [disabled]="disableSaveBtn"
        >
          {{ updateBtn ? "Update" : "Save" }}
        </button>

        <button
          mat-flat-button
          class="update-finish-button btn-width mx-1"
          *ngIf="lineItemModalForSalesReturn"
          (click)="updateRetailSalesReturnVal()"
          [disabled]="disableSaveBtn"
        >
          {{ updateBtn ? "Update" : "Save" }}
        </button>
        <!-- <button class="btn btn btn-primary" *ngIf="updateBtn" (click)="addItemtoList('finish_btn')">
            Update
          </button>&nbsp; -->
        <button
          mat-flat-button
          class="cancel-button btn-width"
          (click)="closeItemModal()"
        >
          Cancel
        </button>
        <!-- <button class="btn btn btn-dark" (click)="addItemtoList('newitem_btn')">
            Next Item</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="!updateBtn" (click)="addItemtoList('finish_btn')">
            Finish</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="updateBtn" (click)="addItemtoList('finish_btn')">
            Update
          </button>&nbsp;
          <button class="btn btn btn-danger" *ngIf="!updateBtn" (click)="modal.dismiss('Cross click')">
            Cancel</button>&nbsp; -->
      </div>
      <div style="text-align: right; padding: 10px" *ngIf="viewOnly">
        <button
          mat-flat-btn
          class="btn btn btn-danger save_Cancel_btns btn-width"
          (click)="modal.dismiss('Cross click')"
          id="ID205"
        >
          Close
        </button>
      </div>
      <!-- <div style="text-align: right; padding: 10px">
          <button class="btn btn btn-dark" (click)="addItemtoList('newitem_btn')">
            Next Item</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="!updateBtn" (click)="addItemtoList('finish_btn')">
            Finish</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="updateBtn" (click)="addItemtoList('finish_btn')">
            Update
          </button>&nbsp;
          <button class="btn btn btn-danger" *ngIf="!updateBtn" (click)="modal.dismiss('Cross click')">
            Cancel</button>&nbsp;
        </div> -->
    </div>
  </div>
</ng-template>

<ng-template #userAuthModal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Authentication</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true"></span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="authForm">
      <div class="row">
        <div class="col-md-6">
          <mat-form-field>
            <mat-label>Username</mat-label>
            <input
              type="text"
              matInput
              formControlName="username"
              [readonly]="viewOnly"
              appNoEmptySpace
            />
            <mat-error *ngIf="authForm.controls.username.hasError('required')">
              Username is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-form-field>
            <mat-label>Password</mat-label>
            <input
              type="password"
              matInput
              formControlName="password"
              [readonly]="viewOnly"
              appNoEmptySpace
            />
            <mat-error *ngIf="authForm.controls.password.hasError('required')">
              Password is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>
      </div>
      <div class="text-right">
        <button
          type="submit"
          mat-flat-button
          color="primary"
          class="btn-m-r-10"
          [disabled]="viewOnly"
          (click)="submitAuth()"
        >
          Submit
        </button>
      </div>
    </form>
  </div>
</ng-template>

<audit-trail></audit-trail>

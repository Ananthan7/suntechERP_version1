<div id="print_invoice_est" style="display: none">
  <div class="bill_header">
    <h3 id="ID001">ESTIMATION</h3>
    <table style="width: 100%">
      <tr class="top_header">
        <td style="border-bottom-style: hidden; width: 55%">
          <label style="float: left; text-align: start" id="ID002">Customer Name </label>
          <label style="float: right; text-align: end" id="ID003">
            {{ this.customerDataForm.value.fcn_customer_name || "" }}
          </label>
        </td>
        <td style="border-bottom-style: hidden; width: 45%">
          <label style="float: left; text-align: start; width: 60px" id="ID004">INVOICE NO
          </label>

          <label style="float: right; text-align: end" id="ID005">
            {{ this.vocDataForm.value.fcn_voc_no || "" }}
          </label>
        </td>
      </tr>

      <tr class="top_header" style="border-bottom: hidden">
        <td>
          <label style="float: left; text-align: start" id="ID006">ID No/Passport </label>
          <label style="float: right; text-align: end" id="ID007">
            {{ this.customerDataForm.value.fcn_customer_id_number || "" }}
          </label>
        </td>
        <td>
          <label style="float: left; text-align: start; width: 60px" id="ID008">Bill Date
          </label>
          <label style="float: right; text-align: end" id="ID009">
            {{ this.convertDate(this.vocDataForm.value.vocdate) || "" }}
          </label>
        </td>
      </tr>
      <tr class="top_header">
        <td>
          <label style="float: left; text-align: start" id="ID010">Mobile Number</label>
          <label style="float: right; text-align: end" id="ID011">
            {{ this.customerDataForm.value.fcn_customer_mobile || "" }}
          </label>
        </td>
        <td>
          <label style="float: left; text-align: start" id="ID012">Salesman</label>
          <label style="float: right; text-align: end; width: 60px" id="ID013">
            {{ this.vocDataForm.value.sales_person || "" }}
          </label>
        </td>
      </tr>
    </table>
    <table *ngFor="let data of ordered_items">
      <thead>
        <tr>
          <th class="text" style="width: 20%" id="ID014">Description</th>
          <th class="text" style="width: 10%" id="ID015">Pcs</th>
          <th class="text" class="numbers" id="ID016">{{ data.pcs }}</th>
          <th class="text" style="width: 18%" id="ID017">Total MKG</th>
          <th class="numbers" id="ID018">
            {{ data.making_amt | decimalFormat : this.comFunc.amtDecimals }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text" rowspan="3" id="ID019">{{ data.stock_code }}</td>
          <!-- <td class="text" rowspan="3">{{ data.description }}</td> -->
          <td id="ID020">MKG</td>
          <td class="numbers" id="ID021">{{ data.rate }}</td>
          <td class="text" id="ID022">Net amount (exc.VAT)</td>
          <td class="numbers" id="ID023">
            {{ data.gross_amt | decimalFormat : this.comFunc.amtDecimals }}
          </td>
        </tr>
        <tr>
          <td class="text" id="ID024">QTY/ Gms</td>
          <td class="numbers" id="ID025">
            {{ data.weight | decimalFormat : this.comFunc.mQtyDecimals }}
          </td>
          <td class="text" id="ID026">Tax amount</td>
          <td class="numbers" id="ID027">
            {{ data.tax_amount | decimalFormat : this.comFunc.amtDecimals }}
          </td>
          <!-- <td class="numbers">{{ this.comFunc.transformDecimalVB(
              this.comFunc.amtDecimals, data.tax_amount) }}</td> -->
        </tr>
        <tr>
          <td class="text" id="ID028">Total</td>
          <td colspan="3" class="numbers" id="ID029">
            {{ data.net_amount | decimalFormat : this.comFunc.amtDecimals }}
          </td>
        </tr>
      </tbody>
    </table>

    <table>
      <tbody>
        <tr>
          <td class="text" style="width: 20%" id="ID030">Total Before VAT</td>
          <td class="numbers" id="ID031">
            {{
            prnt_inv_total_gross_amt
            | decimalFormat : this.comFunc.amtDecimals
            }}
          </td>
        </tr>
        <tr>
          <td class="text" style="width: 20%" id="ID032">VAT 5%</td>
          <td class="numbers" id="ID033">
            {{
            prnt_inv_total_tax_amount
            | decimalFormat : this.comFunc.amtDecimals
            }}
          </td>
        </tr>
        <tr>
          <td class="text" id="ID034" style="width: 20%">Total With VAT</td>
          <td class="numbers" id="ID035">
            {{
            order_items_total_gross_amount
            | decimalFormat : this.comFunc.amtDecimals
            }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>



<div style="display: none" id="print_invoice">
  <table style="border: hidden; width: 100%">
    <tr>
      <td style="border: hidden; vertical-align: top">
        <div style="font-weight: bold; text-align: center; font-size: 24px">
          <h4 style="margin: 5px 0px" id="ID036">Estimation</h4>
        </div>
      </td>
    </tr>
  </table>

  <table style="width: 100%">
    <tr>
      <td style="border-bottom-style: hidden">
        <label style="font-weight: bold" id="ID037">Customer Name </label>
        <label style="float: right" id="ID038">{{
          this.customerDataForm.value.fcn_customer_name
          }}</label>
        <!-- <label style="float: right">{{ inv_customer_name }}</label> -->
      </td>
      <td style="border-bottom-style: hidden">
        <label style="font-weight: bold" id="ID039">INVOICE NO </label>
        <label style="font-weight: bold; float: right" id="ID040">
          {{ this.vocDataForm.value.fcn_voc_no }}
          <!-- {{ inv_number }} -->
        </label>
      </td>
    </tr>
    <tr style="border-bottom: hidden">
      <td>
        <label style="font-weight: bold" id="ID041">ID No/Passport </label>
        <label style="float: right" id="ID042">{{
          this.customerDataForm.value.fcn_customer_id_number
          }}</label>
      </td>
      <td>
        <label style="font-weight: bold" id="ID043">Bill Date </label>
        <label style="float: right" id="ID044">
          <!-- {{ inv_bill_date }} -->
          {{ this.convertDate(this.vocDataForm.value.vocdate) }}
        </label>
      </td>
    </tr>
    <tr>
      <td>
        <label style="font-weight: bold" id="ID045">Mobile Number</label>
        <label style="float: right" id="ID046">
          <!-- {{ inv_cust_mobile_no }} -->
          {{ this.customerDataForm.value.fcn_customer_mobile }}
        </label>
      </td>
      <td>
        <label style="font-weight: bold" id="ID047">Salesman</label>
        <label style="float: right" id="ID048">
          <!-- {{ inv_sales_man }} -->
          {{ this.vocDataForm.value.sales_person }}
        </label>
      </td>
    </tr>
  </table>

  <!-- <table style="width: 100%">
      <tr style="border-bottom: hidden">
        <td>
          <label style="font-weight: bold">Customer Name </label>
          <label style="float: right">{{ inv_customer_name }}</label>
        </td>
        <td>
          <label style="font-weight: bold">INVOICE NO </label>
          <label style="font-weight: bold; float: right"> {{ inv_number }}</label>
        </td>
      </tr>
      <tr style="border-bottom: hidden">
        <td>
          <label style="font-weight: bold">ID No/Passport </label>
          <label style="float: right">{{ inv_cust_id_no }}</label>
        </td>
        <td>
          <label style="font-weight: bold">Bill Date </label>
          <label style="float: right">{{ inv_bill_date }}</label>
        </td>
      </tr>
      <tr>
        <td>
          <label style="font-weight: bold">Mobile Mumber</label>
          <label style="float: right">{{ inv_cust_mobile_no }}</label>
        </td>
        <td>
          <label style="font-weight: bold">Salesman</label>
          <label style="float: right">{{ inv_sales_man }}</label>
        </td>
      </tr>
    </table> -->

  <br />
  <div class="row">
    <table class="table" style="margin-left: 0px; width: 100%">
      <thead style="background: #eaecea; -webkit-print-color-adjust: exact">
        <tr style="text-align-last: center">
          <th style="vertical-align: middle; text-align: center" id="ID049">No</th>
          <th style="vertical-align: middle; text-align: center" id="ID050">
            Description
          </th>
          <th style="vertical-align: middle; text-align: center" id="ID015">Pcs</th>
          <th style="vertical-align: middle; text-align: center" id="ID051">Qty/Gms</th>
          <th style="vertical-align: middle; text-align: center" id="ID052">
            Rate (Mkg/Pcs)
          </th>
          <th style="vertical-align: middle; text-align: center" id="ID053">
            Net Amount (Excl.VAT)
          </th>
          <th style="vertical-align: middle; text-align: center" id="ID054">Discount</th>
          <th style="vertical-align: middle; text-align: center" id="ID055">VAT %</th>
          <th style="vertical-align: middle; text-align: center" id="ID056">Tax Amount</th>
          <th style="vertical-align: middle; text-align: center" id="ID057">
            Net Amount (Incl.VAT)
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cli of ordered_items; let id = index">
          <td style="border-bottom-style: hidden; text-align: center" id="ID058">
            {{ cli.sn_no }}
          </td>
          <td style="border-bottom-style: hidden" id="ID059">
            {{ cli.description }} - {{ cli.stock_code }}
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID060">
            {{ cli.pcs }}
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID061">
            {{ cli.weight }}
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID062">
            {{ cli.rate | number : "1.2" }}
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID063">
            {{ cli.gross_amt | number : "1.2" }}
            <!-- {{ cli.mkg_amount| number:'1.2' }} -->
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID064">
            {{ cli.dis_amt | number : "1.2" }}
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID065">
            {{ cli.taxPer | number : "1.2" }}
            <!-- {{ branch_tax_percentage }} -->
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID066">
            {{ cli.tax_amount | number : "1.2" }}
          </td>
          <td style="border-bottom-style: hidden; text-align-last: right" id="ID067">
            {{ cli.net_amount | number : "1.2" }}
          </td>
        </tr>
        <!-- <tr>
            <td style="text-align:center;" colspan="9"> <b> Exchange Item </b></td>
          </tr> -->
        <!-- <tr *ngFor="let cli of exchange_items; let id = index">
            <td style="border-bottom-style: hidden;text-align:center;">{{cli.sn_no}}</td>
            <td style="border-bottom-style: hidden;">{{cli.description}} - {{cli.stock_code}}</td>
            <td style="border-bottom-style: hidden;text-align-last: right;">{{cli.pcs}}</td>
            <td style="border-bottom-style: hidden;text-align-last: right;">{{cli.weight}}</td>
            <td style="border-bottom-style: hidden;text-align-last: right;">{{cli.mkg_amount}}</td>
            <td style="border-bottom-style: hidden;text-align-last: right;">{{cli.mkg_amount}}</td>
            <td style="border-bottom-style: hidden;text-align-last: right;">{{branch_tax_percentage}}</td>
            <td style="border-bottom-style: hidden;text-align-last: right;">{{cli.tax_amount}}</td>
            <td style="border-bottom-style: hidden;text-align-last: right;">{{cli.net_amount}}</td>
  
          </tr> -->
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td style="border-right-style: hidden" colspan="2">
            <div>
              <p style="float: left" id="ID068">({{ prnt_inv_total_pcs }} items)</p>
              <p style="float: right" id="ID069">Total</p>
            </div>
          </td>
          <!-- <td style="border-right-style: hidden;"></td> -->
          <!-- <td style="border-right-style: hidden;">({{prnt_inv_total_pcs}} items)</td>
            <td style="border-right-style: hidden;">Total</td> -->
          <td style="font-weight: 600; text-align-last: right" id="ID070">
            {{ prnt_inv_total_pcs }}
          </td>
          <td style="font-weight: 600; text-align-last: right">
            <!-- {{ prnt_inv_total_weight }} -->
            &nbsp;
          </td>
          <td style="font-weight: 600; text-align-last: right">
            &nbsp;
            <!-- {{order_items_total_amount | number:'1.2' }} -->
          </td>
          <td style="font-weight: 600; text-align-last: right" id="ID071">
            {{ prnt_inv_total_gross_amt | number : "1.2" }}
            <!-- {{ prnt_inv_net_total_without_tax }} -->
          </td>
          <td style="font-weight: 600; text-align-last: right">&nbsp;</td>
          <td style="font-weight: 600; text-align-last: right" id="ID072">
            {{ prnt_inv_total_tax_amount | number : "1.2" }}
          </td>
          <td style="font-weight: 600; text-align-last: right" id="ID073">
            <!-- {{ prnt_inv_net_total_with_tax }} -->
            {{ order_items_total_gross_amount | number : "1.2" }}
          </td>
        </tr>
        <tr>
          <td colspan="8" style="font-weight: 600; text-align-last: right" id="ID074">
            Total Before VAT
          </td>
          <td style="text-align-last: right" id="ID075">
            {{ prnt_inv_total_gross_amt | number : "1.2" }}
            <!-- {{ prnt_inv_net_total_without_tax }} -->
          </td>
        </tr>
        <tr>
          <td colspan="8" style="font-weight: 600; text-align-last: right" id="ID076">
            Total Discount
          </td>
          <td style="text-align-last: right" id="ID077">
            {{ order_items_total_discount_amount | number : "1.2" }}
          </td>
        </tr>
        <tr>
          <td colspan="8" style="font-weight: 600; text-align-last: right" id="ID078">
            Total VAT 5%
          </td>
          <td style="text-align-last: right" id="ID079">
            {{ prnt_inv_total_tax_amount | number : "1.2" }}
          </td>
        </tr>
        <tr>
          <td colspan="8" style="font-weight: 600; text-align-last: right" id="ID080">
            Net Amount
          </td>
          <td style="text-align-last: right" id="ID081">
            {{ order_items_total_gross_amount | number : "1.2" }}
            <!-- {{ prnt_inv_net_total_with_tax }} -->
          </td>
        </tr>

        <tr [style]="
            invReturnSalesTotalNetTotal != 0 ? 'border-bottom: hidden' : ''
          " *ngIf="invReturnSalesTotalNetTotal != 0">
          <td colspan="9" style="font-weight: 600;" id="ID082">
            Sales Return : {{ invReturnSalesTotalNetTotal | number : "1.2" }}
          </td>
        </tr>
        <tr *ngIf="order_total_exchange != 0">
          <td colspan="9" style="font-weight: 600" id="ID083">
            Exchange : {{ order_total_exchange | number : "1.2" }}
          </td>
        </tr>
        <tr hidden>
          <td colspan="9" style="font-weight: 600" id="ID084">
            Recieved : {{ prnt_received_amount | number : "1.2" }}
          </td>
        </tr>
        <tr hidden>
          <td colspan="9" style="text-transform: capitalize" id="ID085">
            {{
            prnt_received_amount_words != ""
            ? prnt_received_amount_words +
            "UNITED ARAB EMIRATES DIRHAM Only"
            : ""
            }}
          </td>
        </tr>

        <tr style="border-top: 1px solid #000">
          <td colspan="3" id="ID086">Confirmed on behalf of</td>
          <td colspan="6" style="font-weight: 600; text-align-last: right" id="ID087">
            <!-- Meena Jewellery -->
            {{ this.comFunc.allbranchMaster.BRANCH_NAME }}
            <!-- Suntech Business Solutions -->
          </td>
        </tr>

        <tr style="border-bottom: hidden; height: 120px">
          <td colspan="3"></td>
          <td colspan="3"></td>
          <td colspan="3"></td>
        </tr>
        <tr>
          <td colspan="3" style="font-weight: 600; font-size: 14px; text-align: center" id="ID088">
            CUSTOMER'S SIGNATURE
          </td>
          <td colspan="3" style="font-weight: 600; font-size: 14px; text-align: center" id="ID089">
            INVOICE CHECKED BY
          </td>
          <td colspan="3" style="font-weight: 600; font-size: 14px; text-align: center" id="ID090">
            AUTHORISED SIGNATURE
          </td>
        </tr>
        <tr>
          <td colspan="9" style="font-weight: 300; text-align-last: center; font-size: 14px" id="ID091">
            THANK YOU FOR SHOPPING WITH US
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="card-content border-bottom d-flex justify-content-between p-2">
  <h5 class="pos-modaltitle" id="modal-dia-metal">Sales Estimation</h5>
  <button type="button" class="btn btn-close close-btn" (click)="close()">
    <i class="feather icon-x close-icon"></i>
  </button>
</div>
<!-- modal header component -->

<!-- <div class="text-right p-2 modal-header">
  <button type="button" class="btn btn-primary float-end" (click)="addNew()">Add</button>
  <button type="button" class="btn btn-close close-btn" (click)="close()">
    <i class="feather icon-x close-icon"></i>
  </button> -->
<!-- <zxing-scanner [formats]="['QR_CODE', 'EAN_13', 'CODE_128', 'DATA_MATRIX']" [autostart]="true" [autofocusEnabled]="true"></zxing-scanner> -->
<!-- </div> -->
<!-- <div style="height: 15%;"> -->
<!-- working -->
<!-- <ngx-barcode-scanner #myscanner id="myscanner" [(value)]="barcode" [codes]="['code_128']" (exception)="onError($event)"  (valueChange)="onValueChanges($event)"
      [errorThreshold]="0.1"></ngx-barcode-scanner> -->
<!-- working -->
<!-- <barcode-scanner-livestream-overlay #scanner id="scanner" [type]="['code_128', 'ean', 'upc', 'upc_e', 'ean_8']"
    (valueChanges)="onValueChanges($event)"></barcode-scanner-livestream-overlay> -->
<!-- <ngx-barcode-scanner #myscanner id="myscanner" [(value)]="barcode" [codes]="['code_128', 'ean', 'upc', 'upc_e', 'ean_8']"
    (exception)="onError($event)" (valueChange)="onValueChanges($event)" [errorThreshold]="0.1"></ngx-barcode-scanner> -->
<!-- <div style="display: flex; justify-content: space-between; margin: 5% auto">
    <button (click)="onStartButtonPress()">Start</button>
    <button (click)="onStopButtonPress()">Stop</button>
  </div> -->
<!-- </div> -->
<!-- <div style="height: 15%;" > -->
<!-- <div style="height: 15%;" [hidden]="!this.scanner.isStarted"> -->
<!-- <section >
      <h2>Scan Barcode</h2>
     <barcode-scanner-livestream #scanner id="scanner" type="code_128" (valueChanges)="onValueChanges($event)"
        (started)="(onStarted)" >
      </barcode-scanner-livestream>
      <div>
        Serial Number: {{barcode}}
      </div>
    </section>
  </div> -->
<div class="modal-body">
  <div class="row p-2" style="margin: 6px 6px 0px 6px">
    <div class="col-xl-12">
      <form [formGroup]="vocDataForm" style="width: 100%; max-width: none">
        <div class="row" style="background-color: #efefef;">
          <!--- <div class="col-md-3">
                    <h5 style="padding-top:15px;">Point Of Sale</h5>
            </div> -->
          <div class="col-md-1 d-flex justify-content-center align-items-center">
            <div>
              <button type="button" color="primary" mat-flat-button (click)="addNew()" id="ID092">
                New
              </button>
            </div>
          </div>
          <div class="col-md-2 mt-3">
            <div class="form-group row">
              <label class="col-form-label col-sm-4" id="ID093">
                {{ vocno_lbl }} :
              </label>
              <!-- <mat-form-field>
                    <mat-label>Voucher</mat-label>
                    <input type="text" matInput id="voc_type" formControlName="voc_type" readonly />
                  </mat-form-field> -->
              <div class="col-sm-5">
                <mat-form-field appearance="outline">
                  <input type="text" matInput formControlName="fcn_voc_no" [readonly]="voucherDetails?.LOCKVOUCHERNO"
                    class="st_txt_right" />
                </mat-form-field>
              </div>
            </div>
          </div>

          <div class="col-md-2 mt-3">
            <div class="form-group row">
              <label class="col-form-label col-sm-5" id="ID094">Currency :</label>
              <div class="col-sm-6">
                <mat-form-field appearance="outline">
                  <input type="text" matInput id="txtCurrency" formControlName="txtCurrency" readOnly
                    [matAutocomplete]="currencyList" />
                  <mat-autocomplete #currencyList="matAutocomplete" autoActiveFirstOption
                    (optionSelected)="changeCurrency($event)">
                    <!-- <mat-option *ngFor="let option of currencyMasterOptions | async" [value]="option.CURRENCY_CODE">
                        {{ option.CURRENCY_CODE }}
                      </mat-option> -->
                  </mat-autocomplete>
                </mat-form-field>
              </div>
            </div>
          </div>

          <div class="col-md-3 mt-3">
            <div class="form-group row">
              <label class="col-form-label col-sm-2" id="ID095">Cur&nbsp;Rate:</label>
              <div class="col-sm-4">
                <mat-form-field appearance="outline">
                  <input class="st_txt_right" type="text" matInput id="txtCurRate" SixDecimalInput
                    formControlName="txtCurRate" [readonly]="
                      viewOnly ||
                      this.vocDataForm.value.txtCurrency == this.comFunc.compCurrency"
                    (change)="changeCurRate($event)" />
                </mat-form-field>
              </div>

              <div class="col-sm-6">
                <mat-form-field style="width: 100%" appearance="outline">
                  <input matInput DateValidation (dateChange)="formatDate($event)" [matDatepicker]="dob"
                    [readonly]="viewOnly" formControlName="vocdate"
                    [min]="voucherDetails?.BLOCKBACKDATEDENTRIES ? this.comFunc.currentDate : null"
                    [max]="voucherDetails?.BLOCKFUTUREDATE ? this.comFunc.currentDate : null"
                    placeholder="DD/MM/YYYY" />
                  <mat-datepicker-toggle matSuffix [for]="dob" [disabled]="viewOnly"></mat-datepicker-toggle>
                  <mat-datepicker #dob></mat-datepicker>
                </mat-form-field>
              </div>
            </div>
          </div>

          <div class="col-md-3 mt-3">
            <div class="form-group row">
              <label class="col-form-label col-sm-4" id="ID096">{{ sales_person_lbl }} :</label>
              <div class="col-sm-7">
                <mat-form-field appearance="outline">
                  <input type="text" matInput formControlName="sales_person" id="sales_person"
                    [matAutocomplete]="salesperson" [readonly]="viewOnly" />
                  <!-- <input type="text" matInput formControlName="sales_person"  [matAutocomplete]="auto" [matAutocomplete]="salesperson" (keyup.enter)="chooseFirstOption($event)"> -->
                  <mat-autocomplete #salesperson="matAutocomplete" autoActiveFirstOption
                    (optionSelected)="changeSalesPerson($event.option.value)">
                    <mat-option *ngFor="let option of salesPersonFilteredOptions | async"
                      [value]="option.SALESPERSON_CODE">
                      {{ option.SALESPERSON_CODE + " - " + option.DESCRIPTION }}
                    </mat-option>
                  </mat-autocomplete>

                  <mat-error *ngIf="vocDataForm.controls.sales_person.hasError('required')" id="ID097">
                    Salesman Code cannot be Empty
                  </mat-error>
                  <mat-error *ngIf="vocDataForm.controls.sales_person.hasError('notInOptions')" id="ID098">
                    Invalid value
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>


          <div class="col-md-1 d-flex justify-content-center align-items-center" style="background-color: #d6d8da">
            <div class="form-group row">
              <div class="font-weight-bold" style="font-size: 20px; font-weight: 400; color: #0d4f9e" id="ID099">
                Net Total
              </div>
              <div style="font-size: 22px; font-weight: 500" id="ID100">
                {{comFunc.compCurrency}} {{ order_items_total_net_amount |
                decimalFormat : "AMOUNT" }}
              </div>
            </div>
          </div>

        </div>
      </form>
    </div>
  </div>

  <div class="row">
    <div class="col-xl-9">
      <div style="background-color: #ffffff">
        <div>
          <form [formGroup]="customerDataForm" style="width:100%; max-width: none">
            <div class="row">
              <div class="col-md-3">
                <div class="form-group row">
                  <label class="col-form-label col-sm-3" id="ID101">Mobile Number</label>
                  <div class="col-sm-9 mt-2">
                    <mat-form-field appearance="outline">
                      <input type="text" style="text-align: right;"
                        onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                        matInput (focusout)="!viewOnly && onCustomerNameFocus()" formControlName="fcn_customer_mobile"
                        [readonly]="viewOnly" />
                      <!-- <input type="number" min="0" oninput="validity.valid||(value='');" matInput (change)="onCustomerNameFocus()" formControlName="fcn_customer_mobile"
                          [readonly]="viewOnly" /> -->
                      <mat-error *ngIf="
                          customerDataForm.controls.fcn_customer_mobile.hasError(
                            'required')" id="ID102">
                        Mobile Number is <strong>required</strong>
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-2">
                <div class="form-group row">
                  <label class="col-form-label col-sm-3 mt-1" id="ID103">Name</label>
                  <div class="col-sm-9 mt-2">
                    <mat-form-field appearance="outline">
                      <input type="text" matInput formControlName="fcn_customer_name" (change)="nameChange($event)"
                        [readonly]="true" />
                      <!-- <input type="text" matInput [pattern]="noWhiteSpacePattern" formControlName="fcn_customer_name" (change)="nameChange($event)"  [readonly]="viewOnly" /> -->
                      <mat-error *ngIf="
                        customerDataForm.controls.fcn_customer_name.hasError('required')" id="ID104">
                        Name is <strong>required</strong>
                      </mat-error>
                      <mat-error *ngIf="
                        customerDataForm.controls.fcn_customer_name.hasError('pattern')" id="ID105">
                        Whitespace Not Allowed
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-2">
                <div class="form-group row">
                  <label class="col-form-label col-sm-3 mt-1" id="ID106">Code</label>
                  <div class="col-sm-9 mt-2">
                    <mat-form-field appearance="outline">
                      <input type="text" matInput formControlName="fcn_customer_code" (change)="nameChange($event)"
                        [readonly]="true" />
                      <!-- <input type="text" matInput formControlName="fcn_customer_code" (change)="nameChange($event)"
                        [readonly]="
                        viewOnly ||
                        this.customerDataForm.value.fcn_customer_code == ''
                      " /> -->
                      <!-- <input type="text" matInput [pattern]="noWhiteSpacePattern" formControlName="fcn_customer_name" (change)="nameChange($event)"  [readonly]="viewOnly" /> -->
                      <mat-error *ngIf="
                        customerDataForm.controls.fcn_customer_code.hasError('required')" id="ID107">
                        Code is <strong>required</strong>
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group row">
                  <label class="col-form-label col-sm-3 mt-1" id="ID108">ID Type</label>
                  <div class="col-sm-8 mt-2">
                    <mat-form-field appearance="outline">
                      <input type="text" matInput formControlName="fcn_customer_id_type" [matAutocomplete]="idtype"
                        [readonly]="true" />
                      <mat-autocomplete #idtype="matAutocomplete" (optionSelected)="changeIdtype($event.option.value)"
                        autoActiveFirstOption>
                        <mat-option *ngFor="let option of idTypeFilteredOptions | async" [value]="option">
                          {{ option }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error *ngIf="
                          customerDataForm.controls.fcn_customer_id_type.hasError('required')" id="ID109">
                        ID Type is <strong>required</strong>
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-2">
                <div class="form-group row">
                  <label class="col-form-label col-sm-3 mt-1" id="ID110">ID#</label>
                  <div class="col-sm-9 mt-2">
                    <mat-form-field appearance="outline">
                      <input type="text" matInput formControlName="fcn_customer_id_number" [readonly]="true" />
                      <mat-error *ngIf="
                        customerDataForm.controls.fcn_customer_id_number.hasError('required')" id="ID111">
                        ID# is <strong>required</strong>
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3">
                <div class="form-group row">
                  <label class="col-form-label col-sm-3 mt-1" id="ID112">Expiry Date</label>
                  <div class="col-sm-9 mt-2">
                    <mat-form-field appearance="outline">
                      <input matInput [matDatepicker]="expDate" name="fcn_customer_exp_date"
                        formControlName="fcn_customer_exp_date" placeholder="DD/MM/YYYY" [readonly]="viewOnly" />
                      <mat-datepicker-toggle matSuffix [for]="expDate"></mat-datepicker-toggle>
                      <mat-datepicker [startAt]="currentDate" #expDate></mat-datepicker>

                      <mat-error *ngIf="customerDataForm.controls.fcn_customer_exp_date.hasError('required')" id="ID113">
                        Expiry date is <strong>required</strong>
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <div class="col-md-2 text-right mt-2">
                <button type="button" style="font-size: 12px;" (click)="open(more_customer_detail_modal)"
                  mat-flat-button color="primary" [disabled]="viewOnly" id="ID114">
                  {{this.customerDetails.MOBILE == null || undefined ? "Add Customer" : "Edit Customer" }}
                </button>
              </div>
            </div>
          </form>

          <div class="col-md-12 m-t-10" style="padding: 0px">
            <mat-tab-group>
              <mat-tab label="Line Item">
                <div class="table-responsive">
                  <div class="content">
                    <div class="left">
                      <div class="wrapper">
                        <div class="container" style="padding: 0px">
                          <dx-data-grid id="gridContainer" [dataSource]="ordered_items" keyExpr="ID"
                            [showBorders]="true" (onRowRemoved)="removeLineItemsGrid($event)"
                            (onEditingStart)="editTable($event)">
                            <dxo-editing [allowUpdating]="true" [allowDeleting]="!viewOnly">
                              <dxo-texts alignment="right" [editRow]="viewOnly ? 'View' : 'Edit'" deleteRow="Remove">
                              </dxo-texts>
                            </dxo-editing>

                            <dxo-selection mode="single"></dxo-selection>
                            <dxi-column dataField="sn_no" [width]="80" caption="SL No." [allowEditing]="false"
                              alignment="center">
                            </dxi-column>
                            <dxi-column dataField="stock_code" [width]="100" [allowEditing]="false">
                            </dxi-column>
                            <dxi-column dataField="description" [width]="150" [allowEditing]="false" alignment="center">
                            </dxi-column>

                            <dxi-column dataField="pcs" caption="Pcs" [width]="100" [allowEditing]="false"></dxi-column>
                            <dxi-column dataField="weight" caption="Weight" [width]="100" [format]="weightDecimalFormat"
                              [allowEditing]="false">
                            </dxi-column>
                            <dxi-column dataField="metal_amt" caption="Metal Value" [width]="100" [allowEditing]="false"
                              [format]="amountDecimalFormat"></dxi-column>

                            <dxi-column dataField="total_amount" caption="Mkg amount" alignment="right"
                              [allowEditing]="false" [format]="amountDecimalFormat" [width]="150"></dxi-column>
                            <dxi-column dataField="net_amount" caption="Total amount" alignment="right"
                              format="currency" [format]="amountDecimalFormat" [allowEditing]="false" [width]="150">
                            </dxi-column>
                            <!-- <dxi-column caption="Actions" [width]="100" [allowEditing]="false">
                            </dxi-column> -->
                            <!-- <dxi-column type="buttons" >
                                                        <dxi-button template="orders">
                                                            <div *dxTemplate="let data of 'orders'">
                                                                <a class="badge m-r-5 badge-warning" [(ngModel)]="data" (click)="editTable($event)"><i class="feather icon-edit"></i></a>
    
                                                            </div>
                                                        </dxi-button>
                                                    </dxi-column> -->
                            <dxo-summary>
                              <dxi-total-item column="sn_no">
                              </dxi-total-item>
                              <dxi-total-item column="stock_code" summaryType="min" [customizeText]="customizeDate">
                              </dxi-total-item>

                              <dxi-total-item column="pcs" summaryType="sum" [customizeText]="customizeQty">
                              </dxi-total-item>

                              <dxi-total-item column="metal_amt" summaryType="sum" displayFormat="{0}" precision="2"
                                [valueFormat]="gridAmountDecimalFormat">
                              </dxi-total-item>

                              <dxi-total-item column="weight" summaryType="sum" caption="Weight"
                                [valueFormat]="weightDecimalFormat" displayFormat="{0}">
                                >
                                <!-- [customizeText]="customizeWeight" -->
                              </dxi-total-item>

                              <dxi-total-item column="total_amount" summaryType="sum" displayFormat="{0}"
                                type="fixedPoint" precision="2" [valueFormat]="gridAmountDecimalFormat">
                              </dxi-total-item>
                              <dxi-total-item column="net_amount" summaryType="sum" displayFormat="{0}" precision="2"
                                [valueFormat]="gridAmountDecimalFormat">
                              </dxi-total-item>
                              <!-- <dxi-total-item column="total_amount" summaryType="sum" displayFormat="AED {0}"
                                  [valueFormat]="{ currency: 'AED' }">
                                </dxi-total-item> -->
                            </dxo-summary>
                          </dx-data-grid>
                        </div>

                        <div class="mt-2 mx-2">
                          <!-- type="submit"
                              [disabled]="this.viewOnly || this.amlNameValidation == true ? (this.customerDataForm.value.fcn_customer_mobile != '') ? false : true : false
                              type="submit"
                                [disabled]="this.customerDataForm.value.fcn_customer_mobile != '' && this.customerDataForm.value.fcn_customer_name != '' ? false: true
                                "
                              " -->
                          <!-- <button type="submit" [disabled]="this.viewOnly" (click)="open(mymodal)" -->
                          <!-- <button type="submit" (click)="open(mymodal)" [disabled]="this.viewOnly " -->
                          <button type="submit" [disabled]="this.viewOnly" (click)="open(mymodal)"
                            class="btn btn-secondary" style="padding: 3px 10px;">
                            <i class="fa fa-plus"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </mat-tab>

              <mat-tab label="Sales Return">
                <div class="table-responsive">
                  <div class="content">
                    <div class="left">
                      <div class="wrapper">
                        <div class="container">
                          <dx-data-grid id="sales_return_grid" [dataSource]="sales_returns_items" keyExpr="ID"
                            (onRowRemoved)="removeSalesReturnGrid($event)"
                            (onEditingStart)="editTableSalesReturn($event)" [showBorders]="true"
                            [allowColumnResizing]="true" [columnAutoWidth]="true">
                            <dxo-editing [allowUpdating]="true" [allowDeleting]="!viewOnly">
                              <dxo-texts [editRow]="viewOnly ? 'View' : 'Edit'" deleteRow="Remove">
                              </dxo-texts>
                            </dxo-editing>
                            <dxo-selection mode="single"></dxo-selection>
                            <dxi-column dataField="sn_no" [width]="70" caption="SL No." [allowEditing]="false">
                            </dxi-column>
                            <dxi-column dataField="stock_code" [width]="120" [allowEditing]="false">
                            </dxi-column>
                            <dxi-column dataField="description" [width]="200" [allowEditing]="false"></dxi-column>

                            <dxi-column dataField="pcs" caption="Pcs" [width]="100" [allowEditing]="false"></dxi-column>
                            <dxi-column dataField="weight" caption="Weight" [width]="100" [allowEditing]="false"
                              displayFormat="Wt: {0}" [format]="weightDecimalFormat">
                            </dxi-column>

                            <dxi-column dataField="mkg_amount" alignment="right" format="currency" [width]="150"
                              [allowEditing]="false" [format]="amountDecimalFormat"></dxi-column>
                            <dxi-column dataField="net_amount" alignment="right" format="currency"
                              [allowEditing]="false" [format]="amountDecimalFormat" [width]="150">
                            </dxi-column>
                            <!-- <dxi-column type="buttons" >
                                                    <dxi-button template="orders">
                                                        <div *dxTemplate="let data of 'orders'">
                                                            <a class="badge m-r-5 badge-warning" [(ngModel)]="data" (click)="editTable($event)"><i class="feather icon-edit"></i></a>
    
                                                        </div>
                                                    </dxi-button>
                                                </dxi-column> -->
                            <dxo-summary>
                              <dxi-total-item column="sn_no">
                              </dxi-total-item>
                              <dxi-total-item column="stock_code" summaryType="min" [customizeText]="customizeDate">
                              </dxi-total-item>

                              <dxi-total-item column="pcs" summaryType="sum" [customizeText]="customizeQty">
                              </dxi-total-item>

                              <dxi-total-item column="weight" summaryType="sum" caption="Total Wt"
                                [valueFormat]="weightDecimalFormat" displayFormat="Wt: {0}">
                                <!-- [customizeText]="customizeWeight" -->
                              </dxi-total-item>

                              <dxi-total-item column="mkg_amount" summaryType="sum"
                                [valueFormat]="gridAmountDecimalFormat" displayFormat="AED {0}">
                              </dxi-total-item>
                              <dxi-total-item column="net_amount" summaryType="sum"
                                [valueFormat]="gridAmountDecimalFormat" displayFormat="AED {0}">
                                <!-- [valueFormat]="{ currency: 'EUR' }" -->
                              </dxi-total-item>
                            </dxo-summary>
                          </dx-data-grid>

                          <div class="mt-2 mx-2">
                            <button type="submit"
                              [disabled]="this.ordered_items.length > 0 && !this.viewOnly ? false: true"
                              (click)="open(adjust_sale_return_modal)" class="btn btn-secondary"
                              style="padding: 3px 10px;">
                              <i class="fa fa-plus"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </mat-tab>

              <mat-tab label="Exchange">
                <div class="table-responsive">
                  <div class="content">
                    <div class="left">
                      <div class="wrapper">
                        <div class="container">
                          <dx-data-grid id="exchange_item_grid" [dataSource]="exchange_items" keyExpr="ID"
                            (onRowRemoved)="removeExchangeItemGrid($event)" [showBorders]="true"
                            (onEditingStart)="editTableExchangeItem($event)">
                            <!-- <dxo-editing [allowUpdating]="false" [allowDeleting]="true">
                                <dxo-texts deleteRow="Remove"> </dxo-texts>
                              </dxo-editing> -->
                            <dxo-editing [allowUpdating]="true" [allowDeleting]="!viewOnly">
                              <dxo-texts [editRow]="viewOnly ? 'View' : 'Edit'" deleteRow="Remove">
                              </dxo-texts>
                            </dxo-editing>
                            <dxo-selection mode="single"></dxo-selection>
                            <dxi-column dataField="sn_no" [width]="100" caption="SL No." [allowEditing]="false">
                            </dxi-column>
                            <dxi-column dataField="stock_code" [width]="120" [allowEditing]="false">
                            </dxi-column>
                            <dxi-column dataField="description" [width]="200" [allowEditing]="false"></dxi-column>

                            <dxi-column dataField="pcs" caption="Pcs" [width]="100" [allowEditing]="false"></dxi-column>

                            <dxi-column dataField="weight" caption="Weight" [width]="100" [allowEditing]="false"
                              [format]="weightDecimalFormat">
                            </dxi-column>

                            <dxi-column dataField="net_amount" alignment="right" [format]="amountDecimalFormat"
                              [allowEditing]="false">
                            </dxi-column>
                            <!-- <dxi-column type="buttons" >
                                                    <dxi-button template="orders">
                                                        <div *dxTemplate="let data of 'orders'">
                                                            <a class="badge m-r-5 badge-warning" [(ngModel)]="data" (click)="editTable($event)"><i class="feather icon-edit"></i></a>
    
                                                        </div>
                                                    </dxi-button>
                                                </dxi-column> -->
                            <dxo-summary>
                              <dxi-total-item column="sn_no">
                              </dxi-total-item>
                              <dxi-total-item column="stock_code" summaryType="min" [customizeText]="customizeDate">
                              </dxi-total-item>

                              <dxi-total-item column="pcs" summaryType="sum" [customizeText]="customizeQty">
                              </dxi-total-item>

                              <dxi-total-item column="weight" summaryType="sum" caption="Total Wt"
                                [valueFormat]="weightDecimalFormat" displayFormat="Wt: {0}">
                                <!-- [customizeText]="customizeWeight" -->
                              </dxi-total-item>

                              <dxi-total-item column="net_amount" summaryType="sum"
                                [valueFormat]="gridAmountDecimalFormat" displayFormat="AED {0}">
                                <!-- [valueFormat]="{ currency: 'EUR' }" -->
                              </dxi-total-item>
                            </dxo-summary>
                          </dx-data-grid>

                          <div class="mt-2 mx-2">
                            <button type="submit" [disabled]="
                              this.ordered_items.length > 0 && !this.viewOnly ? false : true"
                              (click)="open(oldgoldmodal)" class="btn btn-secondary" style=" padding: 3px 10px;">
                              <i class="fa fa-plus"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </mat-tab>
            </mat-tab-group>

            <!--<div class="table-responsive" style="height:400px;overflow-y: scroll;background:#ffffff;padding:10px;">
                          <table class="table">
                              <thead>
                                  <tr>
                                      <th>SNo</th>
                                      <th>Product Image</th>
                                      <th>Product Code</th>
                                      <th>Product Name</th>
                                      <th class="text-center">Weight</th>
                                      <th class="text-center">Qty</th>
                                      <th class="text-right">Rate</th>
                                      <th class="text-right">Total Amount</th>
                                      <th class="text-right">Action</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                      <td>1</td>
                                      <td><img src="https://angulardata.sunwebapps.com/Images/LRC001143-R.jpg" style="width:75px;height:75px;"></td>
                                      <td>HL8998</td>
                                      <td>Gold Ring</td>
                                      <td class="text-center">12</td>
                                      <td class="text-center">3</td>
                                      <td class="text-right">3400.00</td>
                                      <td class="text-right">8900.00</td>
                                      <td class="text-right">
                                          <a href="" class="badge m-r-5 badge-warning"><i class="feather icon-edit"></i></a>
                                          <a href="" class="badge m-r-5 badge-danger"><i class="feather icon-trash"></i></a>
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>2</td>
                                      <td><img src="https://angulardata.sunwebapps.com/Images/25-jan-2017/CDB00011B-W.jpg" style="width:75px;height:75px;"></td>
                                      <td>DCV1812</td>
                                      <td>Dimond Ring</td>
                                      <td class="text-center">24</td>
                                      <td class="text-center">3</td>
                                      <td class="text-right">1600.00</td>
                                      <td class="text-right">18000.00</td>
                                      <td class="text-right">
                                          <a href="" class="badge m-r-5 badge-warning"><i class="feather icon-edit"></i></a>
                                          <a href="" class="badge m-r-5 badge-danger"><i class="feather icon-trash"></i></a>
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>3</td>
                                      <td><img src="https://angulardata.sunwebapps.com/Images/LRC001143-R.jpg" style="width:75px;height:75px;"></td>
                                      <td>AGE18966</td>
                                      <td>Diamond Bangle</td>
                                      <td class="text-center">9</td>
                                      <td class="text-center">1</td>
                                      <td class="text-right">1789.00</td>
                                      <td class="text-right">1789.00</td>
                                      <td class="text-right">
                                          <a href="" class="badge m-r-5 badge-warning"><i class="feather icon-edit"></i></a>
                                          <a href="" class="badge m-r-5 badge-danger"><i class="feather icon-trash"></i></a>
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>4</td>
                                      <td><img src="https://angulardata.sunwebapps.com/Images/25-jan-2017/CDB00011B-W.jpg" style="width:75px;height:75px;"></td>
                                      <td>HL8998</td>
                                      <td>Gold Ring</td>
                                      <td class="text-center">16</td>
                                      <td class="text-center">2</td>
                                      <td class="text-right">2500.00</td>
                                      <td class="text-right">5000.00</td>
                                      <td class="text-right">
                                          <a href="" class="badge m-r-5 badge-warning"><i class="feather icon-edit"></i></a>
                                          <a href="" class="badge m-r-5 badge-danger"><i class="feather icon-trash"></i></a>
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>5</td>
                                      <td><img src="https://angulardata.sunwebapps.com/Images/LRC001143-R.jpg" style="width:75px;height:75px;"></td>
                                      <td>DCV1812</td>
                                      <td>Dimond Ring</td>
                                      <td class="text-center">20</td>
                                      <td class="text-center">3</td>
                                      <td class="text-right">3000.00</td>
                                      <td class="text-right">9000.00</td>
                                      <td class="text-right">
                                          <a href="" class="badge m-r-5 badge-warning"><i class="feather icon-edit"></i></a>
                                          <a href="" class="badge m-r-5 badge-danger"><i class="feather icon-trash"></i></a>
                                      </td>
                                  </tr>
                                  <tr>
                                      <td>6</td>
                                      <td><img src="https://angulardata.sunwebapps.com/Images/25-jan-2017/CDB00011B-W.jpg" style="width:75px;height:75px;"></td>
                                      <td>DCV1812</td>
                                      <td>Dimond Ring</td>
                                      <td class="text-center">24</td>
                                      <td class="text-center">3</td>
                                      <td class="text-right">6000.00</td>
                                      <td class="text-right">18000.00</td>
                                      <td class="text-right">
                                          <a href="" class="badge m-r-5 badge-warning"><i class="feather icon-edit"></i></a>
                                          <a href="" class="badge m-r-5 badge-danger"><i class="feather icon-trash"></i></a>
                                      </td>
                                  </tr>
  
                              </tbody>
                          </table>
                      </div> -->
            <hr style="width: 100%" />
          </div>

          <div class="row" style="margin-top: 0px">
            <!--- <div class="col-md-6">
                          <div class="card m-t-10">
                              <div class="card-header">
                                  <b>Customer Details</b>
                              </div>
                              <div class="card-body receipt-details">
                                  <div class="row">
                                      <div class="col-md-6">
                                          <mat-form-field>
                                              <mat-label>Mobile Number</mat-label>
                                              <input type="text" matInput formControlName="voc_type">
                                          </mat-form-field>
                                      </div>
  
                                      <div class="col-md-6">
                                          <mat-form-field>
                                              <mat-label>Name</mat-label>
                                              <input type="text" matInput formControlName="voc_type">
                                          </mat-form-field>
                                      </div>
                                      <div class="col-md-6">
                                          <mat-form-field>
                                              <mat-label>Email</mat-label>
                                              <input type="text" matInput formControlName="voc_type">
                                          </mat-form-field>
                                      </div>
                                      <div class="col-md-6">
                                          <mat-form-field>
                                              <mat-label>Type</mat-label>
                                              <input type="text" matInput formControlName="voc_type">
                                          </mat-form-field>
                                      </div>
  
  
                                      <div class="col-md-6">
                                          <div class="form-group">
                                              <label class="font-weight-bold">Customer Full Address</label>
                                              <textarea class="form-control" id="" rows="2"></textarea>
                                          </div>
                                      </div>
                                      <div class="col-md-6">
  
                                          <div class="form-group">
                                              <label class="font-weight-bold">Remarks</label>
                                              <textarea class="form-control" id="" rows="2"></textarea>
                                          </div>
                                      </div>
                                  </div>
  
  
                              </div>
                          </div>
                      </div> -->
            <div class="col-md-6" hidden="true">
              <div class="card m-t-10">
                <div class="card-header">
                  <b (click)="open(sales_payment_modal)" style="
                    color: #0861a9; cursor: pointer; text-decoration: underline;" id="ID115">Receipt Details</b>
                  <span style="float: right"><button type="submit" (click)="open(sales_payment_modal)"
                      class="btn btnsml btn-secondary w-30" id="ID116">Add </button>
                  </span>
                </div>
                <div class="card-body receipt-details">
                  <table class="tabletd_gray">
                    <tr>
                      <th id="ID117">Mode</th>
                      <th id="ID118">Currency</th>
                      <th id="ID119">Amount LC</th>
                      <th>&nbsp;</th>
                    </tr>
                    <tr *ngFor="
                      let rec_details of receiptDetailsList;
                      let id = index
                    ">
                      <td id="ID120">{{ rec_details.RECEIPT_MODE }}</td>
                      <td id="ID121">{{ rec_details.CURRENCY_CODE }}</td>
                      <td style="text-align: right; padding-right: 3px" id="ID122">
                        {{ rec_details.AMOUNT_FC }}
                      </td>
                      <td *ngIf="viewOnly">
                        <button type="submit" (click)="editReceiptItem(id, rec_details)"
                          class="btn btnsml btn-primary w-30 m-l-10">
                          <i class="fa fa-eye"></i>
                        </button>
                      </td>
                      <td *ngIf="!viewOnly">
                        <button type="submit" (click)="editReceiptItem(id, rec_details)"
                          class="btn btnsml btn-primary w-30 m-l-10">
                          <i class="fa fa-edit"></i>
                        </button>
                        <button type="submit" (click)="removePayments(id)" class="btn btnsml btn-danger w-30 m-l-10">
                          <i class="fa fa-trash"></i>
                        </button>
                      </td>
                    </tr>
                  </table>

                  <div class="row">
                    <div class="col-md-12 text-right m-t-10">
                      <!--<button type="submit" class="btn btnsml btn-secondary w-30 m-l-10">Delete</button>-->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-3">
      <div class="card" style="background-color: #ececec !important">
        <div class="card-body">
          <div class="row">
            <div class="col-xl-12 col-md-6">
              <table class="tabletd_gray">
                <tr>
                  <th style="width: 30%" id="ID123">Karat</th>
                  <!-- <th style="width: 50%">Karat </th> -->
                  <!-- <th>Selling Price</th>
                  <th>Buying Price</th> -->
                  <th style="width: 35%" id="ID124">Sale</th>
                  <th style="width: 35%" id="ID125">Purchase Rate</th>
                </tr>
                <tr *ngFor="let krd of karatRateDetails; let id = index">
                  <td id="ID126">{{ krd.KARAT_CODE }}</td>
                  <td style="text-align: right; padding-right: 3px">
                    <input type="number" (change)="changeKaratRate($event, id)" style="text-align: right"
                      onwheel="this.blur()" [value]="krd.KARAT_RATE" class="karat_code" readonly />
                    <!-- {{ krd.KARAT_RATE }} -->
                  </td>
                  <td style="text-align: right; padding-right: 3px" id="ID127">
                    {{ krd.POPKARAT_RATE }}
                  </td>
                </tr>
              </table>
            </div>

            <div class="col-xl-12 col-md-6">
              <table class="m-t-10 rhs-table-1">
                <tr>
                  <!-- <td class="td-w-40">Amount</td> -->
                  <td class="td-w-40" id="ID128">Item Total</td>
                  <!-- <td class="td-w-40">Total Amount</td> -->
                  <td>
                    <input type="text" class="form-control textboxcorner" id value="{{
                        prnt_inv_total_gross_amt | decimalFormat : 'AMOUNT'
                      }}" aria-describedby [placeholder]="zeroAmtVal" readonly />
                  </td>
                </tr>
                <tr>
                  <td class="td-w-40" id="ID129">Tax Amount</td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id value="{{
                        this.order_items_total_tax | decimalFormat : 'AMOUNT'
                      }}" aria-describedby [placeholder]="zeroAmtVal" readonly />
                  </td>
                </tr>
                <tr>
                  <!-- <td class="td-w-40">Amount with tax</td> -->
                  <td class="td-w-40" id="ID130">Gross Total</td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id value="{{
                        order_items_total_gross_amount | decimalFormat : 'AMOUNT'
                      }}" aria-describedby [placeholder]="zeroAmtVal" readonly />
                  </td>
                </tr>
                <tr>
                  <td class="td-w-40" style="background: #adacab" id="ID131">
                    Sales Return
                  </td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id value="{{
                        invReturnSalesTotalNetTotal | decimalFormat : 'AMOUNT'
                      }}" aria-describedby [placeholder]="zeroAmtVal" readonly />
                  </td>
                </tr>
                <tr>
                  <td class="td-w-40" style="background: #adacab" id="ID132">Exchange</td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id value="{{
                        order_total_exchange | decimalFormat : 'AMOUNT'
                      }}" aria-describedby [placeholder]="zeroAmtVal" readonly />
                  </td>
                </tr>
                <tr>
                  <td class="td-w-40" style="background-color: #1a61a9; color: #fff">
                    <b id="ID133">Roundoff Discount</b>
                  </td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id="discountInput"
                      [(ngModel)]="order_items_total_discount_amount" (focus)="clearField()"
                      (blur)="order_items_total_discount_amount = formatValue(order_items_total_discount_amount)"
                      (change)="changeFinalDiscount($event)" aria-describedby="helpId" [placeholder]="zeroAmtVal"
                      [readonly]="viewOnly||isNoDiscountAllowed">

                  </td>

                </tr>
                <tr>
                  <td class="td-w-40" style="background-color: #1a61a9; color: #fff">
                    <b id="ID134">Net Amount</b>
                  </td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id value="{{
                      netTotal | decimalFormat : 'AMOUNT'
                      }}" aria-describedby [placeholder]="zeroAmtVal" readonly />
                  </td>
                </tr>

                <tr>
                  <td class="td-w-40" style="background-color: #1a61a9; color: #fff">
                    <b id="ID135">Receipt Total</b>
                    <!-- <b>Received</b> -->
                  </td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id [(ngModel)]="receiptTotalNetAmt"
                      aria-describedby [placeholder]="zeroAmtVal" readonly AmountDecimalInput />
                    <!-- <input type="text" class="form-control textboxcorner" id="" [(ngModel)]="order_received_amount"
                        value="{{ order_received_amount }}" aria-describedby="" [placeholder]="zeroAmtVal" readonly /> -->
                  </td>
                </tr>

                <tr>
                  <td class="td-w-40" style="background-color: #1a61a9; color: #fff">
                    <b id="ID136">VAT Round Off</b>
                  </td>
                  <td>
                    <input type="text" class="form-control textboxcorner" id="vatroundoff" [(ngModel)]="vatRoundOffAmt"
                      aria-describedby [placeholder]="zeroAmtVal" readonly />
                    <!-- <input type="text" class="form-control textboxcorner" id="" [(ngModel)]="order_received_amount"
                        value="{{ order_received_amount }}" aria-describedby="" [placeholder]="zeroAmtVal" readonly /> -->
                  </td>
                </tr>
              </table>
            </div>
          </div>

          <div class="row m-t-10 m-b-10">

            <div class="col-md-6 col-xl-6" (click)="viewOnly || isSaved ? '' : saveOrder()" *ngIf="!viewOnly">
              <div class="touch-big-button touch-big-button-black">
                <div class="touch-big-button-inner">
                  <i class="fa fa-save"></i> <span id="ID137"> Save Bill</span>
                </div>
              </div>
            </div>

            <!-- <div *ngIf="this.viewOnly||isPrintingEnabled"
              class="col-md-6 col-xl-6" (click)="printInvoice()">
              <div class="touch-big-button">
                <div class="touch-big-button-inner">
                  <i class="fa fa-print"></i> <span> Print Bill</span>
                </div>
              </div>
            </div>
            -->
            <div class="col-md-6 col-xl-6 " (click)="viewOnly || isSaved ? '' : saveOrder('continue')"
              *ngIf="!viewOnly">
              <div class="touch-big-button touch-big-button-black">
                <div class="touch-big-button-inner">
                  <i class="fa fa-save"></i> <span id="ID138"> Save & Continue</span>
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-2">
            <div class="col-md-6 col-xl-6" *ngIf="this.viewOnly||isPrintingEnabled" (click)="auditTrailClick()">
              <div class="touch-big-button touch-big-button-black">
                <div class="touch-big-button-inner">
                  <i class="fa fa-book"></i>
                  <span id="ID139"> Audit Trail</span>
                </div>
              </div>
            </div>

            <div class="col-md-6 col-xl-6" *ngIf="!viewOnly" (click)="cancelBill()">
              <div class="touch-big-button">
                <div class="touch-big-button-inner">
                  <i class="fa fa-window-close"></i> <span id="ID140"> Cancel Bill</span>
                </div>
              </div>
            </div>
          </div>
          <div class="row mt-2" *ngIf="this.viewOnly||isPrintingEnabled">

            <div class="col-md-6 col-xl-6" (click)="printReceiptDetailsWeb()">
              <!-- *ngIf="!viewOnly" -->
              <div class="touch-big-button">
                <div class="touch-big-button-inner">
                  <i class="fa fa-print"></i> <span id="ID141"> Print Bill</span>
                </div>
              </div>
            </div>


            <!-- <div class="col-md-12 col-xl-12" (click)="exportPdf()">
              <div class="touch-big-button">
                <div class="touch-big-button-inner">
                  <i class="fa fa-window-close"></i> <span> Export to PDF</span>
                </div>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #sales_payment_modal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Payments</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="modal-body">
    <mat-tab-group [(selectedIndex)]="selectedTabIndex" (selectedTabChange)="setTabByIndex($event.index)">
      <mat-tab label="CASH RECEIPT" [disabled]="!this.receiptModesList?.BTN_CASH || viewOnly">
        <form [formGroup]="cashreceiptForm" novalidate>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID142">Receipt Mode </mat-label>
                  <input type="text" matInput formControlName="paymentsCash" [matAutocomplete]="receiptmode"
                    [readonly]="viewOnly" />
                  <mat-autocomplete #receiptmode="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="let option of receiptModeOptions_Cash | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      cashreceiptForm.controls.paymentsCash.hasError('required')
                    " id="ID143">
                    Receipt Mode is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID144">Amount LC</mat-label>
                  <input type="text" class="st_txt_right" matInput formControlName="cashAmtLC" id="cashAmtLC"
                    [placeholder]="zeroAmtVal" readonly AmountDecimalInput />
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID145">Amount FC</mat-label>
                  <input type="text" class="st_txt_right" matInput formControlName="cashAmtFC" id="cashAmtFC"
                    (focusout)="
                    changeReceiptAmtFC($event, 'cashreceiptForm', 'cashAmtLC')
                  " [placeholder]="zeroAmtVal" AmountDecimalInput [readonly]="viewOnly" />
                  <mat-error *ngIf="
                      cashreceiptForm.controls.cashAmtFC.hasError('required')
                    " id="ID146">
                    Amount FC is <strong>required</strong>
                  </mat-error>
                  <mat-error *ngIf="cashreceiptForm.controls.cashAmtFC.hasError('min')" id="ID147">
                    Amount FC is should Not Be Zero
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>
          <!-- <div class="row pos_sales_payment_border m-1">
              <div class="col-md-12">
                <div class="form-group row"> -->

          <!-- </div>
              </div>
            </div> -->
        </form>
      </mat-tab>

      <mat-tab label="CREDIT CARD" [disabled]="!this.receiptModesList?.BTN_CREDITCARD || viewOnly">
        <form [formGroup]="creditCardReceiptForm" novalidate>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID148">Receipt Mode </mat-label>
                  <input type="text" matInput formControlName="paymentsCreditCard" [matAutocomplete]="receiptmodecc"
                    [readonly]="viewOnly" />
                  <mat-autocomplete #receiptmodecc="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="let option of receiptModeOptions_CC | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      creditCardReceiptForm.controls.paymentsCreditCard.hasError(
                        'required'
                      )
                    " id="ID149">
                    Receipt Mode is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID150">CC No.</mat-label>
                  <input type="number" matInput formControlName="cardCCNo" id="cardCCNo" maxlength="19"
                    [readonly]="viewOnly" />
                  <mat-error *ngIf="
                      creditCardReceiptForm.controls.cardCCNo.hasError(
                        'required'
                      )
                    " id="ID151">
                    CC No. is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID152">Amount </mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="cardAmtFC" id="cardAmtFC"
                    placeholder="0.00" [readonly]="viewOnly" />
                  <mat-error *ngIf="
                      creditCardReceiptForm.controls.cardAmtFC.hasError(
                        'required'
                      )
                    " id="ID153">
                    Amount is <strong>required</strong>
                  </mat-error>
                  <mat-error *ngIf="
                      creditCardReceiptForm.controls.cardAmtFC.hasError('min')
                    " id="ID154">
                    Amount is should Not Be Zero
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>
        </form>
      </mat-tab>

      <mat-tab label="ADVANCE" [disabled]="!this.receiptModesList?.BTN_ADVANCE || viewOnly">
        <form [formGroup]="advanceReceiptForm" novalidate>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID142">Receipt Mode </mat-label>
                  <input type="text" matInput formControlName="paymentsAdvance" id="paymentsAdvance"
                    [matAutocomplete]="paymentsAdvance" [readonly]="viewOnly" />
                  <mat-autocomplete #paymentsAdvance="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="let option of receiptModeAdvanceOthers | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      advanceReceiptForm.controls.paymentsAdvance.hasError(
                        'required'
                      )
                    " id="ID143">
                    Receipt Mode is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field class="example-full-width">
                  <mat-label id="ID155">Branch</mat-label>
                  <input type="text" matInput formControlName="advanceBranch" [matAutocomplete]="advanceBranch"
                    id="advanceBranch" (focusout)="changeBranch($event)" [readonly]="viewOnly" />
                  <mat-autocomplete #advanceBranch="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="
                        let option of filteredAdvanceBranchOptions | async
                      " [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      advanceReceiptForm.controls.advanceBranch.hasError(
                        'required'
                      )
                    " id="ID156">
                    Branch is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID157">Year</mat-label>
                  <input matInput type="text" id="advanceYear" formControlName="advanceYear" id="advanceYear"
                    [matAutocomplete]="advanceYear" [readonly]="viewOnly" />
                  <mat-autocomplete #advanceYear="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="let option of filteredadvanceYear | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      advanceReceiptForm.controls.advanceYear.hasError(
                        'required'
                      )
                    " id="ID158">
                    Year is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID159">Rec No.</mat-label>
                  <input type="text" matInput formControlName="advanceRecNo" value="" id="advanceRecNo"
                    (change)="changeAdvanceVocNo($event)" [readonly]="viewOnly" />

                  <mat-error *ngIf="
                      advanceReceiptForm.controls.advanceRecNo.hasError(
                        'required'
                      )
                    " id="ID160">
                    Rec No. is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID161">Amount</mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="advanceAmount" id="advanceAmount"
                    [readonly]="viewOnly" />
                  <mat-error *ngIf="
                      advanceReceiptForm.controls.advanceAmount.hasError(
                        'required'
                      )
                    " id="ID162">
                    Amount is <strong>required</strong>
                  </mat-error>
                  <mat-error *ngIf="
                      advanceReceiptForm.controls.advanceAmount.hasError('min')
                    " id="ID163">
                    Amount is should Not Be Zero
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID164">Vat Amount Paid LC</mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="advanceVatAmountLC"
                    id="advanceVatAmountLC" placeholder="0.00" readonly />
                </mat-form-field>
              </div>
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID165">Vat Amount Paid FC</mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="advanceVatAmountFC"
                    id="advanceVatAmountFC" placeholder="0.00" readonly />
                </mat-form-field>
              </div>
            </div>
          </div>
        </form>
      </mat-tab>

      <mat-tab label="OTHERS" [disabled]="!this.receiptModesList?.BTN_OTHERS || viewOnly">
        <form [formGroup]="othersReceiptForm" novalidate>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID148">Receipt Mode </mat-label>
                  <input type="text" matInput formControlName="paymentsOthers" id="paymentsOthers"
                    [matAutocomplete]="receiptmodeOthers" [readonly]="viewOnly" />
                  <mat-autocomplete #receiptmodeOthers="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="let option of receiptModeOptionsOthers | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      othersReceiptForm.controls.paymentsOthers.hasError(
                        'required'
                      )
                    " id="ID149">
                    Receipt Mode is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID161">Amount</mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="othersAmtFC" id="othersAmtFC"
                    placeholder="0.00" [readonly]="viewOnly" />
                  <mat-error *ngIf="
                      othersReceiptForm.controls.othersAmtFC.hasError(
                        'required'
                      )
                    " id="ID162">
                    Amount is <strong>required</strong>
                  </mat-error>
                  <mat-error *ngIf="
                      othersReceiptForm.controls.othersAmtFC.hasError('min')
                    " id="ID166">
                    Amount is should be Greater than Zero
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>
        </form>
      </mat-tab>
      <mat-tab label="GIFT. VOC" [disabled]="!this.receiptModesList?.BTN_GIFT || viewOnly">
        <form [formGroup]="giftReceiptForm" novalidate>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID148">Receipt Mode </mat-label>
                  <input type="text" matInput formControlName="paymentsCreditGIftVoc" id="paymentsCreditGIftVoc"
                    [matAutocomplete]="paymentsCreditGIftVoc" [readonly]="viewOnly" />
                  <mat-autocomplete #paymentsCreditGIftVoc="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="let option of receiptModeGiftOptions | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      giftReceiptForm.controls.paymentsCreditGIftVoc.hasError(
                        'required'
                      )
                    " id="ID149">
                    Receipt Mode <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-6">
                <mat-form-field class="example-full-width">
                  <mat-label id="ID155">Branch</mat-label>
                  <input type="text" matInput formControlName="giftBranch" [matAutocomplete]="giftBranch"
                    id="giftBranch" (focusout)="changeBranch($event)" [readonly]="viewOnly" />
                  <mat-autocomplete #giftBranch="matAutocomplete" autoActiveFirstOption>
                    <mat-option *ngFor="
                        let option of filteredGiftModeBranchOptions | async
                      " [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      giftReceiptForm.controls.giftBranch.hasError('required')
                    " id="ID156">
                    Branch is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID167">Voc No.</mat-label>
                  <input type="text" matInput formControlName="giftVocNo" value="" id="giftVocNo"
                    [readonly]="viewOnly" />
                  <mat-error *ngIf="
                      giftReceiptForm.controls.giftVocNo.hasError('required')
                    " id="ID168">
                    Voc No. is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-6">
                <mat-form-field>
                  <mat-label id="ID161">Amount</mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="giftAmtFC" id="giftAmtFC"
                    placeholder="0.00" [readonly]="viewOnly" />
                  <mat-error *ngIf="
                      giftReceiptForm.controls.giftAmtFC.hasError('required')
                    " id="ID162">
                    Amount is <strong>required</strong>
                  </mat-error>
                  <mat-error *ngIf="giftReceiptForm.controls.giftAmtFC.hasError('min')" id="ID166">
                    Amount is should be Greater than Zero
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </div>
        </form>
      </mat-tab>
      <mat-tab label="CUSTOMERS" [disabled]="!this.receiptModesList?.BTN_CUSTOMER || viewOnly">
        <form [formGroup]="customerReceiptForm" novalidate>
          <div class="col-md-12" style="margin-top: 20px; margin-bottom: 20px">
            <div class="form-group row">
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID169">Select Accode</mat-label>
                  <input type="text" matInput formControlName="customAcCodeList" [matAutocomplete]="customAcCodeList"
                    id="customAcCodeList" [readonly]="viewOnly" />
                  <mat-autocomplete #customAcCodeList="matAutocomplete" autoActiveFirstOption
                    (optionSelected)="changeCustAcCode($event.option.value)">
                    <mat-option *ngFor="let option of customAcCodeListOptions | async" [value]="option.CODE">
                      {{ option.CODE + " - " + option.DESCRIPTION }}
                    </mat-option>
                  </mat-autocomplete>
                  <mat-error *ngIf="
                      customerReceiptForm.controls.customAcCodeList.hasError(
                        'required'
                      )
                    " id="ID170">
                    Accode is <strong>required</strong>
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID144">Amount LC</mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="customerAmtLC" id="customerAmtLC"
                    placeholder="0.00" readonly />
                </mat-form-field>
              </div>
              <div class="col-md-4">
                <mat-form-field>
                  <mat-label id="ID145">Amount FC</mat-label>
                  <input type="number" class="st_txt_right" matInput formControlName="customerAmtFC" id="customerAmtFC"
                    (focusout)="
                      changeReceiptAmtFC(
                        $event,
                        'customerReceiptForm',
                        'customerAmtLC'
                      )
                    " placeholder="0.00" [readonly]="viewOnly" />

                  <mat-error *ngIf="
                      customerReceiptForm.controls.customerAmtFC.hasError(
                        'required'
                      )
                    " id="ID146">
                    Amount FC is <strong>required</strong>
                  </mat-error>
                  <mat-error *ngIf="
                      customerReceiptForm.controls.customerAmtFC.hasError('min')
                    " id="ID171">
                    Amount FC is should be Greater than Zero
                  </mat-error>
                </mat-form-field>
              </div>
              <!-- <div class="col">
                  <mat-form-field>
                    <mat-label>Accode</mat-label>
                    <input type="text" matInput formControlName="customerAccode" id="customerAccode" readonly />
                  </mat-form-field>
                </div> -->
            </div>
          </div>
        </form>
      </mat-tab>
    </mat-tab-group>

    <div style="padding-bottom: 20px">
      <div style="text-align: right; padding: 10px">
        <button *ngIf="!viewOnly" class="btn btn-secondary btn-m-r-10" [disabled]="viewOnly"
          (click)="saveReceipt('Continue')" id="ID172">
          Continue
        </button>
        <button *ngIf="!viewOnly" class="btn btn-primary btn-m-r-10" [disabled]="viewOnly" (click)="saveReceipt()" id="ID173">
          SAVE
        </button>
        <button class="btn btn-danger" #closeModalButton (click)="modal.dismiss('Cross click')" id="ID174">
          CLOSE
        </button>
        &nbsp;
      </div>
    </div>
  </div>
</ng-template>

<ng-template #oldgoldmodal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Exchange</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <form [formGroup]="exchangeForm">
        <div class="col-md-12">
          <div class="bg-gray-card">
            <div class="form-group row">
              <div class="col-md-2">
                <mat-form-field>
                  <mat-label id="ID175">Division</mat-label>
                  <input type="text" matInput formControlName="fcn_exchange_division" readonly />
                </mat-form-field>
              </div>
              <div class="col-md-3">
                <mat-form-field>
                  <mat-label id="ID176">Stock Code</mat-label>
                  <input type="text" matInput formControlName="fcn_exchange_item_code" id="fcn_exchange_item_code"
                    [matAutocomplete]="stockId" [readonly]="viewOnly" (change)="exchangeStockCode($event)" />
                  <mat-autocomplete #stockId="matAutocomplete" (optionSelected)="getStockforExchange()"
                    autoActiveFirstOption>
                    <mat-option *ngFor="let option of exStockCodeFilteredOptions | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete>

                  <!-- <input type="text" matInput formControlName="fcn_customer_id_type" [matAutocomplete]="idtype"
                    [readonly]="viewOnly" />
                  <mat-autocomplete #idtype="matAutocomplete" (optionSelected)="changeIdtype($event.option.value)"
                    autoActiveFirstOption>
                    <mat-option *ngFor="let option of idTypeFilteredOptions | async" [value]="option">
                      {{ option }}
                    </mat-option>
                  </mat-autocomplete> -->
                </mat-form-field>

                <!--<mat-form-field>
                                      <mat-label>Stock Code</mat-label>
                                      <input type="text" matInput formControlName="fcn_exchange_item_code" (focusout)="getStockforExchange()">
                                  </mat-form-field>-->
              </div>
              <div class="col-md-7">
                <mat-form-field>
                  <mat-label id="ID177">Item Description </mat-label>
                  <input type="text" matInput formControlName="fcn_exchange_item_desc" readonly />
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="form-group row">
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID178">Pcs </mat-label>
                <!-- oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" -->
                <input type="number" class="text-right" [min]="0" [maxLength]="8"
                  (keyup)="this.comFunc.enforceMinMax($event.target)" matInput formControlName="fcn_exchange_pcs"
                  [readonly]="viewOnly" />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID179">Gross Wt</mat-label>
                <input type="number" [min]="0" [maxLength]="10" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" id="fcn_exchange_gross_wt" matInput formControlName="fcn_exchange_gross_wt"
                  (focusout)="getExchangeNwtWt($event)" [readonly]="viewOnly" MetalDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID180">Stone Wt</mat-label>
                <input type="text" [min]="0" [maxLength]="10" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  [max]="this.comFunc.emptyToZero(this.exchangeForm.value.fcn_exchange_gross_wt)" class="st_txt_right"
                  matInput formControlName="fcn_exchange_stone_wt" (change)="changeExchangeStoneWt($event)"
                  id="fcn_exchange_stone_wt" readonly StoneDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID181">Net Wt </mat-label>
                <input type="text" [min]="0" [maxLength]="10" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput formControlName="fcn_exchange_net_wt" readonly id="fcn_exchange_net_wt"
                  [max]="this.comFunc.emptyToZero(this.exchangeForm.value.fcn_exchange_gross_wt)"
                  (change)="changeExchangeNettWt($event)" MetalDecimalInput />
              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="form-group row">
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID182">Chargable Wt </mat-label>
                <input type="text" [min]="0" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput formControlName="fcn_exchange_chargeable_wt" readonly
                  id="fcn_exchange_chargeable_wt"
                  [max]="this.comFunc.emptyToZero(this.exchangeForm.value.fcn_exchange_gross_wt)" MetalDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID183">Purity </mat-label>
                <input type="number" [min]="this._exchangeItemchange?.PURITY_FROM || 0"
                  [max]="this._exchangeItemchange?.PURITY_TO" [step]="0.01" [maxLength]="14"
                  (change)="changeExPurity($event)" class="st_txt_right" matInput formControlName="fcn_exchange_purity"
                  [readonly]="viewOnly" id="fcn_exchange_purity" />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID184">Pure Weight</mat-label>
                <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                  (change)="this.comFunc.enforceMinMax($event.target)" matInput
                  formControlName="fcn_exchange_pure_weight" id="fcn_exchange_pure_weight" readonly MetalDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID185">Purity Difference</mat-label>
                <input type="text" [min]="0" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput formControlName="fcn_exchange_purity_diff" readonly MetalDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID186">Stone Rate</mat-label>
                <input [min]="0" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput readonly formControlName="fcn_exchange_stone_rate"
                  id="fcn_exchange_stone_rate" (change)="changeExchangeStoneRate($event)" AmountDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID187">Stone Amount</mat-label>
                <input [min]="0" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)" [min]="0"
                  class="st_txt_right" matInput formControlName="fcn_exchange_stone_amount"
                  id="fcn_exchange_stone_amount" (change)="changeExStoneAmount($event)" readonly AmountDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID188">Metal Rate </mat-label>
                <input type="text" [min]="0" [maxLength]="14" (change)="metalRateChange()"
                  (keyup)="this.comFunc.enforceMinMax($event.target)" class="st_txt_right" matInput
                  formControlName="fcn_exchange_metal_rate" readonly />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID189">Making Rate </mat-label>
                <input [min]="0" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput formControlName="fcn_exchange_making_rate" readonly
                  (change)="changeExMakingRate($event)" AmountDecimalInput />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID190">Making Amount </mat-label>
                <input type="number" [min]="0" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput formControlName="fcn_exchange_making_amt" [readonly]="true" />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID191">Metal Amount</mat-label>
                <input type="text" AmountDecimalInput [max]="14" class="st_txt_right" matInput
                  formControlName="fcn_exchange_metal_amount" (change)="changeExchangeMetalAmt($event)"
                  [readonly]="viewOnly" />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID192">Net Amount</mat-label>
                <input type="text" AmountDecimalInput [max]="14" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput formControlName="fcn_exchange_net_amount" [readonly]="true"
                  (change)="changeExNetAmt($event)" />
              </mat-form-field>
            </div>
            <!-- <div class="col-md-3">
              <mat-form-field>
                <mat-label>Net Amount</mat-label>
                <input [min]="0" type="number" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)"
                  class="st_txt_right" matInput formControlName="fcn_exchange_net_amount" [readonly]="true"
                  (change)="changeExNetAmt($event)" AmountDecimalInput />
              </mat-form-field>
            </div> -->
          </div>
        </div>
      </form>
      <!--<div class="col-md-12">
                  <div class="form-group row" style="padding:0px 0px 0px 10px;">
                      <div class="font-weight-bold col-form-label  col-12" style="background-color: #efefef;">Wastage
                      </div>
                      <table class="table">
                          <tbody>
                              <tr>
                                  <td> % </td>
                                  <td> Quantity </td>
                                  <td> Amount </td>
                              </tr>
                              <tr>
                                  <td> <input type="email" class="form-control textboxcorner col-xs-6 col-sm-6 col-md-6 col-lg-6" id="vat_per" value="" placeholder="" /></td>
                                  <td> <input type="email" class="form-control textboxcorner col-xs-6 col-sm-6 col-md-6 col-lg-6" id="vat_per" value="" placeholder="" /></td>
                                  <td> <input type="email" class="form-control textboxcorner col-xs-6 col-sm-6 col-md-6 col-lg-6" id="vat_per" value="" placeholder="" /></td>
                              </tr>
                          </tbody>
                      </table>
                  </div>
              </div>-->
    </div>

    <div style="padding-bottom: 20px">
      <div style="text-align: right; padding: 10px">
        <button mat-flat-button color="accent" (click)="addItemtoExchange('continueBtn')" [disabled]="viewOnly" id="ID172">
          CONTINUE
        </button>
        &nbsp;
        <button mat-flat-button class="bgColourUpdate" (click)="addItemtoExchange('saveBtn')" [disabled]="viewOnly" id="ID173">
          SAVE
        </button>
        &nbsp;
        <button mat-flat-button color="warn" (click)="modal.dismiss('Cross click')" id="ID193">
          CANCEL
        </button>
        &nbsp;
      </div>
    </div>

  </div>
</ng-template>

<ng-template #adjust_sale_return_modal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal">Sales Return</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="container row">
      <div class="col-md-12">
        <form [formGroup]="salesReturnForm">
          <div class="form-group row">
            <div class="col-md-3">
              <!-- <mat-form-field>
                  <mat-label>Fin Year</mat-label>
                  <input type="text" matInput formControlName="fcn_returns_fin_year" id="fcn_returns_fin_year"
                    value="{{ fcn_returns_fin_year_val }}" [readonly]="viewOnly" />
                </mat-form-field> -->
              <mat-form-field>
                <mat-label id="">Fin Year</mat-label>
                <input matInput type="text" id="fcn_returns_fin_year" formControlName="fcn_returns_fin_year"
                  [matAutocomplete]="year" />
                <mat-autocomplete #year="matAutocomplete" autoActiveFirstOption>
                  <mat-option *ngFor="let option of filteredOptions_year | async" [value]="option">
                    {{ option }}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <!-- <mat-form-field>
                  <mat-label>Branch </mat-label>
                  <input type="text" matInput formControlName="fcn_returns_branch" value="{{ fcn_returns_branch_val }}" />
                </mat-form-field> -->
              <mat-form-field class="example-full-width">
                <mat-label id="ID155">Branch</mat-label>
                <input type="text" matInput formControlName="fcn_returns_branch" [matAutocomplete]="branch"
                  (focusout)="changeBranch($event)" [readonly]="viewOnly" />
                <mat-autocomplete #branch="matAutocomplete" autoActiveFirstOption>
                  <mat-option *ngFor="
                      let option of filteredSalesReturnBranchOptions | async
                    " [value]="option">
                    {{ option }}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
            </div>



            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID195">Voc Type</mat-label>
                <mat-select formControlName="fcn_returns_voc_type" [disabled]="viewOnly">
                  <mat-option *ngFor="let voctype of vocTypesinSalesReturn" [value]="voctype.VOCTYPE">
                    {{ voctype.VOCTYPE }}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="
                    salesReturnForm.controls.fcn_returns_voc_type.hasError(
                      'required'
                    )
                  " id="ID196">
                  VOC Type is <strong>required</strong>
                </mat-error>
              </mat-form-field>


            </div>







            <div class="col-md-2">
              <mat-form-field>
                <mat-label id="ID167">Voc No</mat-label>
                <input type="text" matInput formControlName="fcn_returns_voc_no"
                  (change)="getRetailSReturn_EvnFn($event)"
                  [readonly]="viewOnly || this.sales_returns_items.length > 0" />
              </mat-form-field>
            </div>
            <div class="col-md-1 text-right" style="margin-top: 7px">
              <button (click)="searchVocNoSalRet()" class="btn btn-secondary btn-m-r-10" [disabled]="viewOnly">
                <i class="fa fa-search"></i>
              </button>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID197">Voc Date</mat-label>
                <input type="text" matInput formControlName="fcn_returns_voc_date" [readonly]="viewOnly" />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID198">Salesman</mat-label>
                <input type="text" matInput formControlName="fcn_returns_sales_man"
                  value="{{ fcn_returns_sales_man_val }}" [readonly]="viewOnly" />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID199">Cust Code</mat-label>
                <input type="text" matInput formControlName="fcn_returns_cust_code"
                  value="{{ fcn_returns_cust_code_val }}" [readonly]="viewOnly" />
              </mat-form-field>
            </div>
            <div class="col-md-3">
              <mat-form-field>
                <mat-label id="ID200">Cust Mobile</mat-label>
                <input type="number" oninput="validity.valid||(value='');" matInput
                  formControlName="fcn_returns_cust_mobile" value="{{ fcn_returns_cust_mobile_val }}"
                  [readonly]="viewOnly" />
              </mat-form-field>
            </div>
          </div>
        </form>
      </div>

      <div class="col-md-12">
        <table class="container table table-responsive table-striped" id="adjustsalesreturn_table">
          <tbody>
            <tr>
              <th style="text-align: center" id="ID175">Division</th>
              <th id="ID201">Item Code</th>
              <th id="ID202">Item Desc</th>
              <th id="ID203">Gross Weight</th>
              <th id="ID204">VAT Amount</th>
              <th id="ID161">Amount</th>
              <th id="ID205">Select</th>
            </tr>

            <tr *ngFor="let slsReturn of salesReturnsItems_forVoc; let id = index"
              (dblclick)="changeRetailSalesReturnVal(slsReturn)" class="sales-return-row">
              <td style="text-align: center" id="ID206">{{ slsReturn.DIVISION_CODE }}</td>
              <td id="ID207">{{ slsReturn.STOCK_CODE }}</td>
              <td id="ID208">{{ slsReturn.STOCK_DOCDESC }}</td>
              <td style="text-align: center" id="ID209">
                {{ slsReturn.GROSSWT | decimalFormat : "METAL" }}
              </td>
              <td style="text-align: right" id="ID210">
                {{ slsReturn.TOTALWITHVATLC | decimalFormat : "AMOUNT" }}
              </td>
              <td style="text-align: center">
                <input [disabled]="viewOnly" type="checkbox" value="{{ slsReturn.STOCK_CODE }}" [readonly]="viewOnly"
                  [checked]="
                  checkSelectedVal(
                    slsReturn.STOCK_CODE,
                    slsReturn.TOTALWITHVATLC,
                    slsReturn.SRNO
                  )
                " (change)="addSalesReturnOnSelect($event, slsReturn, id)" />
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="col-md-12 text-right">
        <div id="ID211">
          Total : {{ sales_returns_total_amt | decimalFormat : "AMOUNT" }}
        </div>
      </div>

      <div style="text-align: right; padding: 10px">
        <button mat-flat-button class="btn-m-r-10 bgColourUpdate" (click)="addItemtoSalesReturn()"
          [disabled]="viewOnly" id="ID173">
          SAVE
        </button>
        <button mat-flat-button color="warn" (click)="modal.dismiss('Cross click')" id="ID193">
          CANCEL
        </button>
        &nbsp;
      </div>

    </div>
  </div>
</ng-template>

<ng-template #more_customer_detail_modal let-modal modal-lg>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-pos-metal" *ngIf="
        customerDataForm.value.fcn_customer_code !== null &&
        customerDataForm.value.fcn_customer_code !== undefined &&
        customerDataForm.value.fcn_customer_code !== ''
      " id="ID212">
      Customer Details ({{ customerDataForm.value.fcn_customer_code }})
    </h4>
    <h4 class="modal-title" id="modal-pos-metal" *ngIf="
        customerDataForm.value.fcn_customer_code === null ||
        customerDataForm.value.fcn_customer_code === undefined ||
        customerDataForm.value.fcn_customer_code === ''
      " id="ID213">
      Customer Details
    </h4>

    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-md-12">
        <form [formGroup]="customerDetailForm">

          <div class="container">
            <div class="row form-group">
              <div class="col-md-3">
                <div class="form-group bg-gray-card">
                  <label class="col-form-label required" id="ID106">Code&nbsp;*</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput
                      onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                      formControlName="fcn_mob_code" id="fcn_mob_code" [matAutocomplete]="fcn_mob_code" [readonly]="viewOnly" />
                    <mat-autocomplete #fcn_mob_code="matAutocomplete" autoActiveFirstOption>
                      <mat-option *ngFor="let option of mobileCountryMasterOptions | async" [value]="option.MOBILECOUNTRYCODE">
                        {{ option.MOBILECOUNTRYCODE }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_mob_code.hasError('required')" id="ID107">
                      Code is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
          
              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID103">Name</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_customer_detail_name" id="fcn_customer_detail_name"
                      (change)="nameChange($event)" [readonly]="viewOnly" appNoEmptySpace />
                    <mat-error *ngIf="customerDetailForm.controls.fcn_customer_detail_name.hasError('required')" id="ID104">
                      Name is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_customer_detail_name.hasError('pattern')" id="ID105">
                      Whitespace Not Allowed
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
          
              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID214">First Name</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_customer_detail_fname" [readonly]="true" appNoEmptySpace />
                    <mat-error *ngIf="customerDetailForm.controls.fcn_customer_detail_fname.hasError('required')" id="ID215">
                      First Name is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
          
              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID216">Middle Name</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_customer_detail_mname" [readonly]="true" />
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID217">Last Name</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_customer_detail_lname" [readonly]="true" />
                    <mat-error *ngIf="customerDetailForm.controls.fcn_customer_detail_lname.hasError('required')" id="ID218">
                      Last Name is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_customer_detail_lname.hasError('maxlength')" id="ID219">
                      Last Name must not exceed 100 characters.
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label required" id="ID220">Mobile 1&nbsp;*</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" #mobile1 (change)="onCustomerNameFocus(mobile1.value)"
                      onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                      matInput formControlName="fcn_cust_detail_phone" id="fcn_cust_detail_phone" [readonly]="viewOnly"
                      maxlength="20" />
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_phone.hasError('required')" id="ID221">
                      Mobile Number is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
              
              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID222">Mobile 2</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text"
                      onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                      matInput formControlName="fcn_cust_detail_phone2" [readonly]="viewOnly" />
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID223">Email Address</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="email" matInput formControlName="fcn_cust_detail_email" [readonly]="viewOnly" />
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_email.hasError('email')" id="ID224">
                      Please enter a valid email address
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID225">Gender</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-select formControlName="fcn_cust_detail_gender" [disabled]="viewOnly">
                      <mat-option *ngFor="let data of genderList" [value]="data.ENGLISH">{{ data.ENGLISH }}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_gender.hasError('required')" id="ID226">
                      Gender is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID227">Marital Status</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-select formControlName="fcn_cust_detail_marital_status" [disabled]="viewOnly">
                      <mat-option *ngFor="let data of maritalStatusList" [value]="data.ENGLISH">
                        {{ data.ENGLISH}}</mat-option>
                      <mat-option value="Unknown" id="ID228">Unknown</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID229">Date Of Birth</label>
                  <mat-form-field dateFormat3 appearance="outline" class="w-100">
                    <input matInput [matDatepicker]="dob" [max]="vocMaxDate" name="fcn_cust_detail_dob"
                      formControlName="fcn_cust_detail_dob" placeholder="DD/MM/YYYY" [readonly]="viewOnly" />
                    <mat-datepicker-toggle matSuffix [for]="dob"></mat-datepicker-toggle>
                    <mat-datepicker [startAt]="currentDate" #dob></mat-datepicker>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_dob.hasError('required')" id="ID230">
                      Date of Birth is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID231">Nationality</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_cust_detail_nationality"
                      id="fcn_cust_detail_nationality" [matAutocomplete]="nationality" [readonly]="viewOnly" />
                    <mat-autocomplete #nationality="matAutocomplete" autoActiveFirstOption>
                      <mat-option *ngFor="let option of nationalityMasterOptions | async" [value]="option.CODE">
                        {{ option.CODE + " - " + option.DESCRIPTION }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_nationality.hasError('required')" id="ID232">
                      Nationality is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_nationality.hasError('notInOptions')" id="ID233">
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID234">Country</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_cust_detail_country" id="fcn_cust_detail_country"
                      [matAutocomplete]="country" [readonly]="viewOnly" />
                    <mat-autocomplete #country="matAutocomplete" autoActiveFirstOption
                      (optionSelected)="changeCountry($event.option.value)">
                      <mat-option *ngFor="let option of countryMasterOptions | async" [value]="option.CODE">
                        {{ option.CODE + " - " + option.DESCRIPTION }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_country.hasError('required')" id="ID235">
                      Country is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_country.hasError('notInOptions')" id="ID233">
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID236">State</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_cust_detail_state" id="fcn_cust_detail_state"
                      [matAutocomplete]="state" [readonly]="viewOnly" />
                    <mat-autocomplete #state="matAutocomplete" autoActiveFirstOption
                      (optionSelected)="changeState($event.option.value)">
                      <mat-option *ngFor="let option of stateMasterOptions | async" [value]="option.CODE">
                        {{ option.CODE }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_state.hasError('notInOptions')" id="ID233">
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID237">City</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <!-- <input type="text" matInput formControlName="fcn_cust_detail_city" [readonly]="viewOnly" /> -->
                    <input type="text" matInput formControlName="fcn_cust_detail_city" id="fcn_cust_detail_city"
                      [matAutocomplete]="city" [readonly]="viewOnly" />
                    <mat-autocomplete #city="matAutocomplete" autoActiveFirstOption>
                      <mat-option *ngFor="let option of cityMasterOptions | async" [value]="option.CODE">
                        {{ option.CODE }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_city.hasError('notInOptions')" id="ID233">
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID238">Address</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_cust_detail_address" [readonly]="viewOnly"
                      appNoEmptySpace />
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_address.hasError('required')" id="ID239">
                      Address is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID240">ID Type</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_cust_detail_idType" [matAutocomplete]="custIdType"
                      [readonly]="viewOnly" />
                    <mat-autocomplete #custIdType="matAutocomplete" (optionSelected)="changeIdtype($event.option.value)"
                      autoActiveFirstOption>
                      <mat-option *ngFor="let option of idTypeFilteredOptions | async" [value]="option">
                        {{ option }}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_idType.hasError('required')" id="ID241">
                      ID Type is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_idType.hasError('notInOptions')" id="ID233">
                      Invalid value
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID242">ID Number</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_cust_detail_idcard" [readonly]="viewOnly"
                      appNoEmptySpace />
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_idcard.hasError('required')" id="ID243">
                      ID Number is <strong>required</strong>
                    </mat-error>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_idcard.hasError('minlength')" id="ID244">
                      <!-- ID Card must be 15 characters long. -->
                      ID Number be at least
                      {{
                      customerDetailForm
                      .get("fcn_cust_detail_idcard")
                      ?.getError("minlength").requiredLength
                      }}
                      characters long.
                    </mat-error>
                    <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_idcard.hasError('maxlength')" id="ID245">
                      ID Number must not exceed
                      {{
                      customerDetailForm
                      .get("fcn_cust_detail_idcard")
                      ?.getError("maxlength").requiredLength
                      }}
                      characters.
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID246">Designation</label>
                   <mat-form-field appearance="outline" class="w-100">
                      <input type="text" matInput formControlName="fcn_cust_detail_designation" [readonly]="viewOnly"
                        appNoEmptySpace />
                      <mat-error *ngIf="customerDetailForm.controls.fcn_cust_detail_designation.hasError('required')" id="ID247">
                        Designation is <strong>required</strong>
                      </mat-error>
                    </mat-form-field>
                </div>
              </div>
              
              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID248">Employer</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input type="text" matInput formControlName="fcn_cust_detail_company" [readonly]="viewOnly" />
                  </mat-form-field>
                </div>
              </div>
              
              <div class="col-md-3">
                <div class="form-group">
                  <label class="col-form-label" id="ID249">Expiry Date</label>
                  <mat-form-field appearance="outline" class="w-100">
                    <input matInput [matDatepicker]="expDateCust" name="fcn_customer_exp_date"
                      formControlName="fcn_customer_exp_date" placeholder="DD/MM/YYYY" [min]="currentDate"
                      [readonly]="viewOnly" />
                    <mat-datepicker-toggle matSuffix [for]="expDateCust"></mat-datepicker-toggle>
                    <mat-datepicker [startAt]="currentDate" #expDateCust></mat-datepicker>
    
                    <mat-error *ngIf="customerDetailForm.controls.fcn_customer_exp_date.hasError('required')" id="ID250">
                      Expiry date is <strong>required</strong>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-9" style="margin-top: 2.4rem !important;">
                <div class="d-flex justify-content-end">
                  <button class="btn btn-primary btn-m-r-10 bgColourUpdate" (click)="customerSave()" *ngIf="!viewOnly"
                            [disabled]="isCustProcessing" id="ID173">
                        SAVE
                  </button>
                  <button class="btn btn-danger" (click)="modal.dismiss('Cross click')" id="ID193">
                        CANCEL
                  </button>
                </div>
              </div>
           
            </div>
          </div>

        </form>
      </div>

   
    </div>
  </div>
</ng-template>

<ng-template #mymodal let-modal>
  <div class="modal-header" style="padding: 10px 20px">
    <h4 class="modal-title" id="modal-dia-metal">
      Item Details
    </h4>
    <button style="border: none" type="button" *ngIf="!updateBtn" class="close" aria-label="Close"
      (click)="closeItemModal()">
      <span aria-hidden="true">x</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="lineItemForm">

      <!-- <mat-tab-group> -->
      <!-- <mat-tab label="ITEM DETAILS"> -->
      <div class="row" style="padding-top: 15px">
        <div class="errormsg col-md-12" id="modelerrmsg">
          <!-- {{ pos_div_modelerrmsg }} -->
        </div>
        <span>
          <div class="col-md-12">
            <div class="bg-gray-card">
              <div class="form-group row">
                <div class="container">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="bg-gray-card">
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group row">
                              <label class="col-form-label col-sm-4" id="ID175">Division&nbsp;*</label>
                              <div class="col-sm-7">
                                <mat-form-field appearance="outline">
                                  <input type="text" matInput formControlName="fcn_li_division" id="fcn_li_division" readonly />
                                </mat-form-field>
                                 <!-- <master-search [MasterSearchData]="divisionCodeData"
                                      (newRowClick)="divisionCodeSelected($event)">>
                                      </master-search> -->
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group row">
                              <label class="col-sm-4" id="ID201">Item Code&nbsp;*</label>
                              <div class="col-sm-8">
                                <mat-form-field appearance="outline">
                                  <input type="text" matInput autocomplete="off" formControlName="fcn_li_item_code"
                                    #fcn_li_item_code id="fcn_li_item_code" autofocus (change)="getStockDesc($event)"
                                    [readonly]="viewOnly" />
                                </mat-form-field>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="bg-gray-card">
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group row">
                              <label class="col-sm-4" id="ID251">Item Description&nbsp;*</label>
                              <div class="col-sm-8">
                                <mat-form-field appearance="outline">
                                  <input type="text" matInput formControlName="fcn_li_item_desc" id="fcn_li_item_desc"
                                    [readonly]="viewOnly || !this.newLineItem.ALLOWEDITDESCRIPTION" />
                                </mat-form-field>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group row">
                              <label class="col-sm-4 mt-2" id="ID252">Location&nbsp;*</label>
                              <div class="col-sm-8">
                                <mat-form-field appearance="outline">
                                  <input type="text" matInput formControlName="fcn_li_location" id="fcn_li_location"
                                    [readonly]="viewOnly" />
                                </mat-form-field>
                              </div>
                            </div>
                          </div>

                          <div class="col-md-2">
                            <app-qrcode-scanner *ngIf="scannerVisible" (qrcodeDetected)="onQrcodeDetected($event)"
                              (closeRequested)="onCloseRequested()"></app-qrcode-scanner>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6">
                <div class="form-group row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4 mt-2" id="ID253">PCs&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="number" [min]="0" autocomplete="off" [maxLength]="14"
                          (keyup)="this.comFunc.enforceMinMax($event.target)" matInput id="fcn_li_pcs"
                          formControlName="fcn_li_pcs" (change)="changePCS($event)" [readonly]="viewOnly" NumberOnly />
                          <!-- <input class="st_txt_right" type="number" min="1" matInput formControlName="fcn_li_pcs"
                                  (keyup)="changePCS($event)" (mouseup)="changePCS($event)" (mouseleave)="changePCS($event)"
                                  value="{{li_pcs_val}}"> -->
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_pcs.hasError('required')" id="ID254">
                            PCS is <strong>required</strong>
                          </mat-error>
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_pcs.hasError('min')" id="ID255">
                            {{ "PCS should Not Be Zero" }}
                            <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4 mt-2" id="ID256">{{
                        newDictionary?.lblGrossWeight || "Gross Wt"}}&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <!-- <mat-label>{{newDictionary?.lblGrossWeight}}</mat-label> -->
                          <input class="st_txt_right" [maxLength]="14" type="text" [min]="0"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput formControlName="fcn_li_gross_wt"
                            id="fcn_li_gross_wt" (focusout)="setGrossWtFocus()" (change)="changeGrossWt($event)"
                            [readonly]="viewOnly" MetalDecimalInput />
                          <mat-error *ngIf="
                                  lineItemForm.controls.fcn_li_gross_wt.hasError('required')" id="ID257">
                            Gross Weight is <strong>required</strong>
                          </mat-error>
                          <mat-error *ngIf="
                            lineItemForm.controls.fcn_li_gross_wt.hasError('min')" id="ID258">
                            {{ this.comFunc.getMsgByID("MSG1306") }}
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form-group row mt-3">
                  <div class="col-md-6" *ngIf="this.divisionMS == 'S' ? false : true">
                    <div class="form-group row">
                      <label class="col-sm-4 mt-2" id="ID259" >
                        {{newDictionary?.lblStoneWeight || "Stone Wt"}}&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput formControlName="fcn_li_stone_wt"
                            id="fcn_li_stone_wt" (change)="changeStoneWt($event)" [readonly]="!isStoneIncluded"
                            MetalDecimalInput />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6" *ngIf="this.divisionMS == 'S' ? false : true">
                    <div class="form-group row">
                      <label class="col-sm-4 mt-2" id="ID260">
                        Net Wt&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input type="text" class="st_txt_right" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)"
                            max="{{ this.comFunc.emptyToZero(this.lineItemForm.value.fcn_li_gross_wt) }}" matInput
                            formControlName="fcn_li_net_wt" id="fcn_li_net_wt" (focusout)="changeNettWt($event)" readonly
                            MetalDecimalInput />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>
                
               






                <div class="form-group row" *ngIf="this.divisionMS == 'M'">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3" id="ID261">Purity&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input type="number" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" class="st_txt_right" matInput
                            formControlName="fcn_li_purity" id="fcn_li_purity" readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3" id="ID262">Pure Weight&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="number" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput formControlName="fcn_li_pure_wt"
                            id="fcn_li_pure_wt" readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>






                <div class="form-group row mt-3" *ngIf="this.divisionMS == 'S' ? false : true">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID263">Metal Rate&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput formControlName="fcn_ad_metal_rate"
                            id="fcn_ad_metal_rate" readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID264">Metal Amount&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                            formControlName="fcn_ad_metal_amount" id="fcn_ad_metal_amount" AmountDecimalInput readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form-group row" *ngIf="this.divisionMS == 'S' ? false : true">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID265">Stone Rate&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput formControlName="fcn_ad_stone_rate"
                            id="fcn_ad_stone_rate" (change)="changeStoneRate($event)" value="{{ li_stone_rate_val }}"
                            [readonly]="!isStoneIncluded" AmountDecimalInput />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID266">Stone Amount&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" id="fcn_ad_stone_amount" matInput
                            formControlName="fcn_ad_stone_amount" value="{{ li_stone_amount_val }}"
                            (change)="changeStoneAmt($event)" [readonly]="!isStoneIncluded" />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                   <!-- <div class="col-md-4">
                        <mat-form-field>
                          <mat-label>Rate Type</mat-label>
                          <input
                            type="text"
                            matInput
                            formControlName="fcn_ad_rate_type"
                            id="fcn_ad_rate_type"
                            [readonly]="viewOnly"
                          />
                        </mat-form-field>
                      </div> -->
                </div>

                <div class="form-group row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4 mt-2" id="ID267">
                        {{divisionMS == "M" ? "Making Rate" : "Rate"}}&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput id="fcn_li_rate"
                            formControlName="fcn_li_rate" (change)="changeRate($event)" readonly="{{ viewOnly }}"
                            (focus)="setValToLocalStorage($event, 'fcn_li_rate')" AmountDecimalInput />
                          <!-- readonly="{{
                                  viewOnly || divisionMS == 'S' ? true : false
                                }}" -->
                          <mat-error *ngIf="
                                  lineItemForm.controls.fcn_li_rate.hasError(
                                    'required'
                                  )
                                " id="ID268">
                            {{ divisionMS == "M" ? "Making Rate" : "Rate" }}
                            is <strong>required</strong>
                          </mat-error>
                          <mat-error *ngIf="
                                  lineItemForm.controls.fcn_li_rate.hasError('min')
                                " id="ID269">
                            <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                            {{ divisionMS == "M" ? "Making Rate" : "Rate" }}
                            should Not Be Zero
                          </mat-error>
                          <!-- formControlName="fcn_li_rate" value="{{li_rate_val}}" (keyup)="changeRate()" (mouseup)="changeRate()" > -->
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4 mt-2" id="ID270">
                        {{divisionMS == "M" ? "Making Amount" : "Amount"}}&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <!-- : "Total Amount" -->
                          <input class="st_txt_right" type="text" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" id="fcn_li_total_amount" matInput
                            formControlName="fcn_li_total_amount" (change)="changeTotalAmt($event)" id="fcn_li_total_amount"
                            readonly="{{ viewOnly }}" AmountDecimalInput />
                          <!-- readonly="{{
                                  viewOnly || divisionMS == 'S' ? true : false
                                }}" -->
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_total_amount.hasError('required')" id="ID271">
                            {{ divisionMS == "M" ? "Making Amount" : "Amount" }}
                            <!-- : "Total Amount" -->
                            is
                            <strong>required</strong>
                          </mat-error>
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_total_amount.hasError('min')" id="ID272">
                            <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                            {{
                            divisionMS == "M"
                            ? "Making Amount"
                            : "Total Amount"
                            }}
                            should Not Be Zero
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form-group row mt-3" *ngIf="this.divisionMS == 'M' ? false : true">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID273">Discount %&nbsp;*</label>
                      <div class="col-sm-7">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" [min]="0" [max]="100"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                            formControlName="fcn_li_discount_percentage" (change)="changeDisPer($event)"
                            id="fcn_li_discount_percentage" (focus)="
                              setValToLocalStorage($event,
                                'fcn_li_discount_percentage')" [readonly]="viewOnly" AmountDecimalInput />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID274">Discount Amount&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" [min]="0" [maxLength]="14"
                           (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                           formControlName="fcn_li_discount_amount" id="fcn_li_discount_amount"
                           (change)="changeDisAmount($event)" [readonly]="viewOnly" (focus)="
                             setValToLocalStorage($event, 'fcn_li_discount_amount')
                           " AmountDecimalInput />
                       </mat-form-field>
                      </div>
                    </div>
                  </div>
                </div>
                <!--- Division, Item Code, Item Desc, Location, PCs, (Gross Wt, Stone Wt, Net Wt), Making Rate - Making Amount,
                                    Stone Rate - Stone Amount, Metal Rate - Metal Amount, Rate - Total Amount, Disc Rate - Disc Amount,Gross Amount, Tax % - Tax Amount, Net Amount ) -->
              </div>


              <div class="col-md-6">
                <div class="form-group">
                  <div style="height: 150px; text-align: center" class="productImage">
                    <image-slider [imageArray]="imageURL"></image-slider>
                    <!-- <img class="card-img-top" [src]="this.curr_line_item_images"
                          alt="Product image" loading="lazy"
                          style="
                            border: 1px solid #ccc;
                            height: 150px;
                            width: 150px;
                          " /> -->
                  </div>
                </div>


                <!-- <div class="form-group row" style="padding-top: 162px"> -->
              </div>
              

              <div class="row mt-1">
                <div class="col-md-12 form-group row">
                  <div class="col-md-3">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID275">Total Amount&nbsp;*
                         <!-- {{
                            divisionMS == "M" ? "Total Amount" : "Net Amount"
                          }} -->
                      </label>
                      <div class="col-sm-7" style="width: 62% !important">
                        <mat-form-field appearance="outline">
                          <!-- <mat-label>Gross Amount</mat-label> -->
                          <input class="st_txt_right" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                            formControlName="fcn_li_gross_amount" id="fcn_li_gross_amount" [readonly]="true"
                            (change)="changeGrossAmt($event)" (focus)="
                              setValToLocalStorage($event, 'fcn_li_gross_amount')
                            " AmountDecimalInput />
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_gross_amount.hasError('required')" id="ID276">
                            Total Amount
                            <!-- {{
                                divisionMS == "M" ? "Total Amount" : "Net Amount"
                              }} -->
                            is <strong>required</strong>
                          </mat-error>
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_gross_amount.hasError('min')" id="ID277">
                            <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                            Total Amount
                            <!-- {{
                                divisionMS == "M" ? "Total Amount" : "Net Amount"
                              }} -->
                            should Not Be Zero
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3"  *ngIf="taxType == 1">
                    <div class="form-group row">
                      <label class="col-sm-4 mt-2" id="ID278">Tax %&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="number" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                            formControlName="fcn_li_tax_percentage" id="fcn_li_tax_percentage" readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3"  *ngIf="taxType == 2">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID279">CGST %&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="number" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                            formControlName="fcn_li_cgst_percentage" id="fcn_li_cgst_percentage" readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3" *ngIf="taxType == 1">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID280">Tax Amount&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput formControlName="fcn_li_tax_amount"
                            id="fcn_li_tax_amount" AmountDecimalInput readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                 
                  <div class="col-md-3" *ngIf="taxType == 2">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID281">CGST Amount&nbsp;*</label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" type="number" [min]="0" [maxLength]="14"
                            (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                            formControlName="fcn_li_cgst_amount" id="fcn_li_cgst_amount" readonly />
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                
                  <div class="col-md-3">
                    <div class="form-group row">
                      <label class="col-sm-4" id="ID282">Net Amount&nbsp;*
                        <!-- {{
                          divisionMS == "M" ? "Net Amount" : "Total+Tax"
                        }} -->
                      </label>
                      <div class="col-sm-8">
                        <mat-form-field appearance="outline">
                          <input class="st_txt_right" (focus)="
                            setValToLocalStorage($event, 'fcn_li_net_amount')
                          " [min]="0" [maxLength]="14" (keyup)="this.comFunc.enforceMinMax($event.target)" matInput
                            formControlName="fcn_li_net_amount" id="fcn_li_net_amount" (change)="changeNettAmt($event)"
                            [readonly]="viewOnly" AmountDecimalInput />
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_net_amount.hasError('required')" id="ID283">
                            Net Amount
                            <!-- {{ divisionMS == "M" ? "Net Amount" : "Total+Tax" }} -->
                            is <strong>required</strong>
                          </mat-error>
                          <mat-error *ngIf="lineItemForm.controls.fcn_li_net_amount.hasError('min')" id="ID284">
                            <!-- {{ this.comFunc.getMsgByID('MSG1554') }} -->
                            Net Amount
                            <!-- {{ divisionMS == "M" ? "Net Amount" : "Total+Tax" }} -->
                            should Not Be Zero
                          </mat-error>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          </div>
        </span>
        <!-- </form> -->
      </div>

    </form>





    <div style="padding-bottom: 0px">
      <div style="text-align: right; padding: 10px" *ngIf="!viewOnly">
        <button mat-flat-button color="accent" class="btn btn btn-dark" *ngIf="!lineItemModalForSalesReturn"
          (click)="addItemtoList('newitem_btn')" id="ID285">
          Next Item</button>&nbsp;
        <button mat-flat-button class="bgColourUpdate" *ngIf="!lineItemModalForSalesReturn"
          (click)="addItemtoList('finish_btn')" id="ID286">
          {{ updateBtn ? "Update" : "Finish" }}</button>&nbsp;

        <button mat-flat-button class="btn btn btn-primary bgColourUpdate" *ngIf="lineItemModalForSalesReturn"
          (click)="updateRetailSalesReturnVal()" id="ID287">
          {{ updateBtn ? "Update" : "Finish" }}</button>&nbsp;
        <!-- <button class="btn btn btn-primary" *ngIf="updateBtn" (click)="addItemtoList('finish_btn')">
            Update
          </button>&nbsp; -->

        <button mat-flat-button color="warn" (click)="modal.dismiss('Cross click')" id="ID193">
          Cancel</button>&nbsp;
        <!-- <button class="btn btn btn-dark" (click)="addItemtoList('newitem_btn')">
            Next Item</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="!updateBtn" (click)="addItemtoList('finish_btn')">
            Finish</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="updateBtn" (click)="addItemtoList('finish_btn')">
            Update
          </button>&nbsp;
          <button class="btn btn btn-danger" *ngIf="!updateBtn" (click)="modal.dismiss('Cross click')">
            Cancel</button>&nbsp; -->
      </div>
      <div style="text-align: right; padding: 10px" *ngIf="viewOnly">
        <button class="btn btn btn-danger" mat-flat-btn class="btn btn btn-danger"
          (click)="modal.dismiss('Cross click')" id="ID174">
          Close</button>&nbsp;
      </div>
      <!-- <div style="text-align: right; padding: 10px">
          <button class="btn btn btn-dark" (click)="addItemtoList('newitem_btn')">
            Next Item</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="!updateBtn" (click)="addItemtoList('finish_btn')">
            Finish</button>&nbsp;
          <button class="btn btn btn-primary" *ngIf="updateBtn" (click)="addItemtoList('finish_btn')">
            Update
          </button>&nbsp;
          <button class="btn btn btn-danger" *ngIf="!updateBtn" (click)="modal.dismiss('Cross click')">
            Cancel</button>&nbsp;
        </div> -->
    </div>
  </div>
</ng-template>